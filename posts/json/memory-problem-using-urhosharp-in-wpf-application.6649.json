{"post_stream":{"posts":[{"id":41446,"name":"","username":"HJ2012","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/h/34f0e0/{size}.png","created_at":"2021-01-04T07:39:10.436Z","cooked":"\u003cp\u003eHi, I have a WPF application with different pages that the user switches between. One of these pages should show an UhroSharp application. This contains a custom geometry and displays a point cloud.\u003cbr\u003e\nThe display works great, but there is a memory leak somewhere. Every time I switch to another page and go back to the Urho application, the memory footprint of my application increases. What I also noticed, on the second visit to the page the show function is called twice, on the third visit three times and so on.\u003cbr\u003e\nI have tried not to destroy the Urho application, however, when I go to the page the second time, I am only shown a black screen.\u003cbr\u003e\nHow do I exit the application cleanly and restart it?\u003cbr\u003e\nMy code is very simple:\u003c/p\u003e\n\u003cp\u003eusing UrhoSharpWpfExtension = UrhoExtensionsWpf::Urho.Extensions.Wpf;\u003cbr\u003e\nusing UrhoSharp = UrhoSharpGlobal::Urho;\u003c/p\u003e\n\u003cp\u003epublic partial class UrhoWrapperWpf : UserControl\u003cbr\u003e\n{\u003cbr\u003e\nprivate UrhoSharpWpfExtension.UrhoSurface _urhoSurface;\u003cbr\u003e\nSceneView _urhoApp;\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e    public UrhoWrapperWpf()\n    {\n        InitializeComponent();\n        _urhoSurface = new UrhoSharpWpfExtension.UrhoSurface()\n        {\n            HorizontalAlignment = HorizontalAlignment.Stretch,\n            VerticalAlignment = VerticalAlignment.Stretch\n        };\n        Content = _urhoSurface;\n        Unloaded += UrhoWrapperWpf_Unloaded;\n    }\n\n    private void UrhoWrapperWpf_Unloaded(object sender, RoutedEventArgs e)\n    {\n        if (_urhoApp?.IsActive == true)\n            _urhoSurface.Stop();\n        Unloaded -= UrhoWrapperWpf_Unloaded;\n    }\n\n    public void ShowPoints(float[] data)\n    {\n        if (_urhoApp?.IsActive == true)\n        {\n            UrhoSharp.Application.InvokeOnMain(() =\u0026gt;\n\t\t\t\t\t\t\t{\n            try\n            {\n                _urhoApp.ShowPoints(data);\n            }\n            catch\n            {\n            }\n        });\n        }\n    }\n\n    public Task\u0026lt;Unit\u0026gt; StartUrhoApp()\n    {\n        var appOpt = new UrhoSharp.ApplicationOptions(assetsFolder: null)\n        {\n            Orientation = UrhoSharp.ApplicationOptions.OrientationType.LandscapeAndPortrait,\n            UseDirectX11 = true,\n            TouchEmulation = true,\n            LimitFps = true,\n            DelayedStart = true,\n            AdditionalFlags = \"-q\",\n            ResourcePrefixPaths = new string[0],\n        };\n\n        try\n        {\n            _urhoApp = await _urhoSurface.Show\u0026lt;SceneView\u0026gt;(appOpt);\n        }\n        catch (Exception e)\n        {\n            Console.WriteLine(e);\n            //ToDo log exception\n        }\n\n        return Task.FromResult(Unit.Default);\n    }\n\n    public Task\u0026lt;Unit\u0026gt; StopUrhoApp()\n    {\n        return Task.FromResult(Unit.Default);\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e}\u003c/p\u003e\n\u003cp\u003eThe Stop Method in SceneView looks like this:\u003c/p\u003e\n\u003cp\u003eprotected override void Stop()\u003cbr\u003e\n{\u003cbr\u003e\nbase.Stop();\u003cbr\u003e\nSizeBuffers(0);\u003cbr\u003e\nscene.RemoveAllChildren();\u003cbr\u003e\nCameraNode.RemoveAllChildren();\u003cbr\u003e\nCameraNode.Remove();\u003cbr\u003e\nDispose();\u003cbr\u003e\nTask.Delay(25);\u003cbr\u003e\nvertexData = null;\u003cbr\u003e\nindexData = null;\u003cbr\u003e\n}\u003c/p\u003e\n\u003cp\u003eI use UrhoSharp and UrhoSharp.Wpf v1.9.67\u003c/p\u003e\n\u003cp\u003eI still found this link, could it have something to do with this?\u003cbr\u003e\n\u003ca href=\"https://github.com/xamarin/urho/issues/311\" rel=\"noopener nofollow ugc\"\u003ehttps://github.com/xamarin/urho/issues/311\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThank you for your help!\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2021-01-04T07:41:21.698Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":14,"reads":28,"readers_count":27,"score":75.6,"yours":false,"topic_id":6649,"topic_slug":"memory-problem-using-urhosharp-in-wpf-application","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/xamarin/urho/issues/311","internal":false,"reflection":false,"title":"Potential memory leak in UrhoSurface WPF binding · Issue #311 · xamarin/urho · GitHub","clicks":2}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1416,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":41457,"name":"","username":"1vanK","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png","created_at":"2021-01-04T21:39:32.446Z","cooked":"\u003cp\u003eWe have nothing to do with UrhoSharp, use Xamarin forum\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2021-01-04T21:40:50.455Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":20,"readers_count":19,"score":9.0,"yours":false,"topic_id":6649,"topic_slug":"memory-problem-using-urhosharp-in-wpf-application","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":true,"admin":false,"staff":true,"user_id":263,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[41446,41457]},"timeline_lookup":[[1,688],[2,687]],"suggested_topics":[{"id":7080,"title":"Build urho3d source on windows 10 - cmake - \"Error in configuration process, project files may be invalid\"","fancy_title":"Build urho3d source on windows 10 - cmake - \u0026ldquo;Error in configuration process, project files may be invalid\u0026rdquo;","slug":"build-urho3d-source-on-windows-10-cmake-error-in-configuration-process-project-files-may-be-invalid","posts_count":8,"reply_count":4,"highest_post_number":8,"image_url":null,"created_at":"2021-12-03T01:55:53.267Z","last_posted_at":"2021-12-06T22:46:59.584Z","bumped":true,"bumped_at":"2021-12-06T22:46:59.584Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":324,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1488,"username":"ToolmakerSteve","name":"ToolmakerSteve","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ba9def/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]},{"id":7100,"title":"UI Sprites - Wrapping/Repeating Texture","fancy_title":"UI Sprites - Wrapping/Repeating Texture","slug":"ui-sprites-wrapping-repeating-texture","posts_count":3,"reply_count":0,"highest_post_number":3,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/5/5d95641f056666c79c67a12520276d2d9f4729ae.png","created_at":"2021-12-15T20:32:37.485Z","last_posted_at":"2021-12-16T03:28:29.146Z","bumped":true,"bumped_at":"2021-12-16T03:28:29.146Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":193,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7146,"title":"How create affordable comfortable and modern terrain?","fancy_title":"How create affordable comfortable and modern terrain?","slug":"how-create-affordable-comfortable-and-modern-terrain","posts_count":5,"reply_count":1,"highest_post_number":5,"image_url":null,"created_at":"2022-01-21T15:20:08.910Z","last_posted_at":"2022-01-21T21:51:58.799Z","bumped":true,"bumped_at":"2022-01-21T22:03:14.896Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":193,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1497,"username":"timob256","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/b782af/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1304,"username":"lebrewer","name":"lebrewer","avatar_template":"/user_avatar/discourse.urho3d.io/lebrewer/{size}/2811_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":230,"username":"Nerrik","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/958977/{size}.png"}}]},{"id":7182,"title":"How install landscape in the format (.tor or .obj)?","fancy_title":"How install landscape in the format (.tor or .obj)?","slug":"how-install-landscape-in-the-format-tor-or-obj","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2022-02-03T16:58:20.976Z","last_posted_at":"2022-02-04T16:34:09.663Z","bumped":true,"bumped_at":"2022-02-04T16:34:09.663Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":151,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1497,"username":"timob256","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/b782af/{size}.png"}},{"extras":"latest","description":"Most Recent Poster, Accepted Answer","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7074,"title":"First Person and 3rd person camera and water reflections","fancy_title":"First Person and 3rd person camera and water reflections","slug":"first-person-and-3rd-person-camera-and-water-reflections","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-01T18:37:28.669Z","last_posted_at":"2021-12-01T21:19:51.519Z","bumped":true,"bumped_at":"2021-12-01T21:19:51.519Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":158,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]}],"tags_descriptions":{},"id":6649,"title":"Memory problem using UrhoSharp in WPF application","fancy_title":"Memory problem using UrhoSharp in WPF application","posts_count":2,"created_at":"2021-01-04T07:39:10.325Z","views":207,"reply_count":0,"like_count":0,"last_posted_at":"2021-01-04T21:39:32.446Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"memory-problem-using-urhosharp-in-wpf-application","category_id":10,"word_count":343,"deleted_at":null,"user_id":1416,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_6649","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":2,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"moderator":true,"trust_level":4},{"id":1416,"username":"HJ2012","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/h/34f0e0/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1}],"created_by":{"id":1416,"username":"HJ2012","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/h/34f0e0/{size}.png"},"last_poster":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"},"links":[{"url":"https://github.com/xamarin/urho/issues/311","title":"Potential memory leak in UrhoSurface WPF binding · Issue #311 · xamarin/urho · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":2,"user_id":1416,"domain":"github.com","root_domain":"github.com"}]}}