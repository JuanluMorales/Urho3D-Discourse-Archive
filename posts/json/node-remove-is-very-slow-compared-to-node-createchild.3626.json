{"post_stream":{"posts":[{"id":21098,"name":"Octavian","username":"stark7","avatar_template":"/user_avatar/discourse.urho3d.io/stark7/{size}/998_2.png","created_at":"2017-10-02T15:51:03.835Z","cooked":"\u003cp\u003eHello,\u003c/p\u003e\n\u003cp\u003eThe use case is within HugeObjectCount example to remove the huge amount of nodes created by adding this as line 154\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003efor (int i = 0; i \u0026lt; boxNodes_.Size(); i++)\u003cbr\u003e\n{\u003cbr\u003e\nboxNodes_[i]-\u0026gt;Remove();\u003cbr\u003e\n}\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eI am observing a significant amount of time to remove those nodes. I also tried disabling the nodes first.\u003c/p\u003e\n\u003cp\u003eIf I create an intermediary parent node to which I add all these nodes, and then remove the parent, then the operation is instantaneous.\u003c/p\u003e\n\u003cp\u003eCan someone please explain the reason behind this behavior?\u003c/p\u003e\n\u003cp\u003eMy real use case is a pseudo-destructible environment in which my world elements also consist of a significant number of nodes.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-10-02T23:10:26.568Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":23,"reads":43,"readers_count":42,"score":128.6,"yours":false,"topic_id":3626,"topic_slug":"node-remove-is-very-slow-compared-to-node-createchild","display_username":"Octavian","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":3,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":733,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":21099,"name":"Eugene Kozlov","username":"Eugene","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","created_at":"2017-10-02T16:09:28.604Z","cooked":"\u003caside class=\"quote\" data-post=\"1\" data-topic=\"3626\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt width=\"20\" height=\"20\" src=\"https://sjc6.discourse-cdn.com/standard17/user_avatar/discourse.urho3d.io/stark7/40/998_1.png\" class=\"avatar\"\u003e stark7:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCan someone please explain the reason behind this behavior?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eEvery \u003ccode\u003eRemove\u003c/code\u003e call performs linear search over all siblings and then performs linear element removing from vector, so you have O(n^2) complexity when removing nodes one-by-one.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-10-02T17:13:31.394Z","reply_count":0,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":0,"reads":40,"readers_count":39,"score":8.0,"yours":false,"topic_id":3626,"topic_slug":"node-remove-is-very-slow-compared-to-node-createchild","display_username":"Eugene Kozlov","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Core developer","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":484,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":true},{"id":21100,"name":"","username":"Victor","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/v/3e96dc/{size}.png","created_at":"2017-10-02T16:12:58.196Z","cooked":"\u003cp\u003eIn general, my understanding has always been that new/delete operations can be slow overall, so avoiding them is always best. I’m not quite sure why Remove is slower, however, my guess is that it has to do a lot more checks to remove a child (who owns the child, traverse any children it may have, etc), than it does for when it’s adding the child. That doesn’t mean there isn’t room for improvement, just that it (possibly) has more checks along the way.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003ePossible Solution\u003c/strong\u003e\u003cbr\u003e\nLumak has a Foliage example which handles updating a lot of foliage nodes at once. One particular issue he addresses is how to quickly update all of them without slowing down the process. If I remember correctly, the solution was to update a set number of nodes each ‘Update’ frame until you’ve updated them all, and then repeat the process.\u003c/p\u003e\n\u003cp\u003eWith that in mind, one solution you can do is to set the Visibility of all nodes you want to delete to “false” while sending them to a “Delete Queue”. On each ‘PostUpdate’, delete a set number inside the queue to prevent the heavy delete operation from slowing down your app. Or, if you can (and if it makes sense in your application), create a ‘pool’ so you can reuse the nodes later.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-10-02T16:12:58.196Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":40,"readers_count":39,"score":13.0,"yours":false,"topic_id":3626,"topic_slug":"node-remove-is-very-slow-compared-to-node-createchild","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":461,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":21101,"name":"","username":"ext1","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/e/f9ae1b/{size}.png","created_at":"2017-10-02T16:27:49.914Z","cooked":"\u003cp\u003eI have very little experience with Urho3D, but maybe the performance is also being affect due to also having to send change events: \u003ca href=\"https://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Scene/Node.cpp#L1111\" rel=\"nofollow noopener\"\u003eRemove()\u003c/a\u003e \u0026gt;\u0026gt; \u003ca href=\"https://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Scene/Node.cpp#L2100\" rel=\"nofollow noopener\"\u003eRemoveChild()\u003c/a\u003e?\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2017-10-02T16:27:49.914Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":38,"readers_count":37,"score":7.6,"yours":false,"topic_id":3626,"topic_slug":"node-remove-is-very-slow-compared-to-node-createchild","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Scene/Node.cpp#L2100","internal":false,"reflection":false,"title":"Urho3D/Node.cpp at master · urho3d/Urho3D · GitHub","clicks":1},{"url":"https://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Scene/Node.cpp#L1111","internal":false,"reflection":false,"title":"Urho3D/Node.cpp at master · urho3d/Urho3D · GitHub","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":838,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":21102,"name":"Octavian","username":"stark7","avatar_template":"/user_avatar/discourse.urho3d.io/stark7/{size}/998_2.png","created_at":"2017-10-02T17:21:25.835Z","cooked":"\u003cp\u003eThank you \u003ca class=\"mention\" href=\"/u/victor\"\u003e@Victor\u003c/a\u003e and \u003ca class=\"mention\" href=\"/u/ext1\"\u003e@ext1\u003c/a\u003e - I think you both have valid points, and all of that is compounded by what \u003ca class=\"mention\" href=\"/u/eugene\"\u003e@Eugene\u003c/a\u003e is saying about the O(n*n) complexity which explains my observations.\u003c/p\u003e\n\u003cp\u003eIf i were to choose between fast create and fast destroy, I would always want fast create/recreate.\u003c/p\u003e\n\u003cp\u003eI think I will be making extensive use of nodes with the StaticModelGroup component moving forward so my problem is not really a problem anymore.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2017-10-02T17:21:25.835Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":36,"readers_count":35,"score":12.2,"yours":false,"topic_id":3626,"topic_slug":"node-remove-is-very-slow-compared-to-node-createchild","display_username":"Octavian","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":733,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[21098,21099,21100,21101,21102]},"timeline_lookup":[[1,1878],[5,1877]],"suggested_topics":[{"id":7284,"title":"[Solved] Moving a Navigation Mesh","fancy_title":"[Solved] Moving a Navigation Mesh","slug":"solved-moving-a-navigation-mesh","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2022-06-20T20:10:14.786Z","last_posted_at":"2022-06-21T21:25:22.088Z","bumped":true,"bumped_at":"2022-06-21T21:25:22.088Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":138,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster, Accepted Answer","user":{"id":1228,"username":"PsychoCircuitry","name":null,"avatar_template":"https://avatars.discourse-cdn.com/v4/letter/p/a9a28c/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1358,"username":"JSandusky","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jsandusky/{size}/3220_2.png"}}]},{"id":7100,"title":"UI Sprites - Wrapping/Repeating Texture","fancy_title":"UI Sprites - Wrapping/Repeating Texture","slug":"ui-sprites-wrapping-repeating-texture","posts_count":3,"reply_count":0,"highest_post_number":3,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/5/5d95641f056666c79c67a12520276d2d9f4729ae.png","created_at":"2021-12-15T20:32:37.485Z","last_posted_at":"2021-12-16T03:28:29.146Z","bumped":true,"bumped_at":"2021-12-16T03:28:29.146Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":193,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7107,"title":"Error: SDL/SDL_gamecontroller.h: No such file or directory #include \u003cSDL/SDL_gamecontroller.h\u003e","fancy_title":"Error: SDL/SDL_gamecontroller.h: No such file or directory #include \u0026lt;SDL/SDL_gamecontroller.h\u0026gt;","slug":"error-sdl-sdl-gamecontroller-h-no-such-file-or-directory-include-sdl-sdl-gamecontroller-h","posts_count":6,"reply_count":1,"highest_post_number":6,"image_url":null,"created_at":"2021-12-21T15:29:52.810Z","last_posted_at":"2021-12-22T15:32:44.818Z","bumped":true,"bumped_at":"2021-12-22T15:32:44.818Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":271,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1497,"username":"timob256","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/b782af/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7097,"title":"View Physics event for ConvexCast","fancy_title":"View Physics event for ConvexCast","slug":"view-physics-event-for-convexcast","posts_count":11,"reply_count":5,"highest_post_number":11,"image_url":null,"created_at":"2021-12-09T23:56:27.507Z","last_posted_at":"2021-12-12T20:20:02.788Z","bumped":true,"bumped_at":"2021-12-12T20:20:02.788Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":6,"views":206,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7160,"title":"RayCast trouble","fancy_title":"RayCast trouble","slug":"raycast-trouble","posts_count":17,"reply_count":9,"highest_post_number":19,"image_url":null,"created_at":"2022-01-29T00:06:00.367Z","last_posted_at":"2022-01-30T00:29:39.356Z","bumped":true,"bumped_at":"2022-01-30T00:29:39.356Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":260,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":627,"username":"George1","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/9e8a1a/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}}]}],"tags_descriptions":{},"id":3626,"title":"Node.Remove is very slow compared to Node.CreateChild","fancy_title":"Node.Remove is very slow compared to Node.CreateChild","posts_count":5,"created_at":"2017-10-02T15:51:03.662Z","views":506,"reply_count":0,"like_count":0,"last_posted_at":"2017-10-02T17:21:25.835Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"node-remove-is-very-slow-compared-to-node-createchild","category_id":10,"word_count":504,"deleted_at":null,"user_id":733,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_3626","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":5,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":4,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"accepted_answer":{"post_number":2,"username":"Eugene","excerpt":"Every Remove call performs linear search over all siblings and then performs linear element removing from vector, so you have O(n^2) complexity when removing nodes one-by-one."},"details":{"can_edit":false,"notification_level":1,"participants":[{"id":733,"username":"stark7","name":"Octavian","avatar_template":"/user_avatar/discourse.urho3d.io/stark7/{size}/998_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":461,"username":"Victor","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/v/3e96dc/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":838,"username":"ext1","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/e/f9ae1b/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":733,"username":"stark7","name":"Octavian","avatar_template":"/user_avatar/discourse.urho3d.io/stark7/{size}/998_2.png"},"last_poster":{"id":733,"username":"stark7","name":"Octavian","avatar_template":"/user_avatar/discourse.urho3d.io/stark7/{size}/998_2.png"},"links":[{"url":"https://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Scene/Node.cpp#L2100","title":"Urho3D/Node.cpp at master · urho3d/Urho3D · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":838,"domain":"github.com","root_domain":"github.com"}]}}