{"post_stream":{"posts":[{"id":20892,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2017-09-21T14:04:17.030Z","cooked":"\u003cp\u003eWorking on the terrain shader for my terrain editor, and having some issues with the D3D11 version. I am declaring an array of float uniforms as:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003estatic const int numlayers=8;\n#ifdef COMPILEPS\n\n\tcbuffer CustomPS : register(b6)\n\t{\n\t\tfloat cLayerScaling[numlayers];\n\t};\n#endif\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen, I access it to scale a terrain texture layer by a specified amount:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003efloat4 SampleDiffuse(float3 detailtexcoord, int layer, float3 blend)\n{\n\treturn tDetailMap2.Sample(sDetailMap2, float3(detailtexcoord.zy*cLayerScaling[layer], layer))*blend.x +\n\t\ttDetailMap2.Sample(sDetailMap2, float3(detailtexcoord.xy*cLayerScaling[layer], layer))*blend.z +\n\t\ttDetailMap2.Sample(sDetailMap2, float3(detailtexcoord.xz*cLayerScaling[layer], layer))*blend.y;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn Lua script, I pass the material an array Variant object constructed like so:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003elocal buf=VectorBuffer()\nbuf:WriteFloat(2)\nbuf:WriteFloat(2)\nbuf:WriteFloat(1.0)\nbuf:WriteFloat(1.0)\nbuf:WriteFloat(1.0)\nbuf:WriteFloat(1.0)\nbuf:WriteFloat(1.0)\nbuf:WriteFloat(0.25)\n\nlocal ary=Variant()\nary:Set(buf)\nTerrainState.terrainMaterial:SetShaderParameter(\"LayerScaling\", ary)\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eBut for some reason, the shader isn’t receiving all of the floats in the array. It receives the first float correctly, it receives an incorrect value for the second one, and the rest it receives the value of 0.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"//cdck-file-uploads-global.s3.dualstack.us-west-2.amazonaws.com/standard17/uploads/urho3d/original/1X/d1053f0a172aba845dff12421ec8c5cf6591d703.png\"\u003e\u003c/p\u003e\n\u003cp\u003eIt works on the OpenGL version just fine, so I don’t think it’s a problem with constructing the VectorBuffer and setting the parameter:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"//cdck-file-uploads-global.s3.dualstack.us-west-2.amazonaws.com/standard17/uploads/urho3d/original/1X/86ffe967bc1b4c7b1a2b82519446863eb9c89698.png\"\u003e\u003c/p\u003e\n\u003cp\u003eAnybody have any ideas?\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-09-21T14:10:49.777Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":12,"reads":32,"readers_count":31,"score":66.4,"yours":false,"topic_id":3590,"topic_slug":"having-an-issue-with-array-of-float-uniforms-on-d3d11","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":"downloaded local copies of images","can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":20893,"name":"Eugene Kozlov","username":"Eugene","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","created_at":"2017-09-21T15:10:48.056Z","cooked":"\u003cp\u003eTy to debug \u003ccode\u003eGraphics::SetShaderParameter(StringHash param, const float* data, unsigned count)\u003c/code\u003e\u003cbr\u003e\nDoes it receive valid values?\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-09-21T15:10:48.056Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":30,"readers_count":29,"score":11.0,"yours":false,"topic_id":3590,"topic_slug":"having-an-issue-with-array-of-float-uniforms-on-d3d11","display_username":"Eugene Kozlov","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Core developer","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":484,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":20900,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2017-09-21T22:38:17.842Z","cooked":"\u003cp\u003eI added some logging code, and it looks like it is getting the values:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e[Thu Sep 21 16:29:59 2017] INFO: Shader parameter buffer index 0: 2\n[Thu Sep 21 16:29:59 2017] INFO: Shader parameter buffer index 1: 2\n[Thu Sep 21 16:29:59 2017] INFO: Shader parameter buffer index 2: 1\n[Thu Sep 21 16:29:59 2017] INFO: Shader parameter buffer index 3: 1\n[Thu Sep 21 16:29:59 2017] INFO: Shader parameter buffer index 4: 1\n[Thu Sep 21 16:29:59 2017] INFO: Shader parameter buffer index 5: 1\n[Thu Sep 21 16:29:59 2017] INFO: Shader parameter buffer index 6: 1\n[Thu Sep 21 16:29:59 2017] INFO: Shader parameter buffer index 7: 0.25\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI added a check in ConstantBuffer as well to make sure it’s not overflowing the buffer, and everything looks good there.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-09-21T22:38:17.842Z","reply_count":1,"reply_to_post_number":2,"quote_count":0,"incoming_link_count":0,"reads":30,"readers_count":29,"score":11.0,"yours":false,"topic_id":3590,"topic_slug":"having-an-issue-with-array-of-float-uniforms-on-d3d11","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":20903,"name":"Alex Piola","username":"Alex-Doc","avatar_template":"/user_avatar/discourse.urho3d.io/alex-doc/{size}/503_2.png","created_at":"2017-09-22T05:52:19.715Z","cooked":"\u003cp\u003eMaybe this can be useful for investigating further?\u003cbr\u003e\n\u003ca href=\"https://renderdoc.org\" class=\"onebox\" target=\"_blank\" rel=\"nofollow noopener\"\u003ehttps://renderdoc.org\u003c/a\u003e\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2017-09-22T05:52:40.427Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":24,"readers_count":23,"score":9.8,"yours":false,"topic_id":3590,"topic_slug":"having-an-issue-with-array-of-float-uniforms-on-d3d11","display_username":"Alex Piola","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://renderdoc.org","internal":false,"reflection":false,"title":"RenderDoc","clicks":3}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":752,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":20904,"name":"Eugene Kozlov","username":"Eugene","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","created_at":"2017-09-22T08:09:20.712Z","cooked":"\u003cp\u003eArrays are not packed in DX11. Every element of the array is aligned to float4 vector.\u003cbr\u003e\n\u003ca href=\"https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509632%28v=vs.85%29.aspx?f=255\u0026amp;MSPPError=-2147217396\" class=\"onebox\" target=\"_blank\" rel=\"nofollow noopener\"\u003ehttps://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509632(v=vs.85).aspx?f=255\u0026amp;MSPPError=-2147217396\u003c/a\u003e\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2017-09-22T14:25:12.855Z","reply_count":1,"reply_to_post_number":3,"quote_count":0,"incoming_link_count":0,"reads":20,"readers_count":19,"score":24.0,"yours":false,"topic_id":3590,"topic_slug":"having-an-issue-with-array-of-float-uniforms-on-d3d11","display_username":"Eugene Kozlov","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509632%28v=vs.85%29.aspx?f=255\u0026MSPPError=-2147217396","internal":false,"reflection":false,"clicks":6}],"read":true,"user_title":"Core developer","title_is_group":false,"reply_to_user":{"username":"JTippetts","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":484,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":true},{"id":20913,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2017-09-22T14:25:39.592Z","cooked":"\u003cp\u003eLooks like that was the issue. Thank you!\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2017-09-22T14:25:39.592Z","reply_count":0,"reply_to_post_number":5,"quote_count":0,"incoming_link_count":0,"reads":17,"readers_count":16,"score":3.4,"yours":false,"topic_id":3590,"topic_slug":"having-an-issue-with-array-of-float-uniforms-on-d3d11","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[20892,20893,20900,20903,20904,20913]},"timeline_lookup":[[1,1889],[3,1888]],"suggested_topics":[{"id":7065,"title":"Angelscript: Loading a char file into a 2D array: how?","fancy_title":"Angelscript: Loading a char file into a 2D array: how?","slug":"angelscript-loading-a-char-file-into-a-2d-array-how","posts_count":7,"reply_count":4,"highest_post_number":7,"image_url":null,"created_at":"2021-11-24T09:20:05.420Z","last_posted_at":"2021-11-28T11:19:39.689Z","bumped":true,"bumped_at":"2021-11-28T11:26:00.375Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":239,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1491,"username":"xlat","name":"Alex Kuch","avatar_template":"/user_avatar/discourse.urho3d.io/xlat/{size}/3620_2.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":983,"username":"tarzeron","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ecae2f/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}]},{"id":7083,"title":"Using custom models in Xamarin.Forms shared project","fancy_title":"Using custom models in Xamarin.Forms shared project","slug":"using-custom-models-in-xamarin-forms-shared-project","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2021-12-03T08:34:21.895Z","last_posted_at":"2021-12-03T11:40:30.983Z","bumped":true,"bumped_at":"2021-12-03T11:40:30.983Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":198,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1493,"username":"Nikolai","name":"Nikolai Miroshnichenko","avatar_template":"/user_avatar/discourse.urho3d.io/nikolai/{size}/3632_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}]},{"id":7081,"title":"Install Urho3D Library - Windows 10 - rake build - \"project does not exist\"","fancy_title":"Install Urho3D Library - Windows 10 - rake build - \u0026ldquo;project does not exist\u0026rdquo;","slug":"install-urho3d-library-windows-10-rake-build-project-does-not-exist","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-03T03:06:40.974Z","last_posted_at":"2021-12-03T17:53:10.844Z","bumped":true,"bumped_at":"2021-12-03T17:53:10.844Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":190,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1488,"username":"ToolmakerSteve","name":"ToolmakerSteve","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ba9def/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1491,"username":"xlat","name":"Alex Kuch","avatar_template":"/user_avatar/discourse.urho3d.io/xlat/{size}/3620_2.png"}}]},{"id":7104,"title":"Bug in my partial-model copying code","fancy_title":"Bug in my partial-model copying code","slug":"bug-in-my-partial-model-copying-code","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/5/5367e370779d64989e5c3ff2c1ebfb0689908c87.png","created_at":"2021-12-17T03:50:19.405Z","last_posted_at":"2021-12-17T13:50:49.662Z","bumped":true,"bumped_at":"2021-12-17T13:50:49.662Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":144,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7129,"title":"Best Model Import Pipeline as of Jan 2022?","fancy_title":"Best Model Import Pipeline as of Jan 2022?","slug":"best-model-import-pipeline-as-of-jan-2022","posts_count":7,"reply_count":0,"highest_post_number":7,"image_url":null,"created_at":"2022-01-17T09:27:23.432Z","last_posted_at":"2022-01-17T20:37:59.458Z","bumped":true,"bumped_at":"2022-01-17T20:37:59.458Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":170,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1165,"username":"throwawayerino","name":"Actually Permanent","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/da6949/{size}.png"}}]}],"tags_descriptions":{},"id":3590,"title":"Having an issue with array of float uniforms on D3D11","fancy_title":"Having an issue with array of float uniforms on D3D11","posts_count":6,"created_at":"2017-09-21T14:04:16.930Z","views":530,"reply_count":3,"like_count":1,"last_posted_at":"2017-09-22T14:25:39.592Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"having-an-issue-with-array-of-float-uniforms-on-d3d11","category_id":10,"word_count":460,"deleted_at":null,"user_id":30,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/1X/d1053f0a172aba845dff12421ec8c5cf6591d703.png","slow_mode_seconds":0,"draft":null,"draft_key":"topic_3590","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":6,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":3,"show_read_indicator":false,"thumbnails":[{"max_width":null,"max_height":null,"width":1017,"height":768,"url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/1X/d1053f0a172aba845dff12421ec8c5cf6591d703.png"}],"slow_mode_enabled_until":null,"tags_disable_ads":false,"accepted_answer":{"post_number":5,"username":"Eugene","excerpt":"Arrays are not packed in DX11. Every element of the array is aligned to float4 vector. \n\u003ca href=\"https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509632%28v=vs.85%29.aspx?f=255\u0026amp;MSPPError=-2147217396\" class=\"onebox\" target=\"_blank\" rel=\"nofollow noopener\"\u003ehttps://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509632(v=vs.85).aspx?f=255\u0026amp;MSPPError=-2147217396\u003c/a\u003e"},"details":{"can_edit":false,"notification_level":1,"participants":[{"id":30,"username":"JTippetts","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":752,"username":"Alex-Doc","name":"Alex Piola","avatar_template":"/user_avatar/discourse.urho3d.io/alex-doc/{size}/503_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":30,"username":"JTippetts","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png"},"last_poster":{"id":30,"username":"JTippetts","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png"},"links":[{"url":"https://msdn.microsoft.com/ru-ru/library/windows/desktop/bb509632%28v=vs.85%29.aspx?f=255\u0026MSPPError=-2147217396","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":6,"user_id":484,"domain":"msdn.microsoft.com","root_domain":"microsoft.com"},{"url":"https://renderdoc.org","title":"RenderDoc","internal":false,"attachment":false,"reflection":false,"clicks":3,"user_id":752,"domain":"renderdoc.org","root_domain":"renderdoc.org"}]}}