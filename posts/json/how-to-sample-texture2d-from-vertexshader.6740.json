{"post_stream":{"posts":[{"id":42041,"name":"Brian Knox","username":"najak3d","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png","created_at":"2021-03-02T03:00:56.799Z","cooked":"\u003cp\u003eWe are trying to use a Texture2D heightmap inside the VertexShader to offset the Y positions of the grid.  This is much more efficient than recreating a unique VertexBuffer for each Terrain Tile.  So we can have ONE Vertex Buffer, and then use two parameters “TilePos” and “TileSize” to correctly offset each Grid point into World Space for the Pixel Shader.\u003c/p\u003e\n\u003cp\u003eProblem is that I can’t seem to get the Vertex Shader to recognize the sDiffMap to sample it.\u003c/p\u003e\n\u003cp\u003eHere is my Pixel Shader:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e#include \"Uniforms.hlsl\"\n#include \"Samplers.hlsl\"\n#include \"Transform.hlsl\"\n\n#ifdef COMPILEVS\ncbuffer CustomVS : register(b6)\n{\n    float2 cTilePos;\n    float2 cTileSize;\n}\nsampler2D sDiffMap : register(s0);\n#endif\n\nvoid VS(float4 iPos : POSITION,\n\tfloat2 iTexCoord : TEXCOORD0,\n    out float2 oTexCoord : TEXCOORD0,\n    out float4 oPos : OUTPOSITION)\n{\n    float2 offset = iTexCoord;\n    offset.x *= cTileSize.x;\n    offset.y *= cTileSize.y;\n    offset += cTilePos;\n\n    float2 diffVal = Sample2DLod0(DiffMap, iTexCoord).rg;\n    float3 pos = float3(offset.x, diffVal.r, offset.y);\n\n    oPos = GetClipPos(pos);\n    oTexCoord = iTexCoord;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e===\u003cbr\u003e\nWhen Urho3D compiles this, I get the following error:\u003c/p\u003e\n\u003cp\u003eERROR: Failed to compile vertex shader Terrain3D_Alerts():\u003cbr\u003e\n…\\Shaders\\HLSL\\Terrain3D_Alerts.hlsl(514,22-53): error X3004: undeclared identifier ‘tDiffMap’\u003c/p\u003e\n\u003cp\u003eSo if I add another line:\u003cbr\u003e\nsampler2D tDiffMap : register(s0);\u003c/p\u003e\n\u003cp\u003eThen it gives me this error:\u003cbr\u003e\nERROR: Failed to compile vertex shader Terrain3D_Alerts():\u003cbr\u003e\n…\\Shaders\\HLSL\\Terrain3D_Alerts.hlsl(515,22-49): error X3087: sampler2D object does not have methods\u003c/p\u003e\n\u003cp\u003e\u003ca class=\"mention\" href=\"/u/jsandusky\"\u003e@JSandusky\u003c/a\u003e - you answered my previous post on this, so I posted it fresh here with Shader code so that you might be help to tell me what I’m doing wrong.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://discourse.urho3d.io/t/how-to-fetch-sdiffmap-in-vertexshader/904/9\"\u003ehttps://discourse.urho3d.io/t/how-to-fetch-sdiffmap-in-vertexshader/904/9\u003c/a\u003e\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2021-03-02T03:00:56.799Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":22,"readers_count":21,"score":9.4,"yours":false,"topic_id":6740,"topic_slug":"how-to-sample-texture2d-from-vertexshader","display_username":"Brian Knox","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://discourse.urho3d.io/t/how-to-fetch-sdiffmap-in-vertexshader/904/9","internal":true,"reflection":false,"title":"How to fetch sDiffMap in VertexShader?","clicks":1},{"url":"https://discourse.urho3d.io/t/how-to-fetch-sdiffmap-in-vertexshader/904/14","internal":true,"reflection":true,"title":"How to fetch sDiffMap in VertexShader?","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1334,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":42044,"name":"","username":"JSandusky","avatar_template":"/user_avatar/discourse.urho3d.io/jsandusky/{size}/3220_2.png","created_at":"2021-03-02T03:09:29.474Z","cooked":"\u003cp\u003eYou need the texture 2D object as well, in HLSL you have to use sampler objects to sample textures. The texture read macros are hiding it from you and that’s why the error messages are confounding.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003eTexture2D tDiffMap : register(t0);\nSamplerState sDiffMap : register(s0);\n\u003c/code\u003e\u003c/pre\u003e","post_number":2,"post_type":1,"updated_at":"2021-03-02T03:11:41.750Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":22,"readers_count":21,"score":24.4,"yours":false,"topic_id":6740,"topic_slug":"how-to-sample-texture2d-from-vertexshader","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":1358,"hidden":false,"trust_level":0,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_suspended":true,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":true},{"id":42045,"name":"Brian Knox","username":"najak3d","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png","created_at":"2021-03-02T03:12:03.911Z","cooked":"\u003cp\u003eThat worked like a charm!  Thank you \u003ca class=\"mention\" href=\"/u/jsandusky\"\u003e@JSandusky\u003c/a\u003e .\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2021-03-02T03:12:03.911Z","reply_count":0,"reply_to_post_number":2,"quote_count":0,"incoming_link_count":0,"reads":22,"readers_count":21,"score":4.4,"yours":false,"topic_id":6740,"topic_slug":"how-to-sample-texture2d-from-vertexshader","display_username":"Brian Knox","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"JSandusky","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jsandusky/{size}/3220_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1334,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":42046,"name":"Brian Knox","username":"najak3d","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png","created_at":"2021-03-02T03:12:37.733Z","cooked":"\u003cp\u003eFinal working code looks like this:\u003c/p\u003e\n\u003cp\u003e\u003cspan class=\"hashtag\"\u003e#include\u003c/span\u003e “Uniforms.hlsl”\u003cbr\u003e\n\u003cspan class=\"hashtag\"\u003e#include\u003c/span\u003e “Samplers.hlsl”\u003cbr\u003e\n\u003cspan class=\"hashtag\"\u003e#include\u003c/span\u003e “Transform.hlsl”\u003c/p\u003e\n\u003cp\u003e\u003cspan class=\"hashtag\"\u003e#ifdef\u003c/span\u003e COMPILEVS\u003cbr\u003e\ncbuffer CustomVS : register(b6)\u003cbr\u003e\n{\u003cbr\u003e\nfloat2 cTilePos;\u003cbr\u003e\nfloat2 cTileSize;\u003cbr\u003e\n}\u003cbr\u003e\nTexture2D tDiffMap : register(t0);\u003cbr\u003e\nSamplerState sDiffMap : register(s0);\u003c/p\u003e\n\u003cp\u003e\u003cspan class=\"hashtag\"\u003e#endif\u003c/span\u003e\u003c/p\u003e\n\u003cp\u003evoid VS(float4 iPos : POSITION,\u003cbr\u003e\nfloat2 iTexCoord : TEXCOORD0,\u003cbr\u003e\nout float2 oTexCoord : TEXCOORD0,\u003cbr\u003e\nout float4 oPos : OUTPOSITION)\u003cbr\u003e\n{\u003cbr\u003e\nfloat2 offset = iTexCoord;\u003cbr\u003e\noffset.x *= cTileSize.x;\u003cbr\u003e\noffset.y *= cTileSize.y;\u003cbr\u003e\noffset += cTilePos;\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003efloat2 diffVal = Sample2DLod0(DiffMap, iTexCoord).rg;\nfloat3 pos = float3(offset.x, diffVal.r, offset.y);\n\noPos = GetClipPos(pos);\noTexCoord = iTexCoord;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e}\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2021-03-02T03:12:37.733Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":22,"readers_count":21,"score":4.4,"yours":false,"topic_id":6740,"topic_slug":"how-to-sample-texture2d-from-vertexshader","display_username":"Brian Knox","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1334,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[42041,42044,42045,42046]},"timeline_lookup":[[1,631]],"suggested_topics":[{"id":7074,"title":"First Person and 3rd person camera and water reflections","fancy_title":"First Person and 3rd person camera and water reflections","slug":"first-person-and-3rd-person-camera-and-water-reflections","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-01T18:37:28.669Z","last_posted_at":"2021-12-01T21:19:51.519Z","bumped":true,"bumped_at":"2021-12-01T21:19:51.519Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":158,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]},{"id":7083,"title":"Using custom models in Xamarin.Forms shared project","fancy_title":"Using custom models in Xamarin.Forms shared project","slug":"using-custom-models-in-xamarin-forms-shared-project","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2021-12-03T08:34:21.895Z","last_posted_at":"2021-12-03T11:40:30.983Z","bumped":true,"bumped_at":"2021-12-03T11:40:30.983Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":198,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1493,"username":"Nikolai","name":"Nikolai Miroshnichenko","avatar_template":"/user_avatar/discourse.urho3d.io/nikolai/{size}/3632_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}]},{"id":7086,"title":"Handling CrowdAgents that get stuck","fancy_title":"Handling CrowdAgents that get stuck","slug":"handling-crowdagents-that-get-stuck","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-12-04T01:26:23.062Z","last_posted_at":"2021-12-05T04:37:54.143Z","bumped":true,"bumped_at":"2021-12-05T04:37:54.143Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":137,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]},{"id":7097,"title":"View Physics event for ConvexCast","fancy_title":"View Physics event for ConvexCast","slug":"view-physics-event-for-convexcast","posts_count":11,"reply_count":5,"highest_post_number":11,"image_url":null,"created_at":"2021-12-09T23:56:27.507Z","last_posted_at":"2021-12-12T20:20:02.788Z","bumped":true,"bumped_at":"2021-12-12T20:20:02.788Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":6,"views":206,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7065,"title":"Angelscript: Loading a char file into a 2D array: how?","fancy_title":"Angelscript: Loading a char file into a 2D array: how?","slug":"angelscript-loading-a-char-file-into-a-2d-array-how","posts_count":7,"reply_count":4,"highest_post_number":7,"image_url":null,"created_at":"2021-11-24T09:20:05.420Z","last_posted_at":"2021-11-28T11:19:39.689Z","bumped":true,"bumped_at":"2021-11-28T11:26:00.375Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":239,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1491,"username":"xlat","name":"Alex Kuch","avatar_template":"/user_avatar/discourse.urho3d.io/xlat/{size}/3620_2.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":983,"username":"tarzeron","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ecae2f/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}]}],"tags_descriptions":{},"id":6740,"title":"How to Sample Texture2D from VertexShader?","fancy_title":"How to Sample Texture2D from VertexShader?","posts_count":4,"created_at":"2021-03-02T03:00:56.730Z","views":145,"reply_count":1,"like_count":1,"last_posted_at":"2021-03-02T03:12:37.733Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"how-to-sample-texture2d-from-vertexshader","category_id":10,"word_count":417,"deleted_at":null,"user_id":1334,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_6740","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":4,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"accepted_answer":{"post_number":2,"username":"JSandusky","excerpt":"You need the texture 2D object as well, in HLSL you have to use sampler objects to sample textures. The texture read macros are hiding it from you and that’s why the error messages are confounding. \nTexture2D tDiffMap : register(t0);\nSamplerState sDiffMap : register(s0);"},"details":{"can_edit":false,"notification_level":1,"participants":[{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":1358,"username":"JSandusky","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jsandusky/{size}/3220_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":0}],"created_by":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"},"last_poster":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"},"links":[{"url":"https://discourse.urho3d.io/t/how-to-fetch-sdiffmap-in-vertexshader/904/9","title":"How to fetch sDiffMap in VertexShader?","internal":true,"attachment":false,"reflection":false,"clicks":1,"user_id":1334,"domain":"discourse.urho3d.io","root_domain":"urho3d.io"}]}}