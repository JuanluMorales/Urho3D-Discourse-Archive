{"post_stream":{"posts":[{"id":6244,"name":"","username":"franck22000","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/f/f4b2a3/{size}.png","created_at":"2015-05-25T17:05:58.000Z","cooked":"\u003cp\u003eHello Guys i am trying to render a model (cube in this example) in a render target and then saving the render target inside an PNG image file like a screenshot. As you can see the image saved is… weird even if you can recognize the cube a little bit \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://tof.canardpc.com/view/581367ca-fa30-40d0-a68c-8ec93c77d52c.jpg\" data-bbcode=\"true\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"http://tof.canardpc.com/preview2/581367ca-fa30-40d0-a68c-8ec93c77d52c.jpg\" alt=\"\" width=\"500\" height=\"500\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThe nearly same code was working correctly with OpenGL 3.2 and now i am using DirectX11. Can anyone have a solution to render the image correctly in DirectX11 ?\u003c/p\u003e\n\u003cp\u003eViewport, Camera and render target creation code:\u003c/p\u003e\n\u003cp\u003e[code]// Create viewport scene\u003cbr\u003e\nm_p3DViewportScene = new Scene(context_);\u003cbr\u003e\nm_p3DViewportScene-\u0026gt;CreateComponent();\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eNode* _pZoneAmbientNode = m_p3DViewportScene-\u0026gt;CreateChild(\"Zone\");\n\nif (_pZoneAmbientNode != nullptr)\n{\n\n\tZone* _pZoneAmbient = _pZoneAmbientNode-\u0026gt;CreateComponent\u0026lt;Zone\u0026gt;();\n\n\tif (_pZoneAmbient != nullptr)\n\t{\n\t\t_pZoneAmbient-\u0026gt;SetBoundingBox(BoundingBox(-2048.0f, 2048.0f));\n\t\t_pZoneAmbient-\u0026gt;SetAmbientColor(Color(1.0f, 1.0f, 1.0f));\n\t\t_pZoneAmbient-\u0026gt;SetFogColor(Color(1.0f, 0.0f, 0.0f));\n\t\t_pZoneAmbient-\u0026gt;SetFogStart(0.0f);\n\t\t_pZoneAmbient-\u0026gt;SetFogEnd(512.0f);\n\t}\n\n}\n\n// Create camera viewport\n m_p3DViewportCameraNode = m_p3DViewportScene-\u0026gt;CreateChild();\n\nif (m_p3DViewportCameraNode != nullptr)\n{\n\n\tCamera* _pCamera = m_p3DViewportCameraNode-\u0026gt;CreateComponent\u0026lt;Camera\u0026gt;();\n\n\tif (_pCamera != nullptr)\n\t{\n\t\t_pCamera-\u0026gt;SetFarClip(512.0f);\n\t\t//_pCamera-\u0026gt;SetOrthographic(true);\n\t}\n\n}\n\n// Create rendertarget\nm_p3DViewportRenderTexture = new Texture2D(context_);\nm_p3DViewportRenderTexture-\u0026gt;SetSize(512, 512, Graphics::GetRGBFormat(), TEXTURE_RENDERTARGET);\nm_p3DViewportRenderTexture-\u0026gt;SetFilterMode(FILTER_TRILINEAR);\n\nRenderSurface* _pRenderSurface = m_p3DViewportRenderTexture-\u0026gt;GetRenderSurface();\n\nif (_pRenderSurface != nullptr)\n{\n\tSharedPtr\u0026lt;Viewport\u0026gt; _pViewport(new Viewport(context_, m_p3DViewportScene, m_p3DViewportCameraNode-\u0026gt;GetComponent\u0026lt;Camera\u0026gt;()));\n\t_pRenderSurface-\u0026gt;SetViewport(0, _pViewport);\n\t_pRenderSurface-\u0026gt;SetUpdateMode(RenderSurfaceUpdateMode::SURFACE_UPDATEALWAYS);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e[/code]\u003c/p\u003e\n\u003cp\u003eAnd the rendering and saving of the PNG file:\u003c/p\u003e\n\u003cp\u003e[code]m_pModelNode = m_p3DViewportScene-\u0026gt;CreateChild();\u003cbr\u003e\nm_pModelNode-\u0026gt;SetPosition(Vector3(0.0f, 0.0f, 5.0f));\u003cbr\u003e\nm_pModelNode-\u0026gt;SetRotation(Quaternion(0.0f, 0.0f, 0.0f));\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eStaticModel* _pStaticModel = m_pModelNode-\u0026gt;CreateComponent\u0026lt;StaticModel\u0026gt;();\n_pStaticModel-\u0026gt;SetModel(_pResourceLoader-\u0026gt;GetResource\u0026lt;Model\u0026gt;(fModelResourcePath));\n_pStaticModel-\u0026gt;SetCastShadows(false);\n_pStaticModel-\u0026gt;ApplyMaterialList();\n\n// Render the screen\nGetSubsystem\u0026lt;Renderer\u0026gt;()-\u0026gt;Update(1.0f);\nGetSubsystem\u0026lt;Renderer\u0026gt;()-\u0026gt;Render();\n\n// Image saving\nImage* _pImage = new Image(context_);\n_pImage-\u0026gt;SetSize(512, 512, 3);\n\nunsigned char* _ImageData = new unsigned char[m_p3DViewportRenderTexture-\u0026gt;GetDataSize(512, 512)];\nm_p3DViewportRenderTexture-\u0026gt;GetData(0, _ImageData);\n\n_pImage-\u0026gt;SetData(_ImageData);\n\n_pImage-\u0026gt;SavePNG(\"test.png\");\n\ndelete[] _ImageData; [/code]\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThank you ! \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T01:05:17.500Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":305,"reads":45,"readers_count":44,"score":1534.0,"yours":false,"topic_id":1080,"topic_slug":"saving-rendertarget-texture-to-image","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"http://tof.canardpc.com/view/581367ca-fa30-40d0-a68c-8ec93c77d52c.jpg","internal":false,"reflection":false,"title":"581367ca-fa30-40d0-a68c-8ec93c77d52c.jpg","clicks":1},{"url":"http://discourse.urho3d.io/t/texture2d-getdata-and-rendertargets/1093","internal":true,"reflection":true,"title":"Texture2D GetData and RenderTargets","clicks":1}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":174,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6245,"name":"","username":"franck22000","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/f/f4b2a3/{size}.png","created_at":"2015-05-25T17:34:13.000Z","cooked":"\u003cp\u003eSomeone helped me to fix the issue.\u003c/p\u003e\n\u003cp\u003ethis make the code crash:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eImage* _pImage(new Image(context_));\n_pImage-\u0026gt;SetSize(512, 512, 3);\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eAnd this is working:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eImage* _pImage(new Image(context_));\n_pImage-\u0026gt;SetSize(512, 512, 4);\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eit works !\u003c/p\u003e\n\u003cp\u003eCan someone explain me why i need 4 component instead of 3 ? I just need RGB component \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e\n\u003cp\u003eDo i have found a Urho3D bug here ?\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T01:05:17.580Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":43,"readers_count":42,"score":8.6,"yours":false,"topic_id":1080,"topic_slug":"saving-rendertarget-texture-to-image","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":174,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6248,"name":"","username":"franck22000","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/f/f4b2a3/{size}.png","created_at":"2015-05-25T18:58:30.000Z","cooked":"\u003cp\u003eHello Sinoid (thank you for all your work related to Urho3D by the way).\u003c/p\u003e\n\u003cp\u003eYou mean checking the render target texture format ?\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-01-02T01:05:17.826Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":41,"readers_count":40,"score":13.2,"yours":false,"topic_id":1080,"topic_slug":"saving-rendertarget-texture-to-image","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":174,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6258,"name":"","username":"franck22000","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/f/f4b2a3/{size}.png","created_at":"2015-05-26T08:08:02.000Z","cooked":"\u003caside class=\"quote\"\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThere should probably be a function for returning the number of components in a format.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eThat fonction would be usefull\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2017-01-02T01:05:18.550Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":41,"readers_count":40,"score":8.2,"yours":false,"topic_id":1080,"topic_slug":"saving-rendertarget-texture-to-image","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":174,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6348,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2015-05-31T17:23:21.000Z","cooked":"\u003cp\u003eGetData() from rendertarget texture was not working on D3D9. It should be fixed in the master branch. Also added GetComponents() to Texture class to determine the number of components needed in Image to hold the returned data. Note that it will return 0 (illegal, basically) for compressed formats.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2017-01-02T01:05:25.128Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":2,"reads":37,"readers_count":36,"score":62.4,"yours":false,"topic_id":1080,"topic_slug":"saving-rendertarget-texture-to-image","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[6244,6245,6248,6258,6348]},"timeline_lookup":[[1,2739],[2,2738],[5,2732]],"suggested_topics":[{"id":7138,"title":"Build fails (linking phase) on Linux","fancy_title":"Build fails (linking phase) on Linux","slug":"build-fails-linking-phase-on-linux","posts_count":4,"reply_count":0,"highest_post_number":4,"image_url":null,"created_at":"2022-01-20T03:08:29.663Z","last_posted_at":"2022-01-21T15:27:41.192Z","bumped":true,"bumped_at":"2022-01-21T15:27:41.192Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":178,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1502,"username":"jasperry","name":"Jason Perry","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/j/5fc32e/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1304,"username":"lebrewer","name":"lebrewer","avatar_template":"/user_avatar/discourse.urho3d.io/lebrewer/{size}/2811_2.png"}}]},{"id":7081,"title":"Install Urho3D Library - Windows 10 - rake build - \"project does not exist\"","fancy_title":"Install Urho3D Library - Windows 10 - rake build - \u0026ldquo;project does not exist\u0026rdquo;","slug":"install-urho3d-library-windows-10-rake-build-project-does-not-exist","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-03T03:06:40.974Z","last_posted_at":"2021-12-03T17:53:10.844Z","bumped":true,"bumped_at":"2021-12-03T17:53:10.844Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":190,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1488,"username":"ToolmakerSteve","name":"ToolmakerSteve","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ba9def/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1491,"username":"xlat","name":"Alex Kuch","avatar_template":"/user_avatar/discourse.urho3d.io/xlat/{size}/3620_2.png"}}]},{"id":7098,"title":"Cartoon Fire Effect","fancy_title":"Cartoon Fire Effect","slug":"cartoon-fire-effect","posts_count":6,"reply_count":0,"highest_post_number":6,"image_url":null,"created_at":"2021-12-10T04:08:49.887Z","last_posted_at":"2021-12-12T02:49:51.076Z","bumped":true,"bumped_at":"2021-12-12T02:49:51.076Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":6,"views":274,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]},{"id":7074,"title":"First Person and 3rd person camera and water reflections","fancy_title":"First Person and 3rd person camera and water reflections","slug":"first-person-and-3rd-person-camera-and-water-reflections","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-01T18:37:28.669Z","last_posted_at":"2021-12-01T21:19:51.519Z","bumped":true,"bumped_at":"2021-12-01T21:19:51.519Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":158,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]},{"id":7268,"title":"Get vertex position before Morph in shader","fancy_title":"Get vertex position before Morph in shader","slug":"get-vertex-position-before-morph-in-shader","posts_count":8,"reply_count":6,"highest_post_number":8,"image_url":null,"created_at":"2022-05-15T19:44:19.139Z","last_posted_at":"2022-05-16T06:11:07.099Z","bumped":true,"bumped_at":"2022-08-12T22:38:31.553Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":5,"views":209,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1205,"username":"Askhento","name":"Askhento","avatar_template":"/user_avatar/discourse.urho3d.io/askhento/{size}/3849_2.png"}},{"extras":"latest","description":"Most Recent Poster, Accepted Answer","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1358,"username":"JSandusky","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jsandusky/{size}/3220_2.png"}}]}],"tags_descriptions":{},"id":1080,"title":"Saving rendertarget texture to image","fancy_title":"Saving rendertarget texture to image","posts_count":5,"created_at":"2015-05-25T17:05:58.000Z","views":863,"reply_count":0,"like_count":1,"last_posted_at":"2015-05-31T17:23:21.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"saving-rendertarget-texture-to-image","category_id":10,"word_count":496,"deleted_at":null,"user_id":174,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_1080","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":5,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":174,"username":"franck22000","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/f/f4b2a3/{size}.png","post_count":4,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":3,"username":"cadaver","name":"Lasse Öörni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":2}],"created_by":{"id":174,"username":"franck22000","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/f/f4b2a3/{size}.png"},"last_poster":{"id":3,"username":"cadaver","name":"Lasse Öörni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png"},"links":[{"url":"http://discourse.urho3d.io/t/texture2d-getdata-and-rendertargets/1093","title":"Texture2D GetData and RenderTargets","internal":true,"attachment":false,"reflection":true,"clicks":1,"user_id":3,"domain":"discourse.urho3d.io","root_domain":"urho3d.io"}]}}