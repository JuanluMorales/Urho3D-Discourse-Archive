{"post_stream":{"posts":[{"id":8591,"name":"","username":"practicing01","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/p/b5e925/{size}.png","created_at":"2015-11-14T13:40:22.000Z","cooked":"\u003cp\u003eEdit: This worked:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003elocal v = Variant(self.targetData.node_)\nlocal ed = VariantMap()\ned[\"Node\"] = v\nSendEvent(\"GetNodeInfo\", ed)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eUnfinished script for snippet reference:\u003c/p\u003e\n\u003cp\u003e[spoiler][code]\u003cbr\u003e\nCyberetta = ScriptObject()\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:Start()\u003cbr\u003e\nself.skillData =\u003cbr\u003e\n{\u003cbr\u003e\nclientExecuting_ = false,\u003cbr\u003e\nelapsedTime_ = 0.0,\u003cbr\u003e\ncooldown_ = 0.0\u003cbr\u003e\n}\u003c/p\u003e\n\u003cp\u003eself.targetData =\u003cbr\u003e\n{\u003cbr\u003e\nnode_ = nil,\u003cbr\u003e\nlc_ = “”,\u003cbr\u003e\nclientID_ = -1,\u003cbr\u003e\nnodeID_ = -1\u003cbr\u003e\n}\u003c/p\u003e\n\u003cp\u003eself:SubscribeToEvent(“SkillbarButt”, “Cyberetta:HandleSkillbarButt”)\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:Stop()\u003cbr\u003e\nif self.skillData.clientExecuting_ then\u003cbr\u003e\nlocal ed = VariantMap()\u003cbr\u003e\nSendEvent(“TouchUnSubscribe”, ed)\u003cbr\u003e\nend\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:HandleSetNodeInfo(eventType, eventData)\u003cbr\u003e\nlocal sceneNode = eventData[“Node”]:GetPtr(“Node”)\u003c/p\u003e\n\u003cp\u003eif sceneNode == self.targetData.node_ then\u003cbr\u003e\nself.targetData.lc_ = eventData[“Lc”]:GetString()\u003cbr\u003e\nself.targetData.clientID_ = eventData[“ClientID”]:GetInt()\u003cbr\u003e\nself.targetData.nodeID_ = eventData[“NodeID”]:GetInt()\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003eself:UnsubscribeFromEvent(“SetNodeInfo”)\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:HandleSkillbarButt(eventType, eventData)\u003cbr\u003e\nlocal skill = eventData[“Skill”]:GetString()\u003cbr\u003e\nif skill ~= “Cyberetta” then\u003cbr\u003e\nreturn\u003cbr\u003e\nend\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003elocal blindLC = self.node:GetComponent(\"Blind\")\nlocal isBlind = false\n\nif blindLC ~= nil then\n  isBlind = blindLC.isBlind_\nend\n \nif self.skillData.clientExecuting_ == true and isBlind == true then\n  return\nend\n\nself.skillData.clientExecuting_ = true\nself.skillData.elapsedTime_ = 0.0\n\nlocal ed = VariantMap()\nSendEvent(\"TouchSubscribe\", ed)\n\nself:SubscribeToEvent(\"TouchEnd\", \"Cyberetta:HandleTouchEnd\")\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eend\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:HandleTouchEnd(eventType, eventData)\u003cbr\u003e\nif ui.focusElement ~= nil then\u003cbr\u003e\nreturn\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003eself:UnsubscribeFromEvent(“TouchEnd”)\u003c/p\u003e\n\u003cp\u003elocal ed = VariantMap()\u003c/p\u003e\n\u003cp\u003eSendEvent(“TouchUnSubscribe”, ed)\u003c/p\u003e\n\u003cp\u003elocal cameraNode = self.node:GetChild(“cameraNode”)\u003cbr\u003e\nlocal camera = cameraNode:GetComponent(“Camera”)\u003c/p\u003e\n\u003cp\u003elocal pos = { x = 0.0, y = 0.0}\u003cbr\u003e\npos.x = eventData[“X”]:GetInt()\u003cbr\u003e\npos.y = eventData[“Y”]:GetInt()\u003c/p\u003e\n\u003cp\u003elocal cameraRay = camera:GetScreenRay(pos.x / graphics.width, pos.y / graphics.height)\u003c/p\u003e\n\u003cp\u003elocal physicsWorld = self.node:GetScene():GetComponent(“PhysicsWorld”)\u003c/p\u003e\n\u003cp\u003elocal raeResult = physicsWorld:RaycastSingle(cameraRay, 10000.0, 2)\u003c/p\u003e\n\u003cp\u003eif raeResult.body ~= nil then\u003cbr\u003e\nself:ClearTarget()\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eself.targetData.node_ = raeResult.body:GetNode()\n\nself:SubscribeToEvent(\"SetNodeInfo\", \"Cyberetta:HandleSetNodeInfo\")\n\nlocal v = Variant(self.targetData.node_)\nlocal ed = VariantMap()\ned[\"Node\"] = v\nSendEvent(\"GetNodeInfo\", ed)\n\nif self.targetData.clientID_ ~= -1 then\n  self:Exec(0.0, true)\nend\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eelse\u003cbr\u003e\nself.skillData.clientExecuting_ = false\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003eend\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:Exec(timeRamp, sendToServer)\u003cbr\u003e\nif engine:IsHeadless() ~= true then\u003cbr\u003e\n–particles and sound\u003cbr\u003e\nend\u003cbr\u003e\nprint(“execing”)\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:ClearTarget()\u003cbr\u003e\nself.targetData.node_ = nil\u003cbr\u003e\nself.targetData.lc_ = \"\"\u003cbr\u003e\nself.targetData.clientID_ = -1\u003cbr\u003e\nself.targetData.nodeID_ = -1\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003e[/code][/spoiler]\u003c/p\u003e\n\u003cp\u003eHello, I’m getting “attempt to call method ‘SetPtr’ (a nil value)” with the following lua code:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003elocal ed = VariantMap()\ned:SetPtr(\"Node\", self.node)\nSendEvent(\"GetNodeInfo\", ed)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThanks for any help.\u003c/p\u003e\n\u003cp\u003eFull, incomplete script:\u003c/p\u003e\n\u003cp\u003e[spoiler][code]\u003cbr\u003e\nCyberetta = ScriptObject()\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:Start()\u003cbr\u003e\nself.skillData =\u003cbr\u003e\n{\u003cbr\u003e\nclientExecuting_ = false,\u003cbr\u003e\nelapsedTime_ = 0.0,\u003cbr\u003e\ncooldown_ = 0.0\u003cbr\u003e\n}\u003c/p\u003e\n\u003cp\u003eself:SubscribeToEvent(“SetNodeInfo”, “Cyberetta:HandleSetNodeInfo”)\u003cbr\u003e\nlocal ed = VariantMap()\u003cbr\u003e\ned:SetPtr(“Node”, self.node)\u003cbr\u003e\nSendEvent(“GetNodeInfo”, ed)\u003c/p\u003e\n\u003cp\u003eself:SubscribeToEvent(“SkillbarButt”, “Cyberetta:HandleSkillbarButt”)\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:Stop()\u003cbr\u003e\nif self.skillData.clientExecuting_ then\u003cbr\u003e\nlocal ed = VariantMap()\u003cbr\u003e\nSendEvent(“TouchUnSubscribe”, ed)\u003cbr\u003e\nend\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:HandleSetNodeInfo(eventType, eventData)\u003cbr\u003e\nlocal sceneNode = eventData[“Node”]:GetPtr(“Node”)\u003c/p\u003e\n\u003cp\u003eif sceneNode == self.node then\u003cbr\u003e\n–\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003eself:UnsubscribeFromEvent(“SetNodeInfo”)\u003cbr\u003e\nprint(“got SetNodeInfo”)\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:HandleSkillbarButt(eventType, eventData)\u003cbr\u003e\nlocal skill = eventData[“Skill”]:GetString()\u003cbr\u003e\nif skill ~= “Cyberetta” then\u003cbr\u003e\nreturn\u003cbr\u003e\nend\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003elocal blindLC = self.node:GetComponent(\"Blind\")\nlocal isBlind = false\n\nif blindLC ~= nil then\n  isBlind = blindLC.isBlind_\nend\n \nif self.skillData.clientExecuting_ == true and isBlind == true then\n  return\nend\n\nself.skillData.clientExecuting_ = true\nself.skillData.elapsedTime_ = 0.0\n\nlocal ed = VariantMap()\nSendEvent(\"TouchSubscribe\", ed)\n\nself:SubscribeToEvent(\"TouchEnd\", \"Cyberetta:HandleTouchEnd\")\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eend\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:HandleTouchEnd(eventType, eventData)\u003cbr\u003e\nif ui.focusElement ~= nil then\u003cbr\u003e\nreturn\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003eself:UnsubscribeFromEvent(“TouchEnd”)\u003c/p\u003e\n\u003cp\u003elocal ed = VariantMap()\u003cbr\u003e\nSendEvent(“TouchUnSubscribe”, ed)\u003c/p\u003e\n\u003cp\u003elocal cameraNode = self.node:GetChild(“cameraNode”)\u003cbr\u003e\nlocal camera = cameraNode:GetComponent(“Camera”)\u003c/p\u003e\n\u003cp\u003elocal pos = { x = 0.0, y = 0.0}\u003cbr\u003e\npos.x = eventData[“X”]:GetInt()\u003cbr\u003e\npos.y = eventData[“Y”]:GetInt()\u003c/p\u003e\n\u003cp\u003elocal cameraRay = camera:GetScreenRay(pos.x / graphics.width, pos.y / graphics.height)\u003c/p\u003e\n\u003cp\u003elocal physicsWorld = self.node:GetScene():GetComponent(“PhysicsWorld”)\u003c/p\u003e\n\u003cp\u003elocal raeResult = physicsWorld:RaycastSingle(cameraRay, 10000.0, 2)\u003c/p\u003e\n\u003cp\u003eif raeResult.body ~= nil then\u003cbr\u003e\nlocal targetNode = raeResult.body:GetNode()\u003cbr\u003e\n–self:Exec()\u003cbr\u003e\nelse\u003cbr\u003e\nself.skillData.clientExecuting_ = false\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003eend\u003c/p\u003e\n\u003cp\u003efunction Cyberetta:Exec(clientID, nodeID, timeRamp, sendToServer)\u003cbr\u003e\nif engine:IsHeadless() ~= true then\u003cbr\u003e\n–particles and sound\u003cbr\u003e\nend\u003c/p\u003e\n\u003cp\u003eend\u003c/p\u003e\n\u003cp\u003e[/code][/spoiler]\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T01:08:08.042Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":24,"reads":5,"readers_count":4,"score":121.0,"yours":false,"topic_id":1494,"topic_slug":"solved-how-to-add-node-to-variantmap-in-lua","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":140,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[8591]},"timeline_lookup":[[1,2566]],"suggested_topics":[{"id":7278,"title":"Compile Urho3D With LLVM-MINGW","fancy_title":"Compile Urho3D With LLVM-MINGW","slug":"compile-urho3d-with-llvm-mingw","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-06-06T14:35:21.445Z","last_posted_at":"2022-06-17T13:40:34.662Z","bumped":true,"bumped_at":"2022-06-17T13:40:34.662Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":133,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":745,"username":"ChunFengTsin","name":"Chun Feng Tsin","avatar_template":"/user_avatar/discourse.urho3d.io/chunfengtsin/{size}/450_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":461,"username":"Victor","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/v/3e96dc/{size}.png"}}]},{"id":7263,"title":"Is Steam integration like this possible?","fancy_title":"Is Steam integration like this possible?","slug":"is-steam-integration-like-this-possible","posts_count":4,"reply_count":0,"highest_post_number":4,"image_url":null,"created_at":"2022-05-12T22:06:15.739Z","last_posted_at":"2022-05-14T22:02:38.197Z","bumped":true,"bumped_at":"2022-05-14T22:02:38.197Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":202,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1292,"username":"evolgames","name":"evol","avatar_template":"/user_avatar/discourse.urho3d.io/evolgames/{size}/3169_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1358,"username":"JSandusky","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jsandusky/{size}/3220_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":184,"username":"Enhex","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/enhex/{size}/81_2.png"}}]},{"id":7268,"title":"Get vertex position before Morph in shader","fancy_title":"Get vertex position before Morph in shader","slug":"get-vertex-position-before-morph-in-shader","posts_count":8,"reply_count":6,"highest_post_number":8,"image_url":null,"created_at":"2022-05-15T19:44:19.139Z","last_posted_at":"2022-05-16T06:11:07.099Z","bumped":true,"bumped_at":"2022-08-12T22:38:31.553Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":5,"views":209,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1205,"username":"Askhento","name":"Askhento","avatar_template":"/user_avatar/discourse.urho3d.io/askhento/{size}/3849_2.png"}},{"extras":"latest","description":"Most Recent Poster, Accepted Answer","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1358,"username":"JSandusky","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jsandusky/{size}/3220_2.png"}}]},{"id":7182,"title":"How install landscape in the format (.tor or .obj)?","fancy_title":"How install landscape in the format (.tor or .obj)?","slug":"how-install-landscape-in-the-format-tor-or-obj","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2022-02-03T16:58:20.976Z","last_posted_at":"2022-02-04T16:34:09.663Z","bumped":true,"bumped_at":"2022-02-04T16:34:09.663Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":151,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1497,"username":"timob256","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/b782af/{size}.png"}},{"extras":"latest","description":"Most Recent Poster, Accepted Answer","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7313,"title":"RenderPaths and depth texture","fancy_title":"RenderPaths and depth texture","slug":"renderpaths-and-depth-texture","posts_count":4,"reply_count":0,"highest_post_number":4,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/4/4115352ee634066092d24dcacacc24d2ec90206d.png","created_at":"2022-08-15T03:31:55.300Z","last_posted_at":"2022-08-19T11:32:37.386Z","bumped":true,"bumped_at":"2022-08-19T11:32:37.386Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":136,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":1404,"username":"shifttab","name":"shifttab","avatar_template":"/user_avatar/discourse.urho3d.io/shifttab/{size}/3250_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]}],"tags_descriptions":{},"id":1494,"title":"[Solved] How To Add Node* To VariantMap in Lua?","fancy_title":"[Solved] How To Add Node* To VariantMap in Lua?","posts_count":1,"created_at":"2015-11-14T13:40:22.000Z","views":282,"reply_count":0,"like_count":0,"last_posted_at":"2015-11-14T13:40:22.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"solved-how-to-add-node-to-variantmap-in-lua","category_id":10,"word_count":641,"deleted_at":null,"user_id":140,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_1494","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":1,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":1,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":140,"username":"practicing01","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/p/b5e925/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1}],"created_by":{"id":140,"username":"practicing01","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/p/b5e925/{size}.png"},"last_poster":{"id":140,"username":"practicing01","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/p/b5e925/{size}.png"}}}