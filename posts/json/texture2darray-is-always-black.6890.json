{"post_stream":{"posts":[{"id":42941,"name":"Chris Cranford","username":"Naros","avatar_template":"/user_avatar/discourse.urho3d.io/naros/{size}/2728_2.png","created_at":"2021-06-12T01:00:19.533Z","cooked":"\u003cp\u003eSo I‚Äôm having some trouble with a custom material, technique, and GLSL shader.  I‚Äôve stripped this down to the bare minimum here and despite having done so, the sampling of the texture array is always black.\u003c/p\u003e\n\u003cp\u003eMaterials/Test.xml\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\u0026lt;material\u0026gt;\n  \u0026lt;technique name=\"Techniques/Test.xml\" quality=\"2\" loddistance=\"0\" /\u0026gt;\n  \u0026lt;texture unit=\"0\" name=\"Textures/Test.xml\" /\u0026gt;\n\u0026lt;/material\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTechniques/Test.xml\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\u0026lt;technique vs=\"Test\" ps=\"Test\"\u0026gt;\n  \u0026lt;pass name=\"base\" /\u0026gt;\n  \u0026lt;pass name=\"material\" depthtest=\"equal\" depthwrite=\"false\" blend=\"add\" /\u0026gt;\n\u0026lt;/technique\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTextures/Test.xml\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\u0026lt;texturearray\u0026gt;\n  \u0026lt;layer name=\"Textures/ground.png\" /\u0026gt;\n  \u0026lt;layer name=\"Textures/grass.png\" /\u0026gt;\n\u0026lt;/texturearray\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eShaders/GLSL/Test.glsl\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e#include \"Uniforms.glsl\"\n#include \"Transform.glsl\"\n#include \"ScreenPos.glsl\"\n\n#ifdef GL3\n#define texture2D texture\n#define texture2DProj textureProj\n#define texture3D texture\n#define textureCube texture\n#define texture2DLod textureLod\n#define texture2DLodOffset textureLodOffset\n#endif\n\n#ifdef COMPILEPS\nuniform sampler2DArray sDiffArrayMap;\n#endif\n\nvarying vec2 vTexCoord1;\nvarying vec4 vWorldPos;\n\nvoid VS()\n{\n  mat4 modelMatrix = iModelMatrix;\n\n  vec3 worldPos = GetWorldPos( modelMatrix );\n  gl_Position = GetClipPos( worldPos );\n\n  vTexCoord1 = GetTexCoord( iTexCoord );   \n\n  vWorldPos = vec4( worldPos, GetDepth( gl_Position ) );\n}\n\nvoid PS()\n{\n  // Sample the second texture in the array\n  gl_FragColor = texture( sDiffArrayMap, vec3( vTexCoord1.x, vTexCoord1.y, 1.0 ) );\n}\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn the code, I‚Äôm obtaining the material as:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003eauto *material = cache-\u0026gt;GetResource\u0026lt;Urho3D::Material\u0026gt;( \"Materials/Test.xml\" );\nmodel-\u0026gt;SetMaterial( material );\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhen I adjust the code to use a \u003ccode\u003esampler2D\u003c/code\u003e and a single texture rather than the texture array, the model is rendered with the single texture.  I‚Äôve checked the logs and there is no compiler error or warnings about resources being unavailable, so it must be something in the shader code?\u003c/p\u003e\n\u003cp\u003eI‚Äôm not entirely sure what I might have done wrong here, does anyone have any ideas?\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2021-06-12T01:02:26.162Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":9,"reads":18,"readers_count":17,"score":48.6,"yours":false,"topic_id":6890,"topic_slug":"texture2darray-is-always-black","display_username":"Chris Cranford","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":876,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":42943,"name":"Chris Cranford","username":"Naros","avatar_template":"/user_avatar/discourse.urho3d.io/naros/{size}/2728_2.png","created_at":"2021-06-12T01:11:58.610Z","cooked":"\u003cp\u003eLooks like my problem was the fact that I was defining the uniform as:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003euniform sampler2DArray sDiffArrayMap;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eHowever there must be a definition somewhere that requires me to define it as:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003euniform sampler2DArray sDiffMap;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eChanging that the \u003ccode\u003eTexture2DArray\u003c/code\u003e sampling works as I expected.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2021-06-12T01:11:58.610Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":17,"readers_count":16,"score":8.4,"yours":false,"topic_id":6890,"topic_slug":"texture2darray-is-always-black","display_username":"Chris Cranford","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":876,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":42954,"name":"J Tippetts","username":"JTippetts1","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png","created_at":"2021-06-13T13:20:40.600Z","cooked":"\u003cp\u003eIn the \u003ca href=\"https://urho3d.io/documentation/HEAD/_shaders.html\"\u003edocumentation for Shaders\u003c/a\u003e it states ‚ÄúIn GLSL shaders it is important that the samplers are assigned to the correct texture units. If you are using sampler names that are not predefined in the engine like sDiffMap, just make sure there is a number somewhere in the sampler‚Äôs name and it will be interpreted as the texture unit.‚Äù Your shader works with sDiffMap because sDiffMap is one of the pre-defined texture units. sDiffArrayMap is not, so you need to incorporate the assigned texture slot number into the name sDiffArrayMap. eg, sDiffArrayMap0.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2021-06-13T13:20:40.600Z","reply_count":0,"reply_to_post_number":2,"quote_count":0,"incoming_link_count":0,"reads":15,"readers_count":14,"score":3.0,"yours":false,"topic_id":6890,"topic_slug":"texture2darray-is-always-black","display_username":"J Tippetts","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://urho3d.io/documentation/HEAD/_shaders.html","internal":false,"reflection":false,"title":"Urho3D - Documentation - Shaders","clicks":1}],"read":true,"user_title":null,"reply_to_user":{"username":"Naros","name":"Chris Cranford","avatar_template":"/user_avatar/discourse.urho3d.io/naros/{size}/2728_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":631,"hidden":false,"trust_level":0,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[42941,42943,42954]},"timeline_lookup":[[1,529],[3,528]],"suggested_topics":[{"id":7193,"title":"Can Z-Axis Feasibly be \"Up\"?","fancy_title":"Can Z-Axis Feasibly be \u0026ldquo;Up\u0026rdquo;?","slug":"can-z-axis-feasibly-be-up","posts_count":4,"reply_count":2,"highest_post_number":4,"image_url":null,"created_at":"2022-02-14T05:17:28.054Z","last_posted_at":"2022-02-14T07:26:53.817Z","bumped":true,"bumped_at":"2022-02-14T07:26:53.817Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":161,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]},{"id":7098,"title":"Cartoon Fire Effect","fancy_title":"Cartoon Fire Effect","slug":"cartoon-fire-effect","posts_count":6,"reply_count":0,"highest_post_number":6,"image_url":null,"created_at":"2021-12-10T04:08:49.887Z","last_posted_at":"2021-12-12T02:49:51.076Z","bumped":true,"bumped_at":"2021-12-12T02:49:51.076Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":6,"views":274,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]},{"id":7107,"title":"Error: SDL/SDL_gamecontroller.h: No such file or directory #include \u003cSDL/SDL_gamecontroller.h\u003e","fancy_title":"Error: SDL/SDL_gamecontroller.h: No such file or directory #include \u0026lt;SDL/SDL_gamecontroller.h\u0026gt;","slug":"error-sdl-sdl-gamecontroller-h-no-such-file-or-directory-include-sdl-sdl-gamecontroller-h","posts_count":6,"reply_count":1,"highest_post_number":6,"image_url":null,"created_at":"2021-12-21T15:29:52.810Z","last_posted_at":"2021-12-22T15:32:44.818Z","bumped":true,"bumped_at":"2021-12-22T15:32:44.818Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":271,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1497,"username":"timob256","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/b782af/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7127,"title":"Switching ribbon trails emission glitches transparent materials","fancy_title":"Switching ribbon trails emission glitches transparent materials","slug":"switching-ribbon-trails-emission-glitches-transparent-materials","posts_count":8,"reply_count":3,"highest_post_number":8,"image_url":null,"created_at":"2022-01-13T17:17:46.847Z","last_posted_at":"2022-02-10T08:10:49.330Z","bumped":true,"bumped_at":"2022-02-10T08:10:49.330Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":323,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1188,"username":"Taqer","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/d2c977/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]},{"id":7204,"title":"How handle with multiple scenes?","fancy_title":"How handle with multiple scenes?","slug":"how-handle-with-multiple-scenes","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-02-23T16:15:02.697Z","last_posted_at":"2022-02-23T16:15:02.762Z","bumped":true,"bumped_at":"2022-02-23T16:15:02.762Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":131,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":1508,"username":"killinbassou","name":"killin","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/k/848f3c/{size}.png"}}]}],"tags_descriptions":{},"id":6890,"title":"Texture2DArray is always black","fancy_title":"Texture2DArray is always black","posts_count":3,"created_at":"2021-06-12T01:00:19.428Z","views":222,"reply_count":1,"like_count":0,"last_posted_at":"2021-06-13T13:20:40.600Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"texture2darray-is-always-black","category_id":10,"word_count":414,"deleted_at":null,"user_id":876,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_6890","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":3,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":876,"username":"Naros","name":"Chris Cranford","avatar_template":"/user_avatar/discourse.urho3d.io/naros/{size}/2728_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":0}],"created_by":{"id":876,"username":"Naros","name":"Chris Cranford","avatar_template":"/user_avatar/discourse.urho3d.io/naros/{size}/2728_2.png"},"last_poster":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"},"links":[{"url":"https://urho3d.io/documentation/HEAD/_shaders.html","title":"Urho3D - Documentation - Shaders","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":631,"domain":"urho3d.io","root_domain":"urho3d.io"}]}}