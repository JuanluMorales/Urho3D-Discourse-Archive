{"post_stream":{"posts":[{"id":6438,"name":"","username":"victorfence","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/v/e9a140/{size}.png","created_at":"2015-06-11T07:37:59.000Z","cooked":"\u003cp\u003eI am busy integrate vuforia with urho3d (only for android by now)\u003c/p\u003e\n\u003cp\u003eThis is so hard for me as a new bee. But I desired to see them working together.\u003c/p\u003e\n\u003cp\u003eI try to draw vuforia’s camera background in urho3d’s update event listener.\u003c/p\u003e\n\u003cp\u003eAs below:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003evoid Player::Start() {\n  ...\n  SubscribeToEvent(E_UPDATE, HANDLER(Player, HandleUpdate));\n  ...\n}\n\nvoid Player::HandleUpdate(StringHash eventType, VariantMap\u0026amp; eventData) {\n  QCAR::State state = QCAR::Renderer::getInstance().begin();\n\n  //** \n  QCAR::CameraDevice\u0026amp; cameraDevice = QCAR::CameraDevice::getInstance();\n  QCAR::VideoMode videoMode = cameraDevice. getVideoMode(QCAR::CameraDevice::MODE_DEFAULT);\n  \n  //**  Configure the video background\n  QCAR::VideoBackgroundConfig config;\n  config.mEnabled = true;\n  config.mSynchronous = true;\n  config.mPosition.data[0] = 0.0f;\n  config.mPosition.data[1] = 0.0f;\n  config.mSize.data[0] = 720;\n  config.mSize.data[1] =1280;\n  QCAR::Renderer::getInstance().setVideoBackgroundConfig(config);\n\n  //** dont work, black window, dont't know why\n  // QCAR::Renderer::getInstance().drawVideoBackground();\n\n  //** get frame image\n  QCAR::State state = QCAR::Renderer::getInstance().begin();\n  ///QCAR::setFrameFormat( QCAR::RGB565, true );\n  QCAR::setFrameFormat( QCAR::RGB888, true );\n  QCAR::Frame qcarframe = state.getFrame();\n  const QCAR::Image *imageRGB888 = NULL;\n  for(int i=0; i\u0026lt;qcarframe.getNumImages();i++) {\n    const QCAR::Image *pimg  = qcarframe.getImage(i);\n    if (pimg-\u0026gt;getFormat() == QCAR::RGB888) {\n      imageRGB888 = pimg;\n      break;\n    }\n  }\n\n  //** found image, this works!!\n  if (imageRGB888 != NULL) {\n    __android_log_print(ANDROID_LOG_INFO, \"Player\", \"found imageRGB888\");\n    const short* pixels = (const short*) imageRGB888-\u0026gt;getPixels();\n    int width = imageRGB888-\u0026gt;getWidth();\n    int height = imageRGB888-\u0026gt;getHeight();\n    int numPixels = width * height;\n\n    //*** todo: draw image\n    \n    __android_log_print(ANDROID_LOG_INFO, \"Player\",\"888image size: %d %d\", width, height);\n  }\n\n  QCAR::Renderer::getInstance().end();\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSome explain:\u003cbr\u003e\n“drawVideoBackground” never working as offical demo, I saw only a black window.\u003cbr\u003e\ngoogle again and again, I found the camera frame image can be fetched.\u003cbr\u003e\nSo, my current question is:\u003cbr\u003e\nhow to display the buffered image as urho3d’s background? (I wish that no need to modify urho3d’s source code)\u003c/p\u003e\n\u003cp\u003eBy the way, I’d like to see urho3d engine integerate vuforia in future \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T01:05:31.953Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":53,"reads":8,"readers_count":7,"score":266.6,"yours":false,"topic_id":1113,"topic_slug":"solved-integrate-vuforia-possible","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":250,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6441,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2015-06-11T09:06:30.000Z","cooked":"\u003cp\u003eYou can insert a quad rendering command in the renderpath after clear and before the rendering commands, to make it draw a texture each frame before rendering the 3D scene.\u003c/p\u003e\n\u003cp\u003eFor example, a modified Forward.xml renderpath that would draw the mushroom texture:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\u0026lt;renderpath\u0026gt;\n    \u0026lt;command type=\"clear\" color=\"fog\" depth=\"1.0\" stencil=\"0\" /\u0026gt;\n    \u0026lt;command type=\"quad\" vs=\"CopyFramebuffer\" ps=\"CopyFramebuffer\"\u0026gt;\n        \u0026lt;texture unit=\"diff\" name=\"Textures/Mushroom.dds\" /\u0026gt;\n    \u0026lt;/command\u0026gt;\n    \u0026lt;command type=\"scenepass\" pass=\"base\" vertexlights=\"true\" metadata=\"base\" /\u0026gt;\n    \u0026lt;command type=\"forwardlights\" pass=\"light\" /\u0026gt;\n    ...\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo replace this with the video texture, you must create a Texture2D, set a name for it, for example “VideoTexture”, add it to the resource cache as a manual resource (ResourceCache::AddManualResource()) so the renderpath can find it, and set the texture unit in the quad command as follows:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e      \u0026lt;texture unit=\"diff\" name=\"VideoTexture\" /\u0026gt;\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow you can use SetData() on the Texture2D to upload the camera image data. I have no idea however what the performance will be on Android, when modifying (reuploading) the video texture every frame.\u003c/p\u003e\n\u003cp\u003eAs for Vuforia integration, we only integrate fully permissive open source libraries with BSD / zlib -like licensing into the Urho3D base, so that rather falls for an external contributor, who creates a separate project (“Urho Vuforia integration” or something like that), and people can then use it if they agree with the licensing.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T01:05:32.162Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":8,"readers_count":7,"score":1.6,"yours":false,"topic_id":1113,"topic_slug":"solved-integrate-vuforia-possible","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6442,"name":"Yao Wei Tjong","username":"weitjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png","created_at":"2015-06-11T09:09:32.000Z","cooked":"\u003cp\u003eI have tried this integration before. The performance on Android is acceptable. My approach is similar to what have been outlined by cadaver.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-01-02T01:05:32.236Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":7,"readers_count":6,"score":1.4,"yours":false,"topic_id":1113,"topic_slug":"solved-integrate-vuforia-possible","display_username":"Yao Wei Tjong","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Admin","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":4,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6451,"name":"","username":"victorfence","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/v/e9a140/{size}.png","created_at":"2015-06-12T04:15:43.000Z","cooked":"\u003cp\u003eThanks for your reply, this saved me!!!\u003cbr\u003e\nFollowed cadaver’s idea, I saw the camera video as background(seems good performance), it’s so exciting \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003cbr\u003e\nAnd it’s a very elegance idea I think. I like it.\u003c/p\u003e\n\u003cp\u003eThe only problem is the video is 90 degree rotated, can you point me how to solve this?\u003cbr\u003e\nCan I rotate the texture mapping or something else? How?\u003c/p\u003e\n\u003cp\u003eCode for uploading the camera image data:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e  if (imageRGB888 != NULL) {\n    const unsigned char* pixels = (const unsigned char*) imageRGB888-\u0026gt;getPixels();\n    int width = imageRGB888-\u0026gt;getWidth();\n    int height = imageRGB888-\u0026gt;getHeight();\n    //*** draw image\n    image-\u0026gt;SetData(pixels);\n    bool result=mTexture-\u0026gt;SetData(image);\n  }\u003c/code\u003e\u003c/pre\u003e","post_number":4,"post_type":1,"updated_at":"2017-01-02T01:05:32.870Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":7,"readers_count":6,"score":6.4,"yours":false,"topic_id":1113,"topic_slug":"solved-integrate-vuforia-possible","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":250,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6452,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2015-06-12T07:42:47.000Z","cooked":"\u003cp\u003eYou could make a copy of the CopyFramebuffer shader that samples the texture in a rotated fashion (faster), or make a rotated pixel buffer on the CPU before you SetData() to the texture (slower).\u003c/p\u003e\n\u003cp\u003eNormally texture scrolling / scaling / rotation would be controlled from material but renderpath quad commands don’t use materials, only textures.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2017-01-02T01:05:32.936Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":7,"readers_count":6,"score":1.4,"yours":false,"topic_id":1113,"topic_slug":"solved-integrate-vuforia-possible","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6485,"name":"","username":"victorfence","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/v/e9a140/{size}.png","created_at":"2015-06-18T06:49:16.000Z","cooked":"\u003caside class=\"quote\"\u003e\n\u003cblockquote\u003e\n\u003cp\u003e…make a copy of the CopyFramebuffer shader that samples the texture in a rotated fashion (faster)…\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eI’v made my own CopyFramebuffer shader, this work like a charm, thanks \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2017-01-02T01:05:35.533Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":7,"readers_count":6,"score":1.4,"yours":false,"topic_id":1113,"topic_slug":"solved-integrate-vuforia-possible","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":250,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[6438,6441,6442,6451,6452,6485]},"timeline_lookup":[[1,2722],[4,2721],[6,2715]],"suggested_topics":[{"id":7304,"title":"Urho3D is crashing on Android 12","fancy_title":"Urho3D is crashing on Android 12","slug":"urho3d-is-crashing-on-android-12","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-07-28T10:03:51.280Z","last_posted_at":"2022-07-28T10:03:51.349Z","bumped":true,"bumped_at":"2022-07-28T10:38:06.014Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":126,"category_id":9,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":809,"username":"elix22","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/elix22/{size}/1437_2.png"}}]},{"id":7344,"title":"Do we give up supporting dx11？","fancy_title":"Do we give up supporting dx11？","slug":"do-we-give-up-supporting-dx11","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-11-03T09:37:37.893Z","last_posted_at":"2022-11-03T13:09:15.153Z","bumped":true,"bumped_at":"2022-11-03T15:28:58.128Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":78,"category_id":9,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1510,"username":"SoNewBee","name":"So New Bee","avatar_template":"/user_avatar/discourse.urho3d.io/sonewbee/{size}/3755_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}}]},{"id":7347,"title":"How does Urho handle script objects each frame?","fancy_title":"How does Urho handle script objects each frame?","slug":"how-does-urho-handle-script-objects-each-frame","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-11-08T02:33:56.461Z","last_posted_at":"2022-11-08T14:46:09.857Z","bumped":true,"bumped_at":"2022-11-08T14:46:09.857Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":64,"category_id":9,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1292,"username":"evolgames","name":"evol","avatar_template":"/user_avatar/discourse.urho3d.io/evolgames/{size}/3169_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7204,"title":"How handle with multiple scenes?","fancy_title":"How handle with multiple scenes?","slug":"how-handle-with-multiple-scenes","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-02-23T16:15:02.697Z","last_posted_at":"2022-02-23T16:15:02.762Z","bumped":true,"bumped_at":"2022-02-23T16:15:02.762Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":131,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":1508,"username":"killinbassou","name":"killin","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/k/848f3c/{size}.png"}}]},{"id":7073,"title":"A plan to support static batching","fancy_title":"A plan to support static batching","slug":"a-plan-to-support-static-batching","posts_count":5,"reply_count":2,"highest_post_number":5,"image_url":null,"created_at":"2021-12-01T03:43:48.579Z","last_posted_at":"2021-12-02T23:30:07.199Z","bumped":true,"bumped_at":"2021-12-02T23:30:07.199Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":180,"category_id":16,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1490,"username":"Sunc","name":"DoubleSuper","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/df788c/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]}],"tags_descriptions":{},"id":1113,"title":"[Solved] Integrate vuforia, possible?","fancy_title":"[Solved] Integrate vuforia, possible?","posts_count":6,"created_at":"2015-06-11T07:37:59.000Z","views":473,"reply_count":0,"like_count":0,"last_posted_at":"2015-06-18T06:49:16.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"solved-integrate-vuforia-possible","category_id":9,"word_count":746,"deleted_at":null,"user_id":250,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_1113","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":6,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":3,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":250,"username":"victorfence","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/v/e9a140/{size}.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":3,"username":"cadaver","name":"Lasse Öörni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":2},{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":4}],"created_by":{"id":250,"username":"victorfence","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/v/e9a140/{size}.png"},"last_poster":{"id":250,"username":"victorfence","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/v/e9a140/{size}.png"}}}