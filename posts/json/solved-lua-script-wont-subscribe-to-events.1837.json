{"post_stream":{"posts":[{"id":10592,"name":"","username":"Lunarovich","avatar_template":"/user_avatar/discourse.urho3d.io/lunarovich/{size}/2097_2.png","created_at":"2016-03-04T02:37:09.000Z","cooked":"\u003cp\u003eHello! I’m trying to run Lua scripts. Everything is going fine except for the event subscribing.\u003c/p\u003e\n\u003cp\u003eSo, I start by loading and executing lua files in the .cpp:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003ecache-\u0026gt;GetResource\u0026lt;LuaFile\u0026gt;(\"LuaScripts/01_HelloWorld.lua\");\ncache-\u0026gt;GetResource\u0026lt;LuaFile\u0026gt;(\"LuaScripts/Utilities/Sample.lua\");\n\nLuaScript* script = new LuaScript(context_);\n\nscript-\u0026gt;ExecuteFile(\"LuaScripts/01_HelloWorld.lua\");\nLuaFunction* start = script-\u0026gt;GetFunction(\"Start\");\nstart-\u0026gt;BeginCall();\nstart-\u0026gt;EndCall();\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAfter building and running the project I get following messages:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"http://i.imgur.com/XblZPyQ.png?1\" alt=\"\" width=\"489\" height=\"346\"\u003e\u003c/p\u003e\n\u003cp\u003eApparently, something is preventing Lua scripts from registering events… Or should I put something specific in the .cpp code?\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T01:10:34.784Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":23,"reads":8,"readers_count":7,"score":116.6,"yours":false,"topic_id":1837,"topic_slug":"solved-lua-script-wont-subscribe-to-events","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":421,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":10604,"name":"","username":"Lunarovich","avatar_template":"/user_avatar/discourse.urho3d.io/lunarovich/{size}/2097_2.png","created_at":"2016-03-04T22:25:30.000Z","cooked":"\u003cp\u003eI’ll post the entire program here in order to make it clear what I’m doing. So, I’m just trying to hook in Lua script into Main.cpp and continue development in Lua from that point (I know I’m not supposed to do all the dev in Lua, but I want to do it for the sake of learning and fun). Here is the entire code:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e#include \u0026lt;Urho3D/Engine/Application.h\u0026gt;\n#include \u0026lt;Urho3D/Engine/Engine.h\u0026gt;\n#include \u0026lt;Urho3D/Input/InputEvents.h\u0026gt;\nusing namespace Urho3D;\nclass MyApp : public Application\n{\npublic:\n  MyApp(Context* context) :\n    Application(context)\n  {\n  }\n  virtual void Setup()\n  {\n    // Called before engine initialization. engineParameters_ member variable can be modified here\n    engineParameters_[\"FullScreen\"] = false;\n\n    context_-\u0026gt;RegisterSubsystem(new LuaScript(context_));\n  }\n  virtual void Start()\n  {\n    // Called after engine initialization. Setup application \u0026amp; subscribe to events here\n    SubscribeToEvent(E_KEYDOWN, URHO3D_HANDLER(MyApp, HandleKeyDown));\n\n    LuaScript* luaScript = new LuaScript(context_);\n    luaScript-\u0026gt;ExecuteFile(\"Data/LuaScripts/TestScene.lua\");\n    LuaFunction* lf = luaScript-\u0026gt;GetFunction(\"Start\");\n    lf-\u0026gt;BeginCall();\n    lf-\u0026gt;EndCall();\n  }\n  virtual void Stop()\n  {\n    // Perform optional cleanup after main loop has terminated\n  }\n  void HandleKeyDown(StringHash eventType, VariantMap\u0026amp; eventData)\n  {\n    using namespace KeyDown;\n    // Check for pressing ESC. Note the engine_ member variable for convenience access to the Engine object\n    int key = eventData[P_KEY].GetInt();\n    if (key == KEY_ESC)\n      engine_-\u0026gt;Exit();\n  }\n};\nURHO3D_DEFINE_APPLICATION_MAIN(MyApp)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe example works just fine. However, I cannot subscribe to any event via Lua script. Lua complains that it cannot find callback functions specified in respective SubscribeToEvent function calls. So, everything gets loaded, displayed and animated, but there is no input handling, no scene update, etc.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T01:10:35.627Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":7,"readers_count":6,"score":1.4,"yours":false,"topic_id":1837,"topic_slug":"solved-lua-script-wont-subscribe-to-events","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":421,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":10883,"name":"","username":"Lunarovich","avatar_template":"/user_avatar/discourse.urho3d.io/lunarovich/{size}/2097_2.png","created_at":"2016-03-13T12:13:23.000Z","cooked":"\u003cp\u003eOK, I’ve figured it out. I was forgetting to register a particular Lua script with the context:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e#include \u0026lt;Urho3D/Engine/Application.h\u0026gt;\n#include \u0026lt;Urho3D/Engine/Engine.h\u0026gt;\n#include \u0026lt;Urho3D/Input/InputEvents.h\u0026gt;\nusing namespace Urho3D;\nclass MyApp : public Application\n{\npublic:\n  MyApp(Context* context) :\n    Application(context)\n  {\n  }\n  virtual void Setup()\n  {\n    // Called before engine initialization. engineParameters_ member variable can be modified here\n    engineParameters_[\"FullScreen\"] = false;\n    \n    // THIS LINE HAS NO EFFECT SINCE THE POINTER TO THE new LuaScript IS LOST\n    context_-\u0026gt;RegisterSubsystem(new LuaScript(context_));\n  }\n  virtual void Start()\n  {\n    // Called after engine initialization. Setup application \u0026amp; subscribe to events here\n    SubscribeToEvent(E_KEYDOWN, URHO3D_HANDLER(MyApp, HandleKeyDown));\n\n    LuaScript* luaScript = new LuaScript(context_);\n\n    // REGISTER luaScript WITH the context_\n    context_-\u0026gt;RegisterSubsystem(luaScript);\n\n    luaScript-\u0026gt;ExecuteFile(\"Data/LuaScripts/TestScene.lua\");\n    LuaFunction* lf = luaScript-\u0026gt;GetFunction(\"Start\");\n    lf-\u0026gt;BeginCall();\n    lf-\u0026gt;EndCall();\n  }\n  virtual void Stop()\n  {\n    // Perform optional cleanup after main loop has terminated\n  }\n  void HandleKeyDown(StringHash eventType, VariantMap\u0026amp; eventData)\n  {\n    using namespace KeyDown;\n    // Check for pressing ESC. Note the engine_ member variable for convenience access to the Engine object\n    int key = eventData[P_KEY].GetInt();\n    if (key == KEY_ESC)\n      engine_-\u0026gt;Exit();\n  }\n};\nURHO3D_DEFINE_APPLICATION_MAIN(MyApp)\u003c/code\u003e\u003c/pre\u003e","post_number":3,"post_type":1,"updated_at":"2017-01-02T01:10:56.004Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":7,"readers_count":6,"score":1.4,"yours":false,"topic_id":1837,"topic_slug":"solved-lua-script-wont-subscribe-to-events","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":421,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":11005,"name":"","username":"thebluefish","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/f04885/{size}.png","created_at":"2016-03-15T16:30:10.000Z","cooked":"\u003cp\u003eInstead of creating a new LuaScript subsystem, why not just use the existing?\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003eLuaScript* luaScript = context_-\u0026gt;GetSubsystem\u0026lt;LuaScript\u0026gt;();\u003c/code\u003e\u003c/pre\u003e","post_number":4,"post_type":1,"updated_at":"2017-01-02T01:11:04.652Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":7,"readers_count":6,"score":1.4,"yours":false,"topic_id":1837,"topic_slug":"solved-lua-script-wont-subscribe-to-events","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":80,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[10592,10604,10883,11005]},"timeline_lookup":[[1,2455],[2,2454],[3,2446],[4,2444]],"suggested_topics":[{"id":7179,"title":"Need help with cusomized PBR renderpath","fancy_title":"Need help with cusomized PBR renderpath","slug":"need-help-with-cusomized-pbr-renderpath","posts_count":4,"reply_count":0,"highest_post_number":4,"image_url":null,"created_at":"2022-02-01T09:04:58.692Z","last_posted_at":"2022-02-03T17:35:34.174Z","bumped":true,"bumped_at":"2022-02-03T17:35:34.174Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":13,"views":205,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster, Accepted Answer","user":{"id":247,"username":"Dave82","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]},{"id":7104,"title":"Bug in my partial-model copying code","fancy_title":"Bug in my partial-model copying code","slug":"bug-in-my-partial-model-copying-code","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/5/5367e370779d64989e5c3ff2c1ebfb0689908c87.png","created_at":"2021-12-17T03:50:19.405Z","last_posted_at":"2021-12-17T13:50:49.662Z","bumped":true,"bumped_at":"2021-12-17T13:50:49.662Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":144,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7092,"title":"Finding the World Space Coordinates of the Screen Edges","fancy_title":"Finding the World Space Coordinates of the Screen Edges","slug":"finding-the-world-space-coordinates-of-the-screen-edges","posts_count":6,"reply_count":2,"highest_post_number":6,"image_url":null,"created_at":"2021-12-07T20:53:49.453Z","last_posted_at":"2021-12-08T12:33:52.510Z","bumped":true,"bumped_at":"2021-12-08T12:33:52.510Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":210,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":1456,"username":"Jens","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/j/d2c977/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}}]},{"id":7176,"title":"Orthographic scene slowing down when zooming out","fancy_title":"Orthographic scene slowing down when zooming out","slug":"orthographic-scene-slowing-down-when-zooming-out","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-01-30T10:05:50.218Z","last_posted_at":"2022-01-30T10:05:50.294Z","bumped":true,"bumped_at":"2022-01-30T10:05:50.294Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":127,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":1351,"username":"Haukinger","name":"Haukinger","avatar_template":"/user_avatar/discourse.urho3d.io/haukinger/{size}/3670_2.png"}}]},{"id":7181,"title":"StaticModelGroup - Are ShaderParameters Shared?","fancy_title":"StaticModelGroup - Are ShaderParameters Shared?","slug":"staticmodelgroup-are-shaderparameters-shared","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-02-02T09:31:19.658Z","last_posted_at":"2022-02-02T17:06:24.059Z","bumped":true,"bumped_at":"2022-02-02T17:06:24.059Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":120,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]}],"tags_descriptions":{},"id":1837,"title":"[SOLVED] Lua script won't subscribe to events","fancy_title":"[SOLVED] Lua script won\u0026rsquo;t subscribe to events","posts_count":4,"created_at":"2016-03-04T02:37:09.000Z","views":648,"reply_count":0,"like_count":0,"last_posted_at":"2016-03-15T16:30:10.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"solved-lua-script-wont-subscribe-to-events","category_id":10,"word_count":552,"deleted_at":null,"user_id":421,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_1837","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":4,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":421,"username":"Lunarovich","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/lunarovich/{size}/2097_2.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":80,"username":"thebluefish","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/f04885/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1}],"created_by":{"id":421,"username":"Lunarovich","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/lunarovich/{size}/2097_2.png"},"last_poster":{"id":80,"username":"thebluefish","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/f04885/{size}.png"}}}