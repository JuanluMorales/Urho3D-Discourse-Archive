{"post_stream":{"posts":[{"id":6141,"name":"","username":"Dave82","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png","created_at":"2015-05-17T11:21:01.000Z","cooked":"\u003cp\u003eHi , i finished my mesh loader but  i can’t get it to work properly… It seems that the data is loaded correctly , but it’s always 1/3 of my mesh is rendered (i’m assuming that theres something wrong with the index buffer but can’t figure it out , its like the draw range should be indexCount * 3…)\u003c/p\u003e\n\u003cp\u003eThere should be 10 spheres on this picture but only 3.33 of them are visible :\u003cbr\u003e\n\u003cimg src=\"http://s28.postimg.org/4q54fxxpp/spheres.jpg\" alt=\"\" width=\"\" height=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eHere’s my loading code (NOTE : I used the push method to fill the buffers so it’s easier to read the code)\u003c/p\u003e\n\u003cp\u003e[code]Urho3D::StaticModel * TFSceneLoader::readStaticModel(Urho3D::File \u0026amp;file)\u003cbr\u003e\n{\u003cbr\u003e\n// parse the file and load the corresponding data (exported from 3ds max)\u003cbr\u003e\nint numMeshBuffers = file.ReadInt();\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e// Use dynamic lighting ? (Not used in Urho3D)\nbool useDynamicLighting = file.ReadBool();\n\n// list of all materials used by this model\nUrho3D::Vector\u0026lt;Urho3D::SharedPtr\u0026lt;Urho3D::Material\u0026gt; \u0026gt; materials;\n\nINFLOG(\"---------- LOADING MESH STARTED --------------------\\n\");\nINFLOG(\"       Num mesh buffers : %d \" , numMeshBuffers)\n\n// first read materials.They are stored in the same order as the VertexBuffers\nfor (int x = 0; x \u0026lt; numMeshBuffers; x++)\n{\n\tUrho3D::SharedPtr\u0026lt;Urho3D::Material\u0026gt; mat(readMaterial(file));\n\tmaterials.Push(mat);\n}\n\nUrho3D::SharedPtr\u0026lt;Urho3D::Model\u0026gt; model(new Urho3D::Model(context_));\nmodel-\u0026gt;SetNumGeometries(numMeshBuffers);\n\nUrho3D::BoundingBox bb;\n\n// read Geometries (mesh buffers in irrlicht)\n// One geometry component holds 1 vertex and index buffer\nfor (int m = 0; m \u0026lt; numMeshBuffers; m++)\n{\n\tUrho3D::SharedPtr\u0026lt;Urho3D::Geometry\u0026gt; newGeometry(new Urho3D::Geometry(context_));\n\t\n\tint numVertices = file.ReadInt();\n\tchar uvSets = file.ReadByte();\n\n\tINFLOG(\"              Num Vertices : %d \" , numVertices)\n\tINFLOG(\"              Vertex type : %d \" , uvSets)\n\n\tunsigned int vertexDecl = Urho3D::MASK_POSITION|Urho3D::MASK_NORMAL|Urho3D::MASK_TEXCOORD1;\n\tif (uvSets == 2) vertexDecl |= Urho3D::MASK_TEXCOORD2;\n\t\n\t// Create vertexData buffer\n\tUrho3D::Vector\u0026lt;float\u0026gt; vertexData;\n\n\tfor (int v = 0; v \u0026lt; numVertices; v++)\n\t{\n\t\tUrho3D::Vector3 pos = file.ReadVector3(); \n\t\tUrho3D::Vector3 normal = file.ReadVector3(); \n\t\tUrho3D::Vector2 uv1 = file.ReadVector2();\n\n\t\tvertexData.Push(pos.x_); vertexData.Push(pos.y_); vertexData.Push(pos.z_);\n\t\tvertexData.Push(normal.x_); vertexData.Push(normal.y_); vertexData.Push(normal.z_);\n\t\tvertexData.Push(uv1.x_); vertexData.Push(uv1.y_);\n                                      \n                                      // If there's 2nd uv set for lightmap...\n\t\tif (vertexDecl \u0026amp; Urho3D::MASK_TEXCOORD2)\n\t\t{\n\t\t\tUrho3D::Vector2 uv2 = file.ReadVector2();\n\t\t\tvertexData.Push(uv2.x_);\n\t\t\tvertexData.Push(uv2.y_);\n\t\t}\n\t\t// store aabb point;\n\t\tbb.Merge(pos);\n\t}\n\n\t// read index buffer :\n\tint indexCount =  file.ReadInt();\n\tUrho3D::Vector\u0026lt;unsigned short\u0026gt; indexData;\n\n\tINFLOG(\"              Num indices : %d \" , indexCount)\n\n\tfor (int ib = 0; ib \u0026lt; indexCount; ib++)\n\t{\n\t\tindexData.Push(file.ReadUShort());\n\t\tindexData.Push(file.ReadUShort());\n\t\tindexData.Push(file.ReadUShort());\n\t}\n\n\t// create vertex buffer\n\tUrho3D::SharedPtr\u0026lt;Urho3D::VertexBuffer\u0026gt; vertexBuffer(new Urho3D::VertexBuffer(context_));\n\tvertexBuffer-\u0026gt;SetShadowed(true);\n\tvertexBuffer-\u0026gt;SetSize(numVertices , vertexDecl);\n\tvertexBuffer-\u0026gt;SetData(\u0026amp;vertexData[0]);\n\t\n\t// create index buffer\n\tUrho3D::SharedPtr\u0026lt;Urho3D::IndexBuffer\u0026gt; indexBuffer(new Urho3D::IndexBuffer(context_));\n\tindexBuffer-\u0026gt;SetShadowed(true);\n\tindexBuffer-\u0026gt;SetSize(indexCount , false);\n\tindexBuffer-\u0026gt;SetData(\u0026amp;indexData[0]);\n\n\t// add buffers to geometry\n\tnewGeometry-\u0026gt;SetVertexBuffer(0 , vertexBuffer);\n\tnewGeometry-\u0026gt;SetIndexBuffer(indexBuffer);\n\tnewGeometry-\u0026gt;SetDrawRange(Urho3D::TRIANGLE_LIST, 0, indexCount);\n\n\tmodel-\u0026gt;SetGeometry(m , 0 , newGeometry);\n\tmodel-\u0026gt;SetNumGeometryLodLevels(m,1);\t\n}\n\nmodel-\u0026gt;SetBoundingBox(bb);\n\nINFLOG(\"---------- LOADING MESH FINISHED --------------------\\n\");\n\nUrho3D::StaticModel * staticModel = new Urho3D::StaticModel(context_);\nstaticModel-\u0026gt;SetModel(model);\n\nfor (int m = 0; m \u0026lt; numMeshBuffers; m++)\n{\n\tstaticModel-\u0026gt;SetMaterial(materials[m]);\n}\nreturn staticModel;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e}[/code]\u003c/p\u003e\n\u003cp\u003eI checked : i load the correct number of vertices and indices.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T01:05:09.967Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":30,"reads":16,"readers_count":15,"score":153.2,"yours":false,"topic_id":1065,"topic_slug":"custom-mesh-loading-problem-solved","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":247,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6147,"name":"","username":"Dave82","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png","created_at":"2015-05-17T15:20:23.000Z","cooked":"\u003cp\u003eAHHH how could i be so blind… i had to\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eand not\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIt works perfectly now…\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T01:05:10.378Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":15,"readers_count":14,"score":3.0,"yours":false,"topic_id":1065,"topic_slug":"custom-mesh-loading-problem-solved","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":247,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[6141,6147]},"timeline_lookup":[[1,2747]],"suggested_topics":[{"id":7304,"title":"Urho3D is crashing on Android 12","fancy_title":"Urho3D is crashing on Android 12","slug":"urho3d-is-crashing-on-android-12","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-07-28T10:03:51.280Z","last_posted_at":"2022-07-28T10:03:51.349Z","bumped":true,"bumped_at":"2022-07-28T10:38:06.014Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":126,"category_id":9,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":809,"username":"elix22","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/elix22/{size}/1437_2.png"}}]},{"id":7347,"title":"How does Urho handle script objects each frame?","fancy_title":"How does Urho handle script objects each frame?","slug":"how-does-urho-handle-script-objects-each-frame","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-11-08T02:33:56.461Z","last_posted_at":"2022-11-08T14:46:09.857Z","bumped":true,"bumped_at":"2022-11-08T14:46:09.857Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":64,"category_id":9,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1292,"username":"evolgames","name":"evol","avatar_template":"/user_avatar/discourse.urho3d.io/evolgames/{size}/3169_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7344,"title":"Do we give up supporting dx11？","fancy_title":"Do we give up supporting dx11？","slug":"do-we-give-up-supporting-dx11","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-11-03T09:37:37.893Z","last_posted_at":"2022-11-03T13:09:15.153Z","bumped":true,"bumped_at":"2022-11-03T15:28:58.128Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":78,"category_id":9,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1510,"username":"SoNewBee","name":"So New Bee","avatar_template":"/user_avatar/discourse.urho3d.io/sonewbee/{size}/3755_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}}]},{"id":7268,"title":"Get vertex position before Morph in shader","fancy_title":"Get vertex position before Morph in shader","slug":"get-vertex-position-before-morph-in-shader","posts_count":8,"reply_count":6,"highest_post_number":8,"image_url":null,"created_at":"2022-05-15T19:44:19.139Z","last_posted_at":"2022-05-16T06:11:07.099Z","bumped":true,"bumped_at":"2022-08-12T22:38:31.553Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":5,"views":209,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1205,"username":"Askhento","name":"Askhento","avatar_template":"/user_avatar/discourse.urho3d.io/askhento/{size}/3849_2.png"}},{"extras":"latest","description":"Most Recent Poster, Accepted Answer","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1358,"username":"JSandusky","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jsandusky/{size}/3220_2.png"}}]},{"id":7346,"title":"Texture3D always black","fancy_title":"Texture3D always black","slug":"texture3d-always-black","posts_count":5,"reply_count":1,"highest_post_number":5,"image_url":null,"created_at":"2022-11-04T11:32:57.664Z","last_posted_at":"2022-11-04T16:02:38.352Z","bumped":true,"bumped_at":"2022-11-04T16:12:59.437Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":66,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1399,"username":"Simeon","name":"Siméon Schwab","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/e9a140/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]}],"tags_descriptions":{},"id":1065,"title":"Custom mesh loading problem[SOLVED]","fancy_title":"Custom mesh loading problem[SOLVED]","posts_count":2,"created_at":"2015-05-17T11:21:01.000Z","views":338,"reply_count":0,"like_count":0,"last_posted_at":"2015-05-17T15:20:23.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"custom-mesh-loading-problem-solved","category_id":9,"word_count":550,"deleted_at":null,"user_id":247,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_1065","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":2,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":1,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":247,"username":"Dave82","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":247,"username":"Dave82","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png"},"last_poster":{"id":247,"username":"Dave82","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png"}}}