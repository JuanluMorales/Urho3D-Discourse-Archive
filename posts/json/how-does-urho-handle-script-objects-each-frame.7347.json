{"post_stream":{"posts":[{"id":45834,"name":"evol","username":"evolgames","avatar_template":"/user_avatar/discourse.urho3d.io/evolgames/{size}/3169_2.png","created_at":"2022-11-08T02:33:56.533Z","cooked":"\u003cp\u003eI’m always learning something new here. Sometimes I’m not sure if it’s a lua thing or an Urho thing. For context, I’m scripting with lua. I’m curious about script objects. I’ve been using them in projects for a while now, after seeing them in the samples. They seem to be very convenient. I can store data easily self.x self.health etc. I can instantiate a bunch of npcs and create a script object when I do so, and they will automatically run the NPC:Update() function, without me having to cycle through a list and do so manually. If you look at the samples, like the character sample, it’s easy to take that script object and make multiple player characters in the same manner. In fact, I did so for an online multiplayer game.\u003c/p\u003e\n\u003cp\u003eHowever, I’ve noticed that with large numbers (in this case, 4000) that performance is hurting from these. Maybe I’m using them wrong. I was attaching a script object to each tile in a topdown 2d game. The script object functions would handle animations of the sprites (I don’t use spriter animations) and disable the nodes at certain points and other stuff. Basically, manipulate the static sprites and check things each frame. I’m getting very bad frame rates doing this. And it’s not a matter of culling because I need certain things, like entities and items, to update offscreen and was planning on keeping this. So like 40-60 fps. For example, each water tile has a script object to handle waves and animations, grass tiles have them for certain spawn points and triggers, and so on.\u003c/p\u003e\n\u003cp\u003eI took out the script objects and tried putting each tile in a table and running:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003efunction UpdateTiles()\n\tfor i=1,#animTiles do\n\t\tanimTiles[i].tile:GetComponent(\"StaticSprite2D\").color = Color(Random(1),Random(1),Random(1),1)\n\tend\nend\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eJust as a test manipulation of all 4000 tiles every frame. And to my surprise the fps is 900-1200. I just always assumed the script objects were not that much different from some kind of list that runs certain functions in the program loop. I also assume Nodes are similar?\u003c/p\u003e\n\u003cp\u003eHow are script objects handled in Urho? Any reason they would be slower than just cycling through a table every frame? I don’t really need a solution since the above works great for anything I’d need to do to or with a tile, just really curious why that works better.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2022-11-08T02:33:56.533Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":21,"readers_count":20,"score":4.2,"yours":false,"topic_id":7347,"topic_slug":"how-does-urho-handle-script-objects-each-frame","display_username":"evol","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1292,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":45835,"name":"SirNate0","username":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png","created_at":"2022-11-08T04:00:34.742Z","cooked":"\u003cp\u003eI’m not certain about this, but I think crossing from C++ to script may be the bottleneck with the ScriptObject approach. Your for loop remains within the Lua interpreter (well, it calls the functions to set the values and all) and so there’s greater possibility for the interpreter to optimize it, especially if you are using LuaJIT.\u003c/p\u003e\n\u003cp\u003eTake Python as an extreme example - starting the python interpreter can take a significant portion of a second, while running a line in a for loop can be only a few times slower than the comparable machine code, taking only microseconds.\u003c/p\u003e\n\u003cp\u003ePossibly you made some sort of other mistake with the script objects, which didn’t occur with the for loop, but the above would be my first guess.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2022-11-08T04:00:34.742Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":20,"readers_count":19,"score":9.0,"yours":false,"topic_id":7347,"topic_slug":"how-does-urho-handle-script-objects-each-frame","display_username":"SirNate0","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":628,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":45843,"name":"evol","username":"evolgames","avatar_template":"/user_avatar/discourse.urho3d.io/evolgames/{size}/3169_2.png","created_at":"2022-11-08T14:46:09.857Z","cooked":"\u003cp\u003eAh okay that makes sense. Thanks for the example. I noticed it also depends on what operation I do, but it does seem that the script objects are bottlenecked. It’s no big deal to do it the other way, fortunately.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2022-11-08T14:46:09.857Z","reply_count":0,"reply_to_post_number":2,"quote_count":0,"incoming_link_count":0,"reads":17,"readers_count":16,"score":3.4,"yours":false,"topic_id":7347,"topic_slug":"how-does-urho-handle-script-objects-each-frame","display_username":"evol","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1292,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[45834,45835,45843]},"timeline_lookup":[[1,15]],"suggested_topics":[{"id":7304,"title":"Urho3D is crashing on Android 12","fancy_title":"Urho3D is crashing on Android 12","slug":"urho3d-is-crashing-on-android-12","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-07-28T10:03:51.280Z","last_posted_at":"2022-07-28T10:03:51.349Z","bumped":true,"bumped_at":"2022-07-28T10:38:06.014Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":126,"category_id":9,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":809,"username":"elix22","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/elix22/{size}/1437_2.png"}}]},{"id":7344,"title":"Do we give up supporting dx11？","fancy_title":"Do we give up supporting dx11？","slug":"do-we-give-up-supporting-dx11","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-11-03T09:37:37.893Z","last_posted_at":"2022-11-03T13:09:15.153Z","bumped":true,"bumped_at":"2022-11-03T15:28:58.128Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":78,"category_id":9,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1510,"username":"SoNewBee","name":"So New Bee","avatar_template":"/user_avatar/discourse.urho3d.io/sonewbee/{size}/3755_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}}]},{"id":7218,"title":"Jolt Physics: physics engine from Horizon Forbidden West open-sourced","fancy_title":"Jolt Physics: physics engine from Horizon Forbidden West open-sourced","slug":"jolt-physics-physics-engine-from-horizon-forbidden-west-open-sourced","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2022-03-14T15:23:58.296Z","last_posted_at":"2022-03-21T03:18:16.555Z","bumped":true,"bumped_at":"2022-03-21T03:18:16.555Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":10,"views":439,"category_id":16,"featured_link":"https://github.com/jrouwe/JoltPhysics","featured_link_root_domain":"github.com","has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1304,"username":"lebrewer","name":"lebrewer","avatar_template":"/user_avatar/discourse.urho3d.io/lebrewer/{size}/2811_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1358,"username":"JSandusky","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jsandusky/{size}/3220_2.png"}}]},{"id":7281,"title":"Cannot launch + Converting .fbx to .ani","fancy_title":"Cannot launch + Converting .fbx to .ani","slug":"cannot-launch-converting-fbx-to-ani","posts_count":14,"reply_count":10,"highest_post_number":14,"image_url":null,"created_at":"2022-06-17T04:59:42.992Z","last_posted_at":"2022-06-20T16:21:59.555Z","bumped":true,"bumped_at":"2022-06-20T16:21:59.555Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":258,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1526,"username":"NoobBeggar","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/e68b1a/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7104,"title":"Bug in my partial-model copying code","fancy_title":"Bug in my partial-model copying code","slug":"bug-in-my-partial-model-copying-code","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/5/5367e370779d64989e5c3ff2c1ebfb0689908c87.png","created_at":"2021-12-17T03:50:19.405Z","last_posted_at":"2021-12-17T13:50:49.662Z","bumped":true,"bumped_at":"2021-12-17T13:50:49.662Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":144,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]}],"tags_descriptions":{},"id":7347,"title":"How does Urho handle script objects each frame?","fancy_title":"How does Urho handle script objects each frame?","posts_count":3,"created_at":"2022-11-08T02:33:56.461Z","views":64,"reply_count":1,"like_count":0,"last_posted_at":"2022-11-08T14:46:09.857Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"how-does-urho-handle-script-objects-each-frame","category_id":9,"word_count":594,"deleted_at":null,"user_id":1292,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_7347","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":3,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":1292,"username":"evolgames","name":"evol","avatar_template":"/user_avatar/discourse.urho3d.io/evolgames/{size}/3169_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":1292,"username":"evolgames","name":"evol","avatar_template":"/user_avatar/discourse.urho3d.io/evolgames/{size}/3169_2.png"},"last_poster":{"id":1292,"username":"evolgames","name":"evol","avatar_template":"/user_avatar/discourse.urho3d.io/evolgames/{size}/3169_2.png"}}}