{"post_stream":{"posts":[{"id":15848,"name":"","username":"TheComet","avatar_template":"/user_avatar/discourse.urho3d.io/thecomet/{size}/1493_2.png","created_at":"2017-01-25T02:22:36.865Z","cooked":"\u003cp\u003eI noticed that SDL_Init() is called only in the constructor of Graphics, however, in headless mode, Grahpics is never created. The Input, UI, FileSystem, and Audio subsystems and a few other objects will still call SDL functions, though.\u003c/p\u003e\n\u003cp\u003eWhy does headless mode work?\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-25T02:22:36.865Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":142,"reads":32,"readers_count":31,"score":716.4,"yours":false,"topic_id":2746,"topic_slug":"sdl-init-doesnt-get-called-in-headless-mode","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Community repository maintainer","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":37,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":15866,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2017-01-26T13:16:13.123Z","cooked":"\u003cp\u003eSDL_Init() is basically used here to tell “we are going to be a windowful application” and it inits the major SDL subsystems like video \u0026amp; audio. You can still use minor SDL “helper” functionality without.\u003c/p\u003e\n\u003cp\u003eAudio is actually a bit of luck because the Engine init doesn’t call Audio::SetMode() in headless mode. However you could call it yourself, which could result in something nasty happening.\u003c/p\u003e\n\u003cp\u003eThe point you raise is good, all the code related to this is worth reviewing. Though right now I can’t think of a better place to call SDL init, because ideally the individual subsystems should be usable e.g. without Engine class at all, and window opening / graphics rendering is tied strongest to SDL being fully initialized.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-26T13:17:23.214Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":2,"reads":31,"readers_count":30,"score":16.2,"yours":false,"topic_id":2746,"topic_slug":"sdl-init-doesnt-get-called-in-headless-mode","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":15867,"name":"","username":"TheComet","avatar_template":"/user_avatar/discourse.urho3d.io/thecomet/{size}/1493_2.png","created_at":"2017-01-26T14:37:56.221Z","cooked":"\u003cp\u003eI didn’t realise you could use Graphics without Engine. Now it makes sense to me why SDL was initialised like that.\u003c/p\u003e\n\u003cp\u003eMight I suggest moving \u003ccode\u003eSDL_Init()\u003c/code\u003e into the \u003ccode\u003eContext\u003c/code\u003e class? Depending on whether SDL should be initialised in headless mode or not, \u003ccode\u003eSDL_Init()\u003c/code\u003e could be called in the constructor or explicitly. For instance, here’s what the explicit method might look like:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eGraphics::Graphics(Context* context) : \n    Object(context),\n    // more stuff\n{\n    context_-\u0026gt;RequireSDL(SDL_INIT_VIDEO); \n}\n\nGraphics::~Graphics()\n{\n    context_-\u0026gt;ReleaseSDL();\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eContext\u003c/code\u003e would take care of initialising the various SDL systems by using \u003ccode\u003eSDL_WasInit()\u003c/code\u003e and additionally keep a global “reference count” of how many times SDL was initialised, so it knows when to call SDL_Quit().\u003c/p\u003e\n\u003cp\u003eThe audio subsystem would similarly call \u003ccode\u003econtext_-\u0026gt;RequireSDL()\u003c/code\u003e but pass in SDL_INIT_AUDIO.\u003c/p\u003e\n\u003cp\u003eOf course, the lazy solution could be to call \u003ccode\u003eSDL_Init(SDL_INIT_EVERYTHING)\u003c/code\u003e in the constructor of \u003ccode\u003eContext\u003c/code\u003e and be done with it.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-01-26T14:41:12.813Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":3,"reads":29,"readers_count":28,"score":20.8,"yours":false,"topic_id":2746,"topic_slug":"sdl-init-doesnt-get-called-in-headless-mode","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Community repository maintainer","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":37,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":15868,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2017-01-26T15:34:57.561Z","cooked":"\u003cp\u003eYes, that’s a good idea.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2017-01-26T15:34:57.561Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":23,"readers_count":22,"score":4.6,"yours":false,"topic_id":2746,"topic_slug":"sdl-init-doesnt-get-called-in-headless-mode","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":15871,"name":"","username":"TheComet","avatar_template":"/user_avatar/discourse.urho3d.io/thecomet/{size}/1493_2.png","created_at":"2017-01-26T17:54:08.870Z","cooked":"\u003cp\u003eI’ll submit a PR in that case, since I’m already poking around in these areas.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2017-01-26T17:54:08.870Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":22,"readers_count":21,"score":24.4,"yours":false,"topic_id":2746,"topic_slug":"sdl-init-doesnt-get-called-in-headless-mode","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Community repository maintainer","title_is_group":false,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":37,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[15848,15866,15867,15868,15871]},"timeline_lookup":[[1,2128],[2,2127],[5,2126]],"suggested_topics":[{"id":7211,"title":"Particle is low","fancy_title":"Particle is low","slug":"particle-is-low","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2022-03-03T13:52:14.991Z","last_posted_at":"2022-04-20T05:18:36.122Z","bumped":true,"bumped_at":"2022-04-20T05:18:36.122Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":232,"category_id":16,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1503,"username":"tianlv777","name":"zerrrrr","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/a4c791/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1491,"username":"xlat","name":"Alex Kuch","avatar_template":"/user_avatar/discourse.urho3d.io/xlat/{size}/3620_2.png"}}]},{"id":7136,"title":"Open-source ocean shader system","fancy_title":"Open-source ocean shader system","slug":"open-source-ocean-shader-system","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-01-19T23:11:15.784Z","last_posted_at":"2022-01-19T23:11:15.858Z","bumped":true,"bumped_at":"2022-01-19T23:11:15.858Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":177,"category_id":16,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":1304,"username":"lebrewer","name":"lebrewer","avatar_template":"/user_avatar/discourse.urho3d.io/lebrewer/{size}/2811_2.png"}}]},{"id":7062,"title":"Is WebGL2.0 \u0026 GLES3.0 being supported in the near future?","fancy_title":"Is WebGL2.0 \u0026amp; GLES3.0 being supported in the near future?","slug":"is-webgl2-0-gles3-0-being-supported-in-the-near-future","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-11-23T09:04:28.802Z","last_posted_at":"2021-11-23T21:44:08.088Z","bumped":true,"bumped_at":"2021-11-23T21:44:08.088Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":199,"category_id":16,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1490,"username":"Sunc","name":"DoubleSuper","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/df788c/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]},{"id":7196,"title":"Windows Urho3D build with -DURHO3D_OPENGL=1 using rake","fancy_title":"Windows Urho3D build with -DURHO3D_OPENGL=1 using rake","slug":"windows-urho3d-build-with-durho3d-opengl-1-using-rake","posts_count":18,"reply_count":9,"highest_post_number":19,"image_url":null,"created_at":"2022-02-20T12:49:25.777Z","last_posted_at":"2022-02-24T18:24:11.679Z","bumped":true,"bumped_at":"2022-02-24T18:24:11.679Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":254,"category_id":16,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":421,"username":"Lunarovich","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/lunarovich/{size}/2097_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png"}}]},{"id":7223,"title":"navMesh.FindPath(jack1.Position, pathPos); crash in android","fancy_title":"navMesh.FindPath(jack1.Position, pathPos); crash in android","slug":"navmesh-findpath-jack1-position-pathpos-crash-in-android","posts_count":15,"reply_count":13,"highest_post_number":17,"image_url":null,"created_at":"2022-03-22T06:21:34.927Z","last_posted_at":"2022-03-30T17:48:22.028Z","bumped":true,"bumped_at":"2022-03-30T17:48:22.028Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":242,"category_id":16,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1503,"username":"tianlv777","name":"zerrrrr","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/a4c791/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":230,"username":"Nerrik","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/958977/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":809,"username":"elix22","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/elix22/{size}/1437_2.png"}}]}],"tags_descriptions":{},"id":2746,"title":"SDL_Init() doesn't get called in headless mode?","fancy_title":"SDL_Init() doesn\u0026rsquo;t get called in headless mode?","posts_count":5,"created_at":"2017-01-25T02:22:36.807Z","views":939,"reply_count":0,"like_count":1,"last_posted_at":"2017-01-26T17:54:08.870Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"sdl-init-doesnt-get-called-in-headless-mode","category_id":16,"word_count":335,"deleted_at":null,"user_id":37,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_2746","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":5,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":37,"username":"TheComet","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/thecomet/{size}/1493_2.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":3,"username":"cadaver","name":"Lasse Öörni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":2}],"created_by":{"id":37,"username":"TheComet","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/thecomet/{size}/1493_2.png"},"last_poster":{"id":37,"username":"TheComet","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/thecomet/{size}/1493_2.png"}}}