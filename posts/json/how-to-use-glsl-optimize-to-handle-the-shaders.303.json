{"post_stream":{"posts":[{"id":1634,"name":"","username":"hualin","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/h/f6c823/{size}.png","created_at":"2014-06-14T05:11:47.000Z","cooked":"\u003cp\u003eHI,\u003cbr\u003e\nCurrently I can‚Äôt use glsl-optimize to optimize the shaders, it says that\u003c/p\u003e\n\u003cp\u003eFailed to compile Uniforms.glsl:\u003cbr\u003e\n0:69(1): error: syntax error, unexpected $end\u003c/p\u003e\n\u003cp\u003eor\u003c/p\u003e\n\u003cp\u003eFailed to compile Basic.glsl:\u003cbr\u003e\n0:1(3): preprocessor error: Invalid tokens after #\u003cbr\u003e\n0:2(2): preprocessor error: Invalid tokens after #\u003cbr\u003e\n0:3(2): preprocessor error: Invalid tokens after #\u003cbr\u003e\n.\u003c/p\u003e\n\u003cp\u003eCan I use the optimizer to handle the shaders for mobile platform?\u003c/p\u003e\n\u003cp\u003eThanks in advance.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T00:59:30.283Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":26,"reads":6,"readers_count":5,"score":131.2,"yours":false,"topic_id":303,"topic_slug":"how-to-use-glsl-optimize-to-handle-the-shaders","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":53,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":1636,"name":"","username":"boberfly","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/b/aeb1de/{size}.png","created_at":"2014-06-16T02:34:01.000Z","cooked":"\u003cp\u003eHi hualin,\u003c/p\u003e\n\u003cp\u003eUrho3D‚Äôs GLSL shader files are not standard GLSL. When the files are parsed in-engine all the includes are resolved by the engine itself and doesn‚Äôt use a GLSL extension to do that. Also the vertex shader and the fragment shader are contained in the one file, and their main function are renamed from VS()/PS() to main(), as well as all the parts that don‚Äôt make sense for the pipeline stage are commented out like all the attribute defines in the fragment shader, and then they are split in-engine before sent to the GL implementation.\u003c/p\u003e\n\u003cp\u003eA better approach perhaps would be to embed glsl-optimize into the engine itself in this part if possible, or get Urho3D to dump the GLSL it generates itself, I think \u003ccode\u003egraphics.BeginDumpShaders(const String\u0026amp;)\u003c/code\u003e should do it in AngelScript? Or in C++ \u003ca href=\"https://github.com/urho3d/Urho3D/blob/master/Source/Engine/Graphics/Shader.h\" rel=\"nofollow noopener\"\u003egithub.com/urho3d/Urho3D/blob/m ‚Ä¶ s/Shader.h\u003c/a\u003e has: \u003ccode\u003econst String\u0026amp; GetSourceCode(ShaderType type)\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eCheers\u003cbr\u003e\n-Alex\u003c/p\u003e\n\u003cp\u003eEdit: I meant attributes are commented out in the fragment shader not vertex shader‚Ä¶ \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T00:59:30.524Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":7,"readers_count":6,"score":1.4,"yours":false,"topic_id":303,"topic_slug":"how-to-use-glsl-optimize-to-handle-the-shaders","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/urho3d/Urho3D/blob/master/Source/Engine/Graphics/Shader.h","internal":false,"reflection":false,"clicks":1}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":69,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":1641,"name":"Lasse √ñ√∂rni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2014-06-16T10:46:08.000Z","cooked":"\u003cp\u003eYes, I second what boberfly said, to make glsl-optimize work properly it practically has to be embedded into the engine. During runtime, shaders are requested with various compilation defines (these are usually not known beforehand), and the shader code with those defines should be fed to glsl-optimize. The optimized code for that particular shader variation could then be written to disk and loaded directly on subsequent runs.\u003c/p\u003e\n\u003cp\u003eHowever when you‚Äôre doing this to optimize mobile shaders, the problem is that the desktop shader code and defines are not the same, and actually getting optimized shader code back from a device would not be convenient. Maybe you could make the desktop version also optimize and spit out the corresponding mobile shader, but this will take some hacking. The define GL_ES differentiates desktop \u0026amp; mobile mode in the shaders.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-01-02T00:59:30.904Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":7,"readers_count":6,"score":1.4,"yours":false,"topic_id":303,"topic_slug":"how-to-use-glsl-optimize-to-handle-the-shaders","display_username":"Lasse √ñ√∂rni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":1647,"name":"","username":"hualin","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/h/f6c823/{size}.png","created_at":"2014-06-17T10:04:41.000Z","cooked":"\u003cp\u003eThank you, boberfly, and cadaver.\u003cbr\u003e\nI see now.\u003cbr\u003e\nMaybe I will try to do this.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2017-01-02T00:59:31.301Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":6,"readers_count":5,"score":1.2,"yours":false,"topic_id":303,"topic_slug":"how-to-use-glsl-optimize-to-handle-the-shaders","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":53,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[1634,1636,1641,1647]},"timeline_lookup":[[1,3084],[2,3082],[4,3081]],"suggested_topics":[{"id":7107,"title":"Error: SDL/SDL_gamecontroller.h: No such file or directory #include \u003cSDL/SDL_gamecontroller.h\u003e","fancy_title":"Error: SDL/SDL_gamecontroller.h: No such file or directory #include \u0026lt;SDL/SDL_gamecontroller.h\u0026gt;","slug":"error-sdl-sdl-gamecontroller-h-no-such-file-or-directory-include-sdl-sdl-gamecontroller-h","posts_count":6,"reply_count":1,"highest_post_number":6,"image_url":null,"created_at":"2021-12-21T15:29:52.810Z","last_posted_at":"2021-12-22T15:32:44.818Z","bumped":true,"bumped_at":"2021-12-22T15:32:44.818Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":271,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1497,"username":"timob256","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/b782af/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7115,"title":"Is it possbile to use one billboard for a lens flare?","fancy_title":"Is it possbile to use one billboard for a lens flare?","slug":"is-it-possbile-to-use-one-billboard-for-a-lens-flare","posts_count":17,"reply_count":4,"highest_post_number":17,"image_url":null,"created_at":"2022-01-02T03:10:48.953Z","last_posted_at":"2022-01-03T21:37:51.953Z","bumped":true,"bumped_at":"2022-01-03T21:37:51.953Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":275,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7138,"title":"Build fails (linking phase) on Linux","fancy_title":"Build fails (linking phase) on Linux","slug":"build-fails-linking-phase-on-linux","posts_count":4,"reply_count":0,"highest_post_number":4,"image_url":null,"created_at":"2022-01-20T03:08:29.663Z","last_posted_at":"2022-01-21T15:27:41.192Z","bumped":true,"bumped_at":"2022-01-21T15:27:41.192Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":178,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1502,"username":"jasperry","name":"Jason Perry","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/j/5fc32e/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1304,"username":"lebrewer","name":"lebrewer","avatar_template":"/user_avatar/discourse.urho3d.io/lebrewer/{size}/2811_2.png"}}]},{"id":7160,"title":"RayCast trouble","fancy_title":"RayCast trouble","slug":"raycast-trouble","posts_count":17,"reply_count":9,"highest_post_number":19,"image_url":null,"created_at":"2022-01-29T00:06:00.367Z","last_posted_at":"2022-01-30T00:29:39.356Z","bumped":true,"bumped_at":"2022-01-30T00:29:39.356Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":260,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":627,"username":"George1","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/9e8a1a/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}}]},{"id":7074,"title":"First Person and 3rd person camera and water reflections","fancy_title":"First Person and 3rd person camera and water reflections","slug":"first-person-and-3rd-person-camera-and-water-reflections","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-01T18:37:28.669Z","last_posted_at":"2021-12-01T21:19:51.519Z","bumped":true,"bumped_at":"2021-12-01T21:19:51.519Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":158,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]}],"tags_descriptions":{},"id":303,"title":"How to use glsl-optimize to handle the shaders?","fancy_title":"How to use glsl-optimize to handle the shaders?","posts_count":4,"created_at":"2014-06-14T05:11:47.000Z","views":223,"reply_count":0,"like_count":0,"last_posted_at":"2014-06-17T10:04:41.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"how-to-use-glsl-optimize-to-handle-the-shaders","category_id":10,"word_count":420,"deleted_at":null,"user_id":53,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_303","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":4,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":3,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":53,"username":"hualin","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/h/f6c823/{size}.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":3,"username":"cadaver","name":"Lasse √ñ√∂rni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":2},{"id":69,"username":"boberfly","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/b/aeb1de/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1}],"created_by":{"id":53,"username":"hualin","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/h/f6c823/{size}.png"},"last_poster":{"id":53,"username":"hualin","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/h/f6c823/{size}.png"},"links":[{"url":"https://github.com/urho3d/Urho3D/blob/master/Source/Engine/Graphics/Shader.h","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":69,"domain":"github.com","root_domain":"github.com"}]}}