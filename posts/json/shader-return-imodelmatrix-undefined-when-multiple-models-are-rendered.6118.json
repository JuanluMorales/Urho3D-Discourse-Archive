{"post_stream":{"posts":[{"id":37504,"name":"Actually Permanent","username":"throwawayerino","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/da6949/{size}.png","created_at":"2020-04-24T22:53:29.785Z","cooked":"\u003cp\u003eWhen there’s only one model with that material it works wonderfully, but when there’s two it returns \u003ccode\u003eiModelMatrix\u003c/code\u003e undefined\u003cbr\u003e\nShader:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e#ifdef COMPILEPS\n\nbool cOutlineEnabled = false;\n\nfloat color_difference(float4 sc, float4 nc)\n{\n    return abs(sc.r - nc.r) + abs(sc.g - nc.g) + abs(sc.b - nc.b);\n}\n \nfloat4 get_pixel(Texture2D tex, SamplerState samp, in float2 coords, in float dx, in float dy)\n{\n    float4 result = tex.Sample(samp, coords + float2(dx, dy));\n    return result;\n}\n \n// returns pixel color\nfloat IsEdge(Texture2D tex, SamplerState samp, float2 coords)\n{\n    float dxtex = 1.0 / 1920.0; //image width;\n    float dytex = 1.0 / 1080.0; //image height;\n    float cd[8];\n \n    float4 sc = get_pixel(tex, samp, coords, 0.0 * dxtex, 0.0 * dytex);\n    cd[0] = color_difference(sc, get_pixel(tex, samp, coords, -1.0 * dxtex, -1.0 * dytex) ); //color of itself\n    cd[1] = color_difference(sc, get_pixel(tex, samp, coords, -1.0 * dxtex, 0.0 * dytex) );\n    cd[2] = color_difference(sc, get_pixel(tex, samp, coords, -1.0 * dxtex, 1.0 * dytex) );\n    cd[3] = color_difference(sc, get_pixel(tex, samp, coords, 0.0 * dxtex, 1.0 * dytex) );\n \n    float4 alt1 = get_pixel(tex, samp, coords, 1.0 * dxtex, 1.0 * dytex);\n    float4 alt2 = get_pixel(tex, samp, coords, 1.0 * dxtex, 0.0 * dytex);\n    float4 alt3 = get_pixel(tex, samp, coords, 1.0 * dxtex, -1.0 * dytex);\n    float4 alt4 = get_pixel(tex, samp, coords, 0.0 * dxtex, -1.0 * dytex);\n \n    if (length(alt1.rgb) \u0026lt; 0.1)\n    {\n        cd[4] = color_difference(sc, alt1);\n    }\n    else\n    {\n        cd[4] = 0.0;\n    }\n    if (length(alt2.rgb) \u0026lt; 0.1)\n    {\n        cd[5] = color_difference(sc, alt2);\n    }\n    else\n    {\n        cd[5] = 0.0;\n    }\n    if (length(alt3.rgb) \u0026lt; 0.1)\n    {\n        cd[6] = color_difference(sc, alt3);\n    }\n    else\n    {\n        cd[6] = 0.0;\n    }\n    if (length(alt4.rgb) \u0026lt; 0.1)\n    {\n        cd[7] = color_difference(sc, alt4);\n    }\n    else\n    {\n        cd[7] = 0.0;\n    }\n \n    return cd[0] + cd[1] + cd[2] + cd[3] + cd[4] + cd[5] + cd[6] + cd[7];\n}\n#endif\n \nvoid VS(float4 iPos : POSITION,\n        float3 iNormal : NORMAL,\n        out float4 oPos : OUTPOSITION,\n        out float4 vColor : TEXCOORD0,\n        out float4 vScreenPos : TEXCOORD1)\n{\n    float4x3 modelMatrix = iModelMatrix;\n    float3 worldPos = GetWorldPos(modelMatrix);\n    oPos = GetClipPos(worldPos);\n \n#ifdef EDGE\n      vScreenPos = GetScreenPos(oPos);\n#endif\n\n#ifdef BASE\n        float3 n = iNormal+float3(1.0);\n        n*=0.5;\n        vColor = float4(n, 1.0);\n#endif\n}\n \nvoid PS(in float4 iPos : POSITION,\n        in float4 vColor : TEXCOORD0,\n        in float4 vScreenPos : TEXCOORD1,\n        out float4 oColor : SV_TARGET)\n{\n#ifdef BASE\n        float4 diffColor = vColor;\n        oColor = oColor;\n#endif\n\n#ifdef EDGE\n\n    float4 color = float4(0.0, 0.0, 0.0, 1.0);\n    float2 coords = vScreenPos.xy / vScreenPos.w;\n    if (IsEdge(tEnvMap, sEnvMap, coords) \u0026gt;= 0.5)\n    {\n        if (cOutlineEnabled)\n        {\n            color.rgba = float4(0.0, 1.0, 0.0, 1.0);\n\n        }\n        else\n        {\n            color.rgba = float4(1.0, 1.0, 1.0, 1.0);\n        }\n    }\n    else\n    {\n        color = get_pixel(tEnvMap, sEnvMap, vScreenPos.xy / vScreenPos.w, float(0) * (1.0 / 1920.0), float(0) * (1.0 / 1080.0));\n    }\n    oColor = color;\n#endif\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTechnique:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\u0026lt;technique vs=\"LitSolid\" ps=\"LitSolid\" psdefines=\"DIFFMAP\"\u0026gt;\n\t\u0026lt;pass name=\"base\" /\u0026gt;\n    \u0026lt;pass name=\"litbase\" psdefines=\"AMBIENT\" /\u0026gt;\n    \u0026lt;pass name=\"light\" depthtest=\"equal\" depthwrite=\"false\" blend=\"add\" /\u0026gt;\n    \u0026lt;pass name=\"prepass\" psdefines=\"PREPASS\" /\u0026gt;\n    \u0026lt;pass name=\"material\" psdefines=\"MATERIAL\" depthtest=\"equal\" depthwrite=\"false\" /\u0026gt;\n    \u0026lt;pass name=\"deferred\" psdefines=\"DEFERRED\" /\u0026gt;\n    \u0026lt;pass name=\"depth\" vs=\"Depth\" ps=\"Depth\" /\u0026gt;\n    \u0026lt;pass name=\"shadow\" vs=\"Shadow\" ps=\"Shadow\" /\u0026gt;\n\t\u0026lt;pass name=\"refract\" vs=\"Outline\" ps=\"Outline\" vsdefines=\"EDGE\" psdefines=\"EDGE\" blend=\"alpha\"/\u0026gt;\n\u0026lt;/technique\u0026gt;\n\n\u003c/code\u003e\u003c/pre\u003e","post_number":1,"post_type":1,"updated_at":"2020-04-24T22:53:53.047Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":27,"readers_count":26,"score":10.4,"yours":false,"topic_id":6118,"topic_slug":"shader-return-imodelmatrix-undefined-when-multiple-models-are-rendered","display_username":"Actually Permanent","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1165,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":37505,"name":"Eugene Kozlov","username":"Eugene","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","created_at":"2020-04-25T00:36:33.587Z","cooked":"\u003cp\u003eTo handle instancing in your custom shader you have to conditionally pass the matrix components as input parameters. See standard LitSolid for example.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2020-04-25T12:57:49.395Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":25,"readers_count":24,"score":15.0,"yours":false,"topic_id":6118,"topic_slug":"shader-return-imodelmatrix-undefined-when-multiple-models-are-rendered","display_username":"Eugene Kozlov","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Core developer","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":484,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":true},{"id":37506,"name":"Actually Permanent","username":"throwawayerino","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/da6949/{size}.png","created_at":"2020-04-25T12:59:18.476Z","cooked":"\u003cp\u003eI added\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e#ifdef INSTANCED\nfloat4x3 iModelMatrix  : TEXCOORD4,\n#endif\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eto the middle of my VS() signature. Would’ve been helpful if that was in the docs\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2020-04-25T12:59:18.476Z","reply_count":0,"reply_to_post_number":2,"quote_count":0,"incoming_link_count":0,"reads":18,"readers_count":17,"score":3.6,"yours":false,"topic_id":6118,"topic_slug":"shader-return-imodelmatrix-undefined-when-multiple-models-are-rendered","display_username":"Actually Permanent","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","reply_to_user":{"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1165,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[37504,37505,37506]},"timeline_lookup":[[1,942]],"suggested_topics":[{"id":7080,"title":"Build urho3d source on windows 10 - cmake - \"Error in configuration process, project files may be invalid\"","fancy_title":"Build urho3d source on windows 10 - cmake - \u0026ldquo;Error in configuration process, project files may be invalid\u0026rdquo;","slug":"build-urho3d-source-on-windows-10-cmake-error-in-configuration-process-project-files-may-be-invalid","posts_count":8,"reply_count":4,"highest_post_number":8,"image_url":null,"created_at":"2021-12-03T01:55:53.267Z","last_posted_at":"2021-12-06T22:46:59.584Z","bumped":true,"bumped_at":"2021-12-06T22:46:59.584Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":324,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1488,"username":"ToolmakerSteve","name":"ToolmakerSteve","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ba9def/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]},{"id":7115,"title":"Is it possbile to use one billboard for a lens flare?","fancy_title":"Is it possbile to use one billboard for a lens flare?","slug":"is-it-possbile-to-use-one-billboard-for-a-lens-flare","posts_count":17,"reply_count":4,"highest_post_number":17,"image_url":null,"created_at":"2022-01-02T03:10:48.953Z","last_posted_at":"2022-01-03T21:37:51.953Z","bumped":true,"bumped_at":"2022-01-03T21:37:51.953Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":275,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7125,"title":"Android mobile shows jaggies in the instersection plane-terrain","fancy_title":"Android mobile shows jaggies in the instersection plane-terrain","slug":"android-mobile-shows-jaggies-in-the-instersection-plane-terrain","posts_count":5,"reply_count":3,"highest_post_number":5,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/d/d36aedb4e8cf5409efca6c976aae7e4a5c499eb9.png","created_at":"2022-01-11T11:59:18.993Z","last_posted_at":"2022-01-11T21:27:40.692Z","bumped":true,"bumped_at":"2022-01-12T07:36:41.695Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":129,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":856,"username":"feresmu","name":null,"avatar_template":"https://avatars.discourse-cdn.com/v4/letter/f/f08c70/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]},{"id":7087,"title":"Android how to get error message sometimes little change gives me just crash","fancy_title":"Android how to get error message sometimes little change gives me just crash","slug":"android-how-to-get-error-message-sometimes-little-change-gives-me-just-crash","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-12-05T16:59:59.376Z","last_posted_at":"2021-12-05T18:17:02.335Z","bumped":true,"bumped_at":"2021-12-05T18:17:02.335Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":153,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1436,"username":"Maco","name":"Maco","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/m/90ced4/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}}]},{"id":7212,"title":"Shadow Gap between Feet and Plane","fancy_title":"Shadow Gap between Feet and Plane","slug":"shadow-gap-between-feet-and-plane","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/8/897538cff25de49fafa7aa77574f822e99576b67_2_1024x686.jpeg","created_at":"2022-03-07T00:04:17.351Z","last_posted_at":"2022-03-07T00:17:57.413Z","bumped":true,"bumped_at":"2022-03-07T00:17:57.413Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":137,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}}]}],"tags_descriptions":{},"id":6118,"title":"Shader return iModelMatrix undefined when multiple models are rendered?","fancy_title":"Shader return iModelMatrix undefined when multiple models are rendered?","posts_count":3,"created_at":"2020-04-24T22:53:29.695Z","views":229,"reply_count":2,"like_count":0,"last_posted_at":"2020-04-25T12:59:18.476Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"shader-return-imodelmatrix-undefined-when-multiple-models-are-rendered","category_id":10,"word_count":664,"deleted_at":null,"user_id":1165,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_6118","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":3,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"accepted_answer":{"post_number":2,"username":"Eugene","excerpt":"To handle instancing in your custom shader you have to conditionally pass the matrix components as input parameters. See standard LitSolid for example."},"details":{"can_edit":false,"notification_level":1,"participants":[{"id":1165,"username":"throwawayerino","name":"Actually Permanent","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/da6949/{size}.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":1165,"username":"throwawayerino","name":"Actually Permanent","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/da6949/{size}.png"},"last_poster":{"id":1165,"username":"throwawayerino","name":"Actually Permanent","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/da6949/{size}.png"}}}