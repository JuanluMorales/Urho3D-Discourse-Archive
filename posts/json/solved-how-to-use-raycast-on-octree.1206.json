{"post_stream":{"posts":[{"id":6864,"name":"","username":"cap","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/c/e9bcb4/{size}.png","created_at":"2015-07-21T13:54:56.000Z","cooked":"\u003cp\u003eI’m trying to use Raycast on a Scene’s Octree, and it’s not behaving as I expected so I think I am confused about how to set things up properly.\u003c/p\u003e\n\u003cp\u003eI have triangle meshes to fill the scene and to do this I basically follow sample 34_DynamicGeometry to fill the vertex buffers, calculate normals, etc., of a Model from scratch and then add it as a StaticModel – basically following 34_DynamicGeometry to the letter.\u003c/p\u003e\n\u003cp\u003eAfter the scene objects are loaded, here’s an example of how we try a raycast:\u003c/p\u003e\n\u003cp\u003eRay myRay = Ray(Vector3(0,0,-20), Vector3(0,1,0));\u003cbr\u003e\nPODVector results;\u003cbr\u003e\nRayOctreeQuery query(results, myRay, RAY_TRIANGLE, 1000.0f, DRAWABLE_GEOMETRY);\u003cbr\u003e\nscene_-\u0026gt;GetComponent()-\u0026gt;Raycast(query);\u003cbr\u003e\nstd::cout \u0026lt;\u0026lt; \"manual ray cast number of results= \" \u0026lt;\u0026lt; results.Size() \u0026lt;\u0026lt; std::endl;\u003c/p\u003e\n\u003cp\u003eWhen there is a triangle mesh surface directly above (in the y-direction and well within 1000.0f) this point, we’re not finding any hits from the raycast. (And I’m pretty sure we’re casting from the correct points and that things are where we think they are.) Occasionally we do find hits, for some reason more frequently from queries originating near the origin.\u003c/p\u003e\n\u003cp\u003eWe’ve experimented with putting just one triangle directly above a query point. We’ve tried flipping the orientation of the face(s). There’s something about the behaviour or the set up we are just not understanding.\u003c/p\u003e\n\u003cp\u003eAny tips? Rookie mistakes we should know about? Thanks,\u003c/p\u003e\n\u003cp\u003ecap.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T01:06:03.816Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":423,"reads":41,"readers_count":40,"score":2123.2,"yours":false,"topic_id":1206,"topic_slug":"solved-how-to-use-raycast-on-octree","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":278,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6872,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2015-07-22T11:01:29.000Z","cooked":"\u003cp\u003eAre you sure your model(s)’ bounding boxes are set correctly? Does it work if you use Urho built-in models like Box.mdl?\u003c/p\u003e\n\u003cp\u003eAlso try checking out the Decals example, it uses octree raycasts to determine where to paint decals.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T01:06:04.441Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":41,"readers_count":40,"score":13.2,"yours":false,"topic_id":1206,"topic_slug":"solved-how-to-use-raycast-on-octree","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6874,"name":"","username":"godan","avatar_template":"/user_avatar/discourse.urho3d.io/godan/{size}/49_2.png","created_at":"2015-07-22T12:45:39.000Z","cooked":"\u003cp\u003eIt turns out that you can’t do a raycast query from the Start function of a class inheriting from Application.h. I’m not sure exactly why this is, but if you postpone the raycast until the app does a couple frames, the raycast works. I guess the octree is still initializing during the Application Start function.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-01-02T01:06:04.600Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":39,"readers_count":38,"score":12.8,"yours":false,"topic_id":1206,"topic_slug":"solved-how-to-use-raycast-on-octree","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":134,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6875,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2015-07-22T13:41:57.000Z","cooked":"\u003cp\u003eYes, that is absolutely true, the octree will update itself prior to rendering and will not reflect the object positions correctly for raycasts before. If necessary, you can call Octree::Update() manually. That function needs a frameinfo structure which is normally filled by Renderer but you should be able to just feed it dummy data.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2017-01-02T01:06:04.663Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":38,"readers_count":37,"score":7.6,"yours":false,"topic_id":1206,"topic_slug":"solved-how-to-use-raycast-on-octree","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6877,"name":"","username":"godan","avatar_template":"/user_avatar/discourse.urho3d.io/godan/{size}/49_2.png","created_at":"2015-07-23T16:08:34.000Z","cooked":"\u003cp\u003eAlso, I’ve just noticed that you can’t raycast against on Octree from a worker thread. Is there any possibility to work around this?\u003c/p\u003e\n\u003cp\u003eIt seems that the error is thrown during Drawable::ProcessRayQuery and in particular the Drawable::GetWorldBoundingBox() function.\u003c/p\u003e\n\u003cp\u003eI know that add things to the Scene is not thread safe, but I had assumed reading properties of the scene would be ok.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2017-01-02T01:06:04.781Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":36,"readers_count":35,"score":12.2,"yours":false,"topic_id":1206,"topic_slug":"solved-how-to-use-raycast-on-octree","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":134,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6878,"name":"","username":"cap","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/c/e9bcb4/{size}.png","created_at":"2015-07-23T16:16:17.000Z","cooked":"\u003cp\u003eThanks, yes that was the problem, calling the raycasts in Start().\u003c/p\u003e\n\u003cp\u003e(Incidentally the Box.mdl models did show up with raycasts called from inside Start().)\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2017-01-02T01:06:04.844Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":3,"reads":32,"readers_count":31,"score":21.4,"yours":false,"topic_id":1206,"topic_slug":"solved-how-to-use-raycast-on-octree","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":278,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6887,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2015-07-24T10:58:01.000Z","cooked":"\u003cp\u003eNeed to test the raycast from worker thread. I believe the problem is that it will create work tasks for speeding up the raycast, and doing that from a worker thread -\u0026gt; boom. A check for main thread can be added. But like you said you’ll be responsible for your own synchronization.\u003c/p\u003e","post_number":7,"post_type":1,"updated_at":"2017-01-02T01:06:05.494Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":30,"readers_count":29,"score":6.0,"yours":false,"topic_id":1206,"topic_slug":"solved-how-to-use-raycast-on-octree","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6891,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2015-07-24T12:20:15.000Z","cooked":"\u003cp\u003eOctree::Raycast() should now be possible to call from any thread; it only uses the WorkQueue itself when called from the main thread, outside of WorkQueue::Complete().\u003c/p\u003e","post_number":8,"post_type":1,"updated_at":"2017-01-02T01:06:05.806Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":29,"readers_count":28,"score":5.8,"yours":false,"topic_id":1206,"topic_slug":"solved-how-to-use-raycast-on-octree","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[6864,6872,6874,6875,6877,6878,6887,6891]},"timeline_lookup":[[1,2682],[2,2681],[5,2680],[7,2679]],"suggested_topics":[{"id":7067,"title":"Can the latest Urho3D version be built with VS2013?","fancy_title":"Can the latest Urho3D version be built with VS2013?","slug":"can-the-latest-urho3d-version-be-built-with-vs2013","posts_count":3,"reply_count":0,"highest_post_number":3,"image_url":null,"created_at":"2021-11-25T18:00:24.336Z","last_posted_at":"2021-11-26T17:22:21.878Z","bumped":true,"bumped_at":"2021-11-26T17:22:21.878Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":157,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png"}}]},{"id":7087,"title":"Android how to get error message sometimes little change gives me just crash","fancy_title":"Android how to get error message sometimes little change gives me just crash","slug":"android-how-to-get-error-message-sometimes-little-change-gives-me-just-crash","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-12-05T16:59:59.376Z","last_posted_at":"2021-12-05T18:17:02.335Z","bumped":true,"bumped_at":"2021-12-05T18:17:02.335Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":153,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1436,"username":"Maco","name":"Maco","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/m/90ced4/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}}]},{"id":7086,"title":"Handling CrowdAgents that get stuck","fancy_title":"Handling CrowdAgents that get stuck","slug":"handling-crowdagents-that-get-stuck","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-12-04T01:26:23.062Z","last_posted_at":"2021-12-05T04:37:54.143Z","bumped":true,"bumped_at":"2021-12-05T04:37:54.143Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":137,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]},{"id":7182,"title":"How install landscape in the format (.tor or .obj)?","fancy_title":"How install landscape in the format (.tor or .obj)?","slug":"how-install-landscape-in-the-format-tor-or-obj","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2022-02-03T16:58:20.976Z","last_posted_at":"2022-02-04T16:34:09.663Z","bumped":true,"bumped_at":"2022-02-04T16:34:09.663Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":151,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1497,"username":"timob256","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/b782af/{size}.png"}},{"extras":"latest","description":"Most Recent Poster, Accepted Answer","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7243,"title":"Android compile fails","fancy_title":"Android compile fails","slug":"android-compile-fails","posts_count":5,"reply_count":2,"highest_post_number":5,"image_url":null,"created_at":"2022-04-25T08:46:07.947Z","last_posted_at":"2022-05-06T08:22:51.592Z","bumped":true,"bumped_at":"2022-05-06T08:22:51.592Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":181,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":856,"username":"feresmu","name":null,"avatar_template":"https://avatars.discourse-cdn.com/v4/letter/f/f08c70/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]}],"tags_descriptions":{},"id":1206,"title":"[SOLVED] How to use Raycast on Octree","fancy_title":"[SOLVED] How to use Raycast on Octree","posts_count":8,"created_at":"2015-07-21T13:54:56.000Z","views":977,"reply_count":0,"like_count":0,"last_posted_at":"2015-07-24T12:20:15.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"solved-how-to-use-raycast-on-octree","category_id":10,"word_count":568,"deleted_at":null,"user_id":278,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_1206","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":8,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":3,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":3,"username":"cadaver","name":"Lasse Öörni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","post_count":4,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":2},{"id":134,"username":"godan","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/godan/{size}/49_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":278,"username":"cap","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/c/e9bcb4/{size}.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1}],"created_by":{"id":278,"username":"cap","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/c/e9bcb4/{size}.png"},"last_poster":{"id":3,"username":"cadaver","name":"Lasse Öörni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png"}}}