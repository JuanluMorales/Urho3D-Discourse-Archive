{"post_stream":{"posts":[{"id":8926,"name":"","username":"Enhex","avatar_template":"/user_avatar/discourse.urho3d.io/enhex/{size}/81_2.png","created_at":"2015-12-10T15:47:41.000Z","cooked":"\u003cp\u003eI‚Äôm using shadows causes performance problem because it creates tons of batches.\u003c/p\u003e\n\u003cp\u003e~25,000 batches, shadows enabled, direct lighting, 124ms frame on a users machine:\u003cbr\u003e\n\u003ca href=\"http://i.imgur.com/pfDEx7j.jpg\" rel=\"nofollow noopener\"\u003ei.imgur.com/pfDEx7j.jpg\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cspan class=\"bbcode-b\"\u003e\u003cspan class=\"bbcode-u\"\u003eon my machine:\u003c/span\u003e\u003c/span\u003e\u003cbr\u003e\n~29,000 batches, shadows enabled, direct lighting:\u003cbr\u003e\n\u003ca href=\"http://i.imgur.com/tDY1CD4.jpg\" rel=\"nofollow noopener\"\u003ei.imgur.com/tDY1CD4.jpg\u003c/a\u003e\u003cbr\u003e\n~4,400 batches, shadows \u003cspan class=\"bbcode-b\"\u003edisabled\u003c/span\u003e, direct lighting:\u003cbr\u003e\n\u003ca href=\"http://i.imgur.com/TRu1ot8.jpg\" rel=\"nofollow noopener\"\u003ei.imgur.com/TRu1ot8.jpg\u003c/a\u003e\u003cbr\u003e\n179 batches, shadows \u003cspan class=\"bbcode-b\"\u003edisabled\u003c/span\u003e, \u003cspan class=\"bbcode-b\"\u003edeferred\u003c/span\u003e lighting:\u003cbr\u003e\n\u003ca href=\"http://i.imgur.com/gU4BaYD.jpg\" rel=\"nofollow noopener\"\u003ei.imgur.com/gU4BaYD.jpg\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eI‚Äôm using CustomGeometry to create the level models, could it be related to the lack of batching?\u003cbr\u003e\nIt seems like it creates a batch for every visible triangle.\u003c/p\u003e\n\u003cp\u003eAny idea what might cause it?\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T01:08:31.999Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":7,"reads":5,"readers_count":4,"score":36.0,"yours":false,"topic_id":1562,"topic_slug":"shadows-batches-performance-problem","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"http://i.imgur.com/pfDEx7j.jpg","internal":false,"reflection":false,"title":"pfDEx7j.jpg","clicks":3},{"url":"http://i.imgur.com/gU4BaYD.jpg","internal":false,"reflection":false,"title":"gU4BaYD.jpg","clicks":2},{"url":"http://i.imgur.com/TRu1ot8.jpg","internal":false,"reflection":false,"title":"TRu1ot8.jpg","clicks":1},{"url":"http://i.imgur.com/tDY1CD4.jpg","internal":false,"reflection":false,"title":"tDY1CD4.jpg","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":184,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":8943,"name":"Lasse √ñ√∂rni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2015-12-11T09:00:17.000Z","cooked":"\u003cp\u003eIf you have shadow casting point lights, they will render 6 shadow map faces, so your batch count will explode, particularly if the lights have large radii. Also in forward mode, each object affected by each light (in addition to the first one which is rendered with LitBase) will be a batch.\u003c/p\u003e\n\u003cp\u003eYou can try playing with light and shadow masks in case your lights are ‚Äúbleeding‚Äù to unnecessary objects. But in general, large number of dynamic lights will be a performance loss and you might have to look into some kind of precalculated lighting instead.\u003c/p\u003e\n\u003cp\u003eIf you had models instead of customgeometries, for example 10 nodes each having the same model, same material and LOD, they could be instanced to 1 batch when in the same view (this applies to all of: main camera view, shadow map face, or an additive lighting pass)\u003c/p\u003e\n\u003cp\u003eAlso, try to have as few customgeometries as possible, and within each, as little subgeometries as possible. Do not start a new subgeometry per triangle if it has a different material than the previous, but rather group together the triangles with the same material into the same subgeometry (in case you‚Äôre not already doing this‚Ä¶)\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T01:08:33.221Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":5,"readers_count":4,"score":1.0,"yours":false,"topic_id":1562,"topic_slug":"shadows-batches-performance-problem","display_username":"Lasse √ñ√∂rni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[8926,8943]},"timeline_lookup":[[1,2540],[2,2539]],"suggested_topics":[{"id":7129,"title":"Best Model Import Pipeline as of Jan 2022?","fancy_title":"Best Model Import Pipeline as of Jan 2022?","slug":"best-model-import-pipeline-as-of-jan-2022","posts_count":7,"reply_count":0,"highest_post_number":7,"image_url":null,"created_at":"2022-01-17T09:27:23.432Z","last_posted_at":"2022-01-17T20:37:59.458Z","bumped":true,"bumped_at":"2022-01-17T20:37:59.458Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":170,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1165,"username":"throwawayerino","name":"Actually Permanent","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/da6949/{size}.png"}}]},{"id":7086,"title":"Handling CrowdAgents that get stuck","fancy_title":"Handling CrowdAgents that get stuck","slug":"handling-crowdagents-that-get-stuck","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-12-04T01:26:23.062Z","last_posted_at":"2021-12-05T04:37:54.143Z","bumped":true,"bumped_at":"2021-12-05T04:37:54.143Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":137,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]},{"id":7081,"title":"Install Urho3D Library - Windows 10 - rake build - \"project does not exist\"","fancy_title":"Install Urho3D Library - Windows 10 - rake build - \u0026ldquo;project does not exist\u0026rdquo;","slug":"install-urho3d-library-windows-10-rake-build-project-does-not-exist","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-03T03:06:40.974Z","last_posted_at":"2021-12-03T17:53:10.844Z","bumped":true,"bumped_at":"2021-12-03T17:53:10.844Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":190,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1488,"username":"ToolmakerSteve","name":"ToolmakerSteve","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ba9def/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1491,"username":"xlat","name":"Alex Kuch","avatar_template":"/user_avatar/discourse.urho3d.io/xlat/{size}/3620_2.png"}}]},{"id":7074,"title":"First Person and 3rd person camera and water reflections","fancy_title":"First Person and 3rd person camera and water reflections","slug":"first-person-and-3rd-person-camera-and-water-reflections","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-01T18:37:28.669Z","last_posted_at":"2021-12-01T21:19:51.519Z","bumped":true,"bumped_at":"2021-12-01T21:19:51.519Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":158,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]},{"id":7156,"title":"Manual Mesh Part Animation (e.g. Rotate a propeller)","fancy_title":"Manual Mesh Part Animation (e.g. Rotate a propeller)","slug":"manual-mesh-part-animation-e-g-rotate-a-propeller","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2022-01-26T23:50:29.343Z","last_posted_at":"2022-01-27T05:31:02.766Z","bumped":true,"bumped_at":"2022-01-27T05:31:02.766Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":155,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}}]}],"tags_descriptions":{},"id":1562,"title":"Shadows batches performance problem","fancy_title":"Shadows batches performance problem","posts_count":2,"created_at":"2015-12-10T15:47:41.000Z","views":235,"reply_count":0,"like_count":0,"last_posted_at":"2015-12-11T09:00:17.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"shadows-batches-performance-problem","category_id":10,"word_count":338,"deleted_at":null,"user_id":184,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_1562","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":2,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":3,"username":"cadaver","name":"Lasse √ñ√∂rni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":2},{"id":184,"username":"Enhex","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/enhex/{size}/81_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":184,"username":"Enhex","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/enhex/{size}/81_2.png"},"last_poster":{"id":3,"username":"cadaver","name":"Lasse √ñ√∂rni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png"}}}