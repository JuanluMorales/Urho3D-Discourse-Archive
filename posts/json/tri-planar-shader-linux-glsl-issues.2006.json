{"post_stream":{"posts":[{"id":11996,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2016-05-10T16:34:04.000Z","cooked":"\u003cp\u003eI’ve asked more questions about this darned shader on the internet in the past couple weeks than I have about just about anything in the last several years. Anyway…\u003c/p\u003e\n\u003cp\u003eAs I have posted about before, I am using a custom tri-planar shader in my RPG game, to apply terrain textures from a texture array to terrain geometry. Shortly before my Windows installation died, I had converted the tri-planar shader to a “quad”-planar shader; ie, a variant that projects the terrain textures against the top/bottom and against all 6 sides (1 projection per 2 sides) of a hexagonal cell. The shader was working quite well on D3D11 before the crash. I talk about it at \u003ca href=\"http://www.gamedev.net/blog/33/entry-2261959-quad-planar-projection/\" rel=\"nofollow noopener\"\u003egamedev.net/blog/33/entry-22 … rojection/\u003c/a\u003e and include some screenshots. I had not yet gotten around to modifying it for OpenGL before the crash (the original tri-planar version was working well, though). Also, there have been some changes involving lights (the addition of normal bias to shadowing) committed since I last was able to test the shader on D3D11.\u003c/p\u003e\n\u003cp\u003eHere I am post-crash, and the world has changed completely. I am now developing on Linux and OpenGL. Managed to get everything building correctly, but now I have an issue with lights with my shader. The shader projects both a diffuse map and a normal map against the geometry, and the normal map is used as a tangent-space normal map on the object. However, whenever normal-mapping is enabled in the shader, I get incorrect lighting from both point and directional lights.\u003c/p\u003e\n\u003cp\u003eHere is a shot with diffuse set to gray, and with normal-mapping disabled:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/PtrtOUS.png\" rel=\"nofollow noopener\"\u003ei.imgur.com/PtrtOUS.png\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eAs you can see, the lighting is correct.\u003c/p\u003e\n\u003cp\u003eHere is a shot with gray diffuse, but with normal-mapping enabled:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/FklUWnW.png\" rel=\"nofollow noopener\"\u003ei.imgur.com/FklUWnW.png\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIt looks as if the normals on the cap geometry are inverted for 1/2 of the light radius.\u003c/p\u003e\n\u003cp\u003eHere is a more distant above shot:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/ehhzQlI.png\" rel=\"nofollow noopener\"\u003ei.imgur.com/ehhzQlI.png\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThe strange thing is that the vertical portion of the hex cell receives lighting correctly. Also, if I enable translucent on the shader, then I get a result that is nearer to what I expect, albeit with a dimly-shaded bar through the center of the light:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/Jub5fDe.png\" rel=\"nofollow noopener\"\u003ei.imgur.com/Jub5fDe.png\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eNote that in the original case, the directional light does not illuminate the hex cap geometry, but in the translucent version it does. When diffuse is not set to gray, the diffuse component maps correctly to the geometry, and with normal-mapping disable, the result looks pretty good.\u003c/p\u003e\n\u003cp\u003eI’ve gone through the shader multiple times trying to figure this out. I’ve re-exported the geometry multiple times, played with the normals, etc… Just can’t seem to figure out what’s going wrong.\u003c/p\u003e\n\u003cp\u003eI’ve put together a small example demonstrating the behavior, which can be found at \u003ca href=\"https://drive.google.com/file/d/0B_HwlEqgWzFbMTVoYlEtT0pzX2s/view?usp=sharing\" rel=\"nofollow noopener\"\u003edrive.google.com/file/d/0B_HwlE … sp=sharing\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eI have seen that it is not necessarily a problem with my quad-conversion; the original tri-planar shader for GLSL also exhibits the behavior; that version was working correctly under Windows/OpenGL.\u003c/p\u003e\n\u003cp\u003eIf anyone can see something I’m missing, I’d appreciate it. And sorry for spamming the forum with questions about this thing.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T01:12:14.643Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":61,"reads":15,"readers_count":14,"score":308.0,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"http://i.imgur.com/PtrtOUS.png","internal":false,"reflection":false,"title":"PtrtOUS.png","clicks":10},{"url":"http://i.imgur.com/FklUWnW.png","internal":false,"reflection":false,"title":"FklUWnW.png","clicks":6},{"url":"http://i.imgur.com/Jub5fDe.png","internal":false,"reflection":false,"title":"Jub5fDe.png","clicks":2},{"url":"http://i.imgur.com/ehhzQlI.png","internal":false,"reflection":false,"title":"ehhzQlI.png","clicks":2},{"url":"http://www.gamedev.net/blog/33/entry-2261959-quad-planar-projection/","internal":false,"reflection":false,"title":"\"Quad\"-planar projection - GameDev.net","clicks":1},{"url":"https://drive.google.com/file/d/0B_HwlEqgWzFbMTVoYlEtT0pzX2s/view?usp=sharing","internal":false,"reflection":false,"title":"MinExample.zip - Google Drive","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":12000,"name":"","username":"Bananaft","avatar_template":"/user_avatar/discourse.urho3d.io/bananaft/{size}/222_2.png","created_at":"2016-05-10T19:43:45.000Z","cooked":"\u003cp\u003eI’m afraid you need separate tbn matrix for each plane or even each side, and you have only one.\u003c/p\u003e\n\u003cp\u003eAlso, I feel that you have very overcomplicated solution for not that complex task. There are 33 texture samplers in your shader for diffuse and normal maps only. While all your hexes are the same model. Why don’t you just have one UV coordinates for it, this way you only need only one tbn matrix and 8 texture samplers.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T01:12:14.972Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":13,"readers_count":12,"score":2.6,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":165,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":12001,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2016-05-10T23:19:02.000Z","cooked":"\u003cp\u003eNot sure what you’re talking about, to be honest. I don’t have ‘only one’ tbn matrix. The hex geometry is unwrapped and UV mapped ‘traditionally’, with tangents generated at model export. The tbn matrix is generated from the interpolated tangents per-face.\u003c/p\u003e\n\u003cp\u003eI’ve thought about trying to simplify the number of texture samplers, but to do what I’m doing I don’t see how, without restricting the number of terrain types per hex cell (something I may end up doing, in honesty).\u003c/p\u003e\n\u003cp\u003eThe shader operates similarly to a terrain shader. There is a blend map overlaid upon the whole set of geometry, and a given fragment’s position is used to lookup the blend values per-layer in this texture. Then these blend values are used to combine the results of a tri-planar projection for each of the terrain types. Both diffuse and normal components are combined, then the combined normal is used as a tangent-space normal, using the tbn matrix interpolated from the face vertices. \u003ca href=\"http://i.imgur.com/T0ZxjP1.jpg\" rel=\"nofollow noopener\"\u003ei.imgur.com/T0ZxjP1.jpg\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eWhile I am open to ideas to accomplish what I’m doing in a simpler fashion, that’s kind of beside the point. It \u003cspan class=\"bbcode-i\"\u003eused to work\u003c/span\u003e on D3D11 and OpenGL and now it doesn’t work on OpenGL (no way to tell if it works on D3D11 now).\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-01-02T01:12:15.040Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":14,"readers_count":13,"score":7.8,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"http://i.imgur.com/T0ZxjP1.jpg","internal":false,"reflection":false,"title":"T0ZxjP1.jpg","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":12002,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2016-05-11T07:27:24.000Z","cooked":"\u003cp\u003eHave you observed the changes in OpenGL input attributes since the arbitrary vertex declarations were put into use? (basically, follow the changes in built-in shaders)\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2017-01-02T01:12:15.106Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":10,"readers_count":9,"score":7.0,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":12012,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2016-05-11T19:11:43.000Z","cooked":"\u003cp\u003eI did try to make everything match the shipped shaders. I do have one additional varying component, for the detail texture coordinate, but change where it is declared makes no difference.\u003c/p\u003e\n\u003cp\u003eI did some modification testing of the shader to output normals and tangents, and something is weird. I modified the shader to output the abs() of the base model normal for color:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/CyK9vIQ.png\" rel=\"nofollow noopener\"\u003ei.imgur.com/CyK9vIQ.png\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eLooks as expected. Outputting the normal after tbn multiplication, using a texture normal of (0,0,1), results in this:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/HyYr7cP.png\" rel=\"nofollow noopener\"\u003ei.imgur.com/HyYr7cP.png\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eSo the tbn matrix is clearly incorrect. However, I have tried applying the material to models known to work correctly using the DiffNormal technique, and the normals output from this shader are also incorrect. The tbn matrix generation code is directly copy/pasted from the LitSolid shader, though, so I’m not sure exactly where the glitch is occurring.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2017-01-02T01:12:15.787Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":10,"readers_count":9,"score":2.0,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"http://i.imgur.com/CyK9vIQ.png","internal":false,"reflection":false,"title":"CyK9vIQ.png","clicks":2},{"url":"http://i.imgur.com/HyYr7cP.png","internal":false,"reflection":false,"title":"HyYr7cP.png","clicks":2}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":12014,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2016-05-12T08:40:45.000Z","cooked":"\u003cp\u003eCan you test each of the vertex input attributes (for example output them directly in fragment shader) and see whether they’re giving out the data you’re expecting?\u003c/p\u003e\n\u003cp\u003eIf not, then there’s an engine bug, either in the Graphics class when setting the vertex attribute pointers, or in the ShaderVariation class related to input attribute introspection. In that case I’d require a test model and shader that can be used to exhibit the bug. Also make sure you’re using the latest shader include files (eg. Transform.glsl and Uniforms.glsl) because if those are mismatched, then bugs are likely.\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2017-01-02T01:12:15.965Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":2,"reads":11,"readers_count":10,"score":12.2,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":12017,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2016-05-12T20:31:07.000Z","cooked":"\u003cp\u003eUsing the Box.mdl from Urho3D/Data/Models. The setup was to instance a 2D grid of boxes, and give each instance a rotation of 0, 90, 180 or 270 degrees around the vertical (0,1,0) axis. The result should be uniform lighting; ie, it shouldn’t be obvious that a rotation is being performed. Actual results:\u003c/p\u003e\n\u003cp\u003eResult of quad-planar shader + normal-mapping:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/p9lyTkz.jpg\" rel=\"nofollow noopener\"\u003ei.imgur.com/p9lyTkz.jpg\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eResult of diffColor=abs(normal*0.5+0.5), where normal is the texture normal map fragment transformed by tbn:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/Qjctu7E.jpg\" rel=\"nofollow noopener\"\u003ei.imgur.com/Qjctu7E.jpg\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eResult of diffColor=abs(vNormal), with normal-mapping disabled:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/Ihp4zOX.png\" rel=\"nofollow noopener\"\u003ei.imgur.com/Ihp4zOX.png\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eResult of diffColor=abs(vTangent) with normal-mapping disabled:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/rN6yGol.png\" rel=\"nofollow noopener\"\u003ei.imgur.com/rN6yGol.png\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIn the case of the normal map output, you can see that the normals on the vertically-aligned faces are consistent, but the normal output for the top varies with rotation. Similarly, the output showing the tangent shows consistent tangent values for the vertically-aligned faces regardless of rotation; but the top face’s tangent varies with the rotation of the box. Since the rotation is around the vertical axis, we shouldn’t be seeing a different tangent for the top of the box, since it’s always the same face being shown, just with a different rotation around the vertical axis.\u003c/p\u003e\n\u003cp\u003eText of the shader with modifications to set color from the tangent:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://pastebin.com/7i8NEfxS\" rel=\"nofollow noopener\"\u003epastebin.com/7i8NEfxS\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eI use the default Urho3D shader includes for Uniforms, etc… My CoreData symlink points to the most recent pull of Urho3D.\u003c/p\u003e\n\u003cp\u003eThe various terrain textures and material can be obtained from the minimal example setup at the google drive link in the original post.\u003c/p\u003e","post_number":7,"post_type":1,"updated_at":"2017-01-02T01:12:16.171Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":11,"readers_count":10,"score":2.2,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"http://i.imgur.com/p9lyTkz.jpg","internal":false,"reflection":false,"title":"p9lyTkz.jpg","clicks":4},{"url":"http://pastebin.com/7i8NEfxS","internal":false,"reflection":false,"title":"#include \"Uniforms.glsl\" #include \"Samplers.glsl\" #include \"Transform.glsl\" - Pastebin.com","clicks":1},{"url":"http://i.imgur.com/Qjctu7E.jpg","internal":false,"reflection":false,"title":"Qjctu7E.jpg","clicks":1},{"url":"http://i.imgur.com/Ihp4zOX.png","internal":false,"reflection":false,"title":"Ihp4zOX.png","clicks":0},{"url":"http://i.imgur.com/rN6yGol.png","internal":false,"reflection":false,"title":"rN6yGol.png","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":12019,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2016-05-13T08:37:21.000Z","cooked":"\u003cp\u003eSince there’s no additional vertex attributes being defined, we can rule out engine C++ bug, so it should be all shader math, and therefore solvable. I’ll return to this in a short while.\u003c/p\u003e","post_number":8,"post_type":1,"updated_at":"2017-01-02T01:12:16.317Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":9,"readers_count":8,"score":1.8,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":12033,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2016-05-14T02:06:20.000Z","cooked":"\u003cp\u003eI did a test by starting with the LitSolid.glsl shader. I modified it slightly, removing the diffColor texture sampling and normal map sampling. The tbn matrix is used to transform the hard-coded vector (0,0,1) (representing a ‘neutral’ texture map normal) which is then set as the RGB component of diffColor. normal is set to the model’s normal. Here is the shader code: \u003ca href=\"http://pastebin.com/FbtFUTwB\" rel=\"nofollow noopener\"\u003epastebin.com/FbtFUTwB\u003c/a\u003e And the output is still similar to what I get in my shader:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/bJYqto3.png\" rel=\"nofollow noopener\"\u003ei.imgur.com/bJYqto3.png\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eI would expect the tops of the hex cells to be shaded green, since Y is up in this setup. The red color indicates that the normal for the top of the cells is actually pointing along the X axis, which would explain the fact that the point light only illuminates half it’s area; the other half is pointing away from the light on the X axis.\u003c/p\u003e\n\u003cp\u003eIf I set diffColor to gray, and use the transformed (0,0,1) normal for lighting, the result is similar to what I get in my shader:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://i.imgur.com/ctn82Hb.png\" rel=\"nofollow noopener\"\u003ei.imgur.com/ctn82Hb.png\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThe shader is simply a slightly modified base LitSolid, with none of my tri-planar code included. It also displays the issue when using the Box.mdl model.\u003c/p\u003e","post_number":9,"post_type":1,"updated_at":"2017-01-02T01:12:17.353Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":9,"readers_count":8,"score":1.8,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"http://pastebin.com/FbtFUTwB","internal":false,"reflection":false,"title":"#include \"Uniforms.glsl\" #include \"Samplers.glsl\" #include \"Transform.glsl\" # - Pastebin.com","clicks":0},{"url":"http://i.imgur.com/bJYqto3.png","internal":false,"reflection":false,"title":"bJYqto3.png","clicks":0},{"url":"http://i.imgur.com/ctn82Hb.png","internal":false,"reflection":false,"title":"ctn82Hb.png","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":12036,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2016-05-14T10:15:53.000Z","cooked":"\u003cp\u003eI can’t replicate problems with the normal and rotation of the model, using either your shader in your latest post or LitSolid. I’m testing in OpenGL mode on Windows + Nvidia GPU though.\u003c/p\u003e\n\u003cp\u003eDo the Urho examples run correctly for you? For example the physics examples contain normalmapped boxes that rotate into different orientations, and they should in theory exhibit the same problems since the tbn math is the same.\u003c/p\u003e\n\u003cp\u003eIf they do, then the problem would be somewhere in the material - technique - shader chain, for example possibly mismatching shader defines? Both VS and PS need to define NORMALMAP or the varyings would be defined differently.\u003c/p\u003e\n\u003cp\u003eEDIT: using the shader you posted earlier I see something odd happening with the rotation. Will investigate.\u003c/p\u003e","post_number":10,"post_type":1,"updated_at":"2017-01-02T01:12:17.606Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":10,"readers_count":9,"score":2.0,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":12038,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2016-05-14T11:19:12.000Z","cooked":"\u003cp\u003eLitSolid and the shader in your latest post does tbn * normal, which is correct.\u003c/p\u003e\n\u003cp\u003eThe shader in your earlier post does normal * tbn, which is incorrect in GLSL.\u003c/p\u003e\n\u003cp\u003eTook a while to notice \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e","post_number":11,"post_type":1,"updated_at":"2017-01-02T01:12:17.741Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":8,"readers_count":7,"score":1.6,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":12042,"name":"","username":"JTippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","created_at":"2016-05-14T18:09:04.000Z","cooked":"\u003cp\u003eHa, that was totally it. When ‘revitalizing’ the shader after the Linux install, i copy-pasted the HLSL then just did search/replace to fix the flloat3’s to vec3’s, and replaced the mul() operation.  And in my tests, I just kept propagating the vector*tbn mistake.\u003c/p\u003e\n\u003cp\u003eWorking great, now. Thanks again, cadaver.\u003c/p\u003e","post_number":12,"post_type":1,"updated_at":"2017-01-02T01:12:18.068Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":8,"readers_count":7,"score":1.6,"yours":false,"topic_id":2006,"topic_slug":"tri-planar-shader-linux-glsl-issues","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":30,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[11996,12000,12001,12002,12012,12014,12017,12019,12033,12036,12038,12042]},"timeline_lookup":[[1,2388],[2,2387],[5,2386],[7,2385],[9,2384],[12,2383]],"suggested_topics":[{"id":7080,"title":"Build urho3d source on windows 10 - cmake - \"Error in configuration process, project files may be invalid\"","fancy_title":"Build urho3d source on windows 10 - cmake - \u0026ldquo;Error in configuration process, project files may be invalid\u0026rdquo;","slug":"build-urho3d-source-on-windows-10-cmake-error-in-configuration-process-project-files-may-be-invalid","posts_count":8,"reply_count":4,"highest_post_number":8,"image_url":null,"created_at":"2021-12-03T01:55:53.267Z","last_posted_at":"2021-12-06T22:46:59.584Z","bumped":true,"bumped_at":"2021-12-06T22:46:59.584Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":324,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1488,"username":"ToolmakerSteve","name":"ToolmakerSteve","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ba9def/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]},{"id":7212,"title":"Shadow Gap between Feet and Plane","fancy_title":"Shadow Gap between Feet and Plane","slug":"shadow-gap-between-feet-and-plane","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/8/897538cff25de49fafa7aa77574f822e99576b67_2_1024x686.jpeg","created_at":"2022-03-07T00:04:17.351Z","last_posted_at":"2022-03-07T00:17:57.413Z","bumped":true,"bumped_at":"2022-03-07T00:17:57.413Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":137,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}}]},{"id":7179,"title":"Need help with cusomized PBR renderpath","fancy_title":"Need help with cusomized PBR renderpath","slug":"need-help-with-cusomized-pbr-renderpath","posts_count":4,"reply_count":0,"highest_post_number":4,"image_url":null,"created_at":"2022-02-01T09:04:58.692Z","last_posted_at":"2022-02-03T17:35:34.174Z","bumped":true,"bumped_at":"2022-02-03T17:35:34.174Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":13,"views":205,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster, Accepted Answer","user":{"id":247,"username":"Dave82","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]},{"id":7181,"title":"StaticModelGroup - Are ShaderParameters Shared?","fancy_title":"StaticModelGroup - Are ShaderParameters Shared?","slug":"staticmodelgroup-are-shaderparameters-shared","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-02-02T09:31:19.658Z","last_posted_at":"2022-02-02T17:06:24.059Z","bumped":true,"bumped_at":"2022-02-02T17:06:24.059Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":120,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]},{"id":7215,"title":"How to build rbfx?","fancy_title":"How to build rbfx?","slug":"how-to-build-rbfx","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2022-03-11T01:28:40.314Z","last_posted_at":"2022-03-12T19:16:39.360Z","bumped":true,"bumped_at":"2022-03-12T19:16:39.360Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":268,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1510,"username":"SoNewBee","name":"So New Bee","avatar_template":"/user_avatar/discourse.urho3d.io/sonewbee/{size}/3755_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1447,"username":"Batch","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/b/f17d59/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]}],"tags_descriptions":{},"id":2006,"title":"Tri-planar shader, Linux GLSL issues","fancy_title":"Tri-planar shader, Linux GLSL issues","posts_count":12,"created_at":"2016-05-10T16:34:04.000Z","views":551,"reply_count":0,"like_count":0,"last_posted_at":"2016-05-14T18:09:04.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"tri-planar-shader-linux-glsl-issues","category_id":10,"word_count":1998,"deleted_at":null,"user_id":30,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_2006","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":12,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":3,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":30,"username":"JTippetts","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png","post_count":6,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":3,"username":"cadaver","name":"Lasse Öörni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","post_count":5,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":2},{"id":165,"username":"Bananaft","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/bananaft/{size}/222_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":30,"username":"JTippetts","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png"},"last_poster":{"id":30,"username":"JTippetts","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts/{size}/357_2.png"},"links":[{"url":"http://pastebin.com/7i8NEfxS","title":"#include \"Uniforms.glsl\" #include \"Samplers.glsl\" #include \"Transform.glsl\" - Pastebin.com","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":30,"domain":"pastebin.com","root_domain":"pastebin.com"},{"url":"http://www.gamedev.net/blog/33/entry-2261959-quad-planar-projection/","title":"\"Quad\"-planar projection - GameDev.net","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":30,"domain":"www.gamedev.net","root_domain":"gamedev.net"}]}}