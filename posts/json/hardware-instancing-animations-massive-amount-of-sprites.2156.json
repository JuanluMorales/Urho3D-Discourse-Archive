{"post_stream":{"posts":[{"id":13059,"name":"","username":"TheSHEEEP","avatar_template":"/user_avatar/discourse.urho3d.io/thesheeep/{size}/74_2.png","created_at":"2016-08-04T18:46:32.000Z","cooked":"\u003cp\u003eHey there,\u003c/p\u003e\n\u003cp\u003eI’d like to know what approach you’d suggest when using Urho3D for the following case:\u003c/p\u003e\n\u003cp\u003eI want to display a large (truly large, think hundreds, possibly up to 1000) amount of animated 3D units at the same time.\u003cbr\u003e\nNow, I know of two methods to achieve that, at least in principle.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eUsing sprites. I know I wrote 3D before, but sprites would work just as well when available in multiple directions. Heroes Of Annihilated Empires used that approach and had a really unique style that I liked very much:\u003cbr\u003e\n[video]\u003ca href=\"https://youtu.be/NAoMWOT2eXo?list=PLhG6bWwiy1v5I9fQ-gxohI8ffVCVI96D3\u0026amp;t=65%5B/video%5D\" rel=\"nofollow noopener\"\u003ehttps://youtu.be/NAoMWOT2eXo?list=PLhG6bWwiy1v5I9fQ-gxohI8ffVCVI96D3\u0026amp;t=65[/video]\u003c/a\u003e\u003cbr\u003e\nFor that to work, sprites obviously have to be put into the 3D scene with correct clipping and at least alpha testing.\u003cbr\u003e\nI figure something like that could work using BillboardSets, no? Or maybe sprites directly?\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eHardware instancing. I know that Urho3D automatically does hardware instancing, but does that apply to animations as well? I know hardware instancing with animations is possible (I think Ogre has a demo on that?), but afaik it is a different beast than non-animated hardware instancing.\u003cbr\u003e\nSo, is this actually supported in Urho3D?\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T01:13:31.906Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":131,"reads":30,"readers_count":29,"score":663.0,"yours":false,"topic_id":2156,"topic_slug":"hardware-instancing-animations-massive-amount-of-sprites","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://youtu.be/NAoMWOT2eXo?list=PLhG6bWwiy1v5I9fQ-gxohI8ffVCVI96D3\u0026t=65%5B/video%5D","internal":false,"reflection":false,"title":"YouTube","clicks":5}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":513,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":13060,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2016-08-04T19:16:37.000Z","cooked":"\u003cp\u003eSkinned instancing is not supported, so you’d need to modify the engine for that, or create your custom skinned model component. One idea would be to write the skin matrices to a texture and read from it in the vertex shader, however I haven’t tried that in practice.\u003c/p\u003e\n\u003cp\u003eThough in my tests 1000 animated models using unmodified Urho isn’t a huge stretch, so the instancing is not necessarily a must for that. Using the SkeletalAnimation sample bumped to 1000 models I got a little over 100 FPS with a fairly beefy CPU \u0026amp; GPU. 1000 drawcalls in general isn’t much. The Jack models in SkeletalAnimation are actually 2 drawcalls each, head and body, so if you can use just one geometry/material per model you’d be in even better position. The CPU time to update the animation for all models may even end up dominating the load. Urho does already have a distance-based animation LOD built in, which makes the animation not update every frame for far-away models. You can adjust the severity of the optimization, or also turn it off it you really want all animations to update every frame.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T01:13:31.967Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":2,"reads":30,"readers_count":29,"score":16.0,"yours":false,"topic_id":2156,"topic_slug":"hardware-instancing-animations-massive-amount-of-sprites","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":13066,"name":"","username":"TheSHEEEP","avatar_template":"/user_avatar/discourse.urho3d.io/thesheeep/{size}/74_2.png","created_at":"2016-08-05T06:17:14.000Z","cooked":"\u003cp\u003eInteresting thought.\u003cbr\u003e\nI’ll try modifying the sample, too, to see those effects.\u003cbr\u003e\nOf course, in a real game, there will be more going on than just animated meshes \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/wink.png?v=5\" title=\":wink:\" class=\"emoji\" alt=\":wink:\"\u003e\u003c/p\u003e\n\u003cp\u003eThen again, we already kind of established I will do the gameplay on another thread, so it might just be enough.\u003cbr\u003e\nI need to try it.\u003c/p\u003e\n\u003cp\u003eWhat about the massed animated sprites in the 3D world, though?\u003cbr\u003e\nWouldn’t that be even better, performance wise, even if I have to calculate the exact animation playing for each component?\u003cbr\u003e\nEven if 1000 models would work on top GPU \u0026amp; CPU, I cannot take that for granted and would like to support mid-range PCs as well.\u003cbr\u003e\nLet’s assume 1000 units, consisting of 20 different units, each with 8 directions of animation.\u003cbr\u003e\nIf we assume a perfect distribution of all different units \u0026amp; directions, then we would have between 160 (if all equal ones were at the same animation page) and 1000 (if all were on different animation pages) draw calls, with a MUCH lesser triangle count.\u003cbr\u003e\nOf course, I am hoping that animated sprites use the same draw call if on the same animation page, which might be wrong - not exactly an optimization I’d take as guaranteed \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/wink.png?v=5\" title=\":wink:\" class=\"emoji\" alt=\":wink:\"\u003e\u003c/p\u003e\n\u003cp\u003eAgain, I’d need to test that, too, of course, but if you say “No! That’s a stupid idea!” I would save myself the time \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-01-02T01:13:32.420Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":28,"readers_count":27,"score":5.6,"yours":false,"topic_id":2156,"topic_slug":"hardware-instancing-animations-massive-amount-of-sprites","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":513,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":13067,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2016-08-05T06:45:39.000Z","cooked":"\u003cp\u003eSprites will be much cheaper than actual skinned models, yes.\u003c/p\u003e\n\u003cp\u003eThe Urho2D sprite batcher is pretty well optimized and should do drawcall combining for sprites sharing the same material / texture. Alternately, if you find Urho2D classes hard to use in a 3D world you can emulate the same with BillboardSet; in that case I recommend to have one billboardset per material for most efficiency.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2017-01-02T01:13:32.500Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":24,"readers_count":23,"score":4.8,"yours":false,"topic_id":2156,"topic_slug":"hardware-instancing-animations-massive-amount-of-sprites","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":13072,"name":"","username":"TheSHEEEP","avatar_template":"/user_avatar/discourse.urho3d.io/thesheeep/{size}/74_2.png","created_at":"2016-08-05T12:50:45.000Z","cooked":"\u003cp\u003eDid a few tests by changing the demo code:\u003cbr\u003e\nWhen I use the 24_Urho2DSprite and pump the amount of coins up to 1000, I don’t even see a difference. The FPS max out at 200 FPS (the limit, I guess?).\u003cbr\u003e\nWhen I use the 33_Urho2DSpriterAnimation and create 1000 randomly placed little devils (using a random animation), the FPS becomes ~80 (my current machine is just a very mediocre laptop, at best). But I guess that is understandable, given that the devil is much bigger \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e\n\u003cp\u003eI also upped the Billboard sample up to 20 nodes * 50 billboards and the FPS became 130+.\u003cbr\u003e\nOf course, the Billboard is not animated, and from a small look, I’m not sure if a BillboardSet can actually have animated sprites (other than color animation/rotation, etc.).\u003cbr\u003e\nSo I am guessing that BillboardSet per does not really do what I would need (animated sprites), at least out of the box.\u003c/p\u003e\n\u003cp\u003eIs there any downside to using Urho2DSprite (AnimatedSprite2D) in a 3D world?\u003cbr\u003e\nI guess I only have to make sure that the Sprites always face the camera, but that sounds doable.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2017-01-02T01:13:32.836Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":24,"readers_count":23,"score":4.8,"yours":false,"topic_id":2156,"topic_slug":"hardware-instancing-animations-massive-amount-of-sprites","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":513,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":13078,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2016-08-05T15:11:59.000Z","cooked":"\u003cp\u003eYou can rotate the sprites’ scene nodes, you’ll just have to do that manually after the camera position/rotation is known for the frame.\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2017-01-02T01:13:33.286Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":23,"readers_count":22,"score":4.6,"yours":false,"topic_id":2156,"topic_slug":"hardware-instancing-animations-massive-amount-of-sprites","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":13079,"name":"","username":"TheSHEEEP","avatar_template":"/user_avatar/discourse.urho3d.io/thesheeep/{size}/74_2.png","created_at":"2016-08-05T17:29:42.000Z","cooked":"\u003cp\u003eExcellent, thanks for your help \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e","post_number":7,"post_type":1,"updated_at":"2017-01-02T01:13:33.348Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":23,"readers_count":22,"score":4.6,"yours":false,"topic_id":2156,"topic_slug":"hardware-instancing-animations-massive-amount-of-sprites","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":513,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[13059,13060,13066,13067,13072,13078,13079]},"timeline_lookup":[[1,2301],[7,2300]],"suggested_topics":[{"id":7304,"title":"Urho3D is crashing on Android 12","fancy_title":"Urho3D is crashing on Android 12","slug":"urho3d-is-crashing-on-android-12","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-07-28T10:03:51.280Z","last_posted_at":"2022-07-28T10:03:51.349Z","bumped":true,"bumped_at":"2022-07-28T10:38:06.014Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":126,"category_id":9,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":809,"username":"elix22","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/elix22/{size}/1437_2.png"}}]},{"id":7344,"title":"Do we give up supporting dx11？","fancy_title":"Do we give up supporting dx11？","slug":"do-we-give-up-supporting-dx11","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-11-03T09:37:37.893Z","last_posted_at":"2022-11-03T13:09:15.153Z","bumped":true,"bumped_at":"2022-11-03T15:28:58.128Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":78,"category_id":9,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1510,"username":"SoNewBee","name":"So New Bee","avatar_template":"/user_avatar/discourse.urho3d.io/sonewbee/{size}/3755_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}}]},{"id":7347,"title":"How does Urho handle script objects each frame?","fancy_title":"How does Urho handle script objects each frame?","slug":"how-does-urho-handle-script-objects-each-frame","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-11-08T02:33:56.461Z","last_posted_at":"2022-11-08T14:46:09.857Z","bumped":true,"bumped_at":"2022-11-08T14:46:09.857Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":64,"category_id":9,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1292,"username":"evolgames","name":"evol","avatar_template":"/user_avatar/discourse.urho3d.io/evolgames/{size}/3169_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7181,"title":"StaticModelGroup - Are ShaderParameters Shared?","fancy_title":"StaticModelGroup - Are ShaderParameters Shared?","slug":"staticmodelgroup-are-shaderparameters-shared","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-02-02T09:31:19.658Z","last_posted_at":"2022-02-02T17:06:24.059Z","bumped":true,"bumped_at":"2022-02-02T17:06:24.059Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":120,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]},{"id":7107,"title":"Error: SDL/SDL_gamecontroller.h: No such file or directory #include \u003cSDL/SDL_gamecontroller.h\u003e","fancy_title":"Error: SDL/SDL_gamecontroller.h: No such file or directory #include \u0026lt;SDL/SDL_gamecontroller.h\u0026gt;","slug":"error-sdl-sdl-gamecontroller-h-no-such-file-or-directory-include-sdl-sdl-gamecontroller-h","posts_count":6,"reply_count":1,"highest_post_number":6,"image_url":null,"created_at":"2021-12-21T15:29:52.810Z","last_posted_at":"2021-12-22T15:32:44.818Z","bumped":true,"bumped_at":"2021-12-22T15:32:44.818Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":271,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1497,"username":"timob256","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/b782af/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]}],"tags_descriptions":{},"id":2156,"title":"Hardware instancing + animations / massive amount of sprites","fancy_title":"Hardware instancing + animations / massive amount of sprites","posts_count":7,"created_at":"2016-08-04T18:46:32.000Z","views":717,"reply_count":0,"like_count":0,"last_posted_at":"2016-08-05T17:29:42.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"hardware-instancing-animations-massive-amount-of-sprites","category_id":9,"word_count":908,"deleted_at":null,"user_id":513,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_2156","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":7,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":513,"username":"TheSHEEEP","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/thesheeep/{size}/74_2.png","post_count":4,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":3,"username":"cadaver","name":"Lasse Öörni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":2}],"created_by":{"id":513,"username":"TheSHEEEP","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/thesheeep/{size}/74_2.png"},"last_poster":{"id":513,"username":"TheSHEEEP","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/thesheeep/{size}/74_2.png"},"links":[{"url":"https://youtu.be/NAoMWOT2eXo?list=PLhG6bWwiy1v5I9fQ-gxohI8ffVCVI96D3\u0026t=65%5B/video%5D","title":"YouTube","internal":false,"attachment":false,"reflection":false,"clicks":5,"user_id":513,"domain":"youtu.be","root_domain":"youtu.be"}]}}