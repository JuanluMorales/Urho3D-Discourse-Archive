{"post_stream":{"posts":[{"id":5262,"name":"","username":"j15r","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/j/8e7dd6/{size}.png","created_at":"2015-03-08T20:40:15.000Z","cooked":"\u003cp\u003eSorry for the slew of Lua questions! I’m sure I’ll get my bearings soon and be able to keep quiet \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e\n\u003cp\u003eRelated to my last question, I’m also attempting to get Lua remote debugging working, via \u003ca href=\"https://studio.zerobrane.com/doc-remote-debugging.html\" rel=\"nofollow noopener\"\u003estudio.zerobrane.com/doc-remote-debugging.html\u003c/a\u003e. It looks like it should be pretty straightforward, but I’ve hit a snag with the Lua build coming out of Urho3D. mobdebug requires luasocket, which I have built and running. But when I try to require it from my Lua entry point script, I hit the error “error loading module ‘socket.core’ from file ‘/usr/local/lib/lua/5.1/socket/core.so’: dynamic libraries not enabled; check your Lua installation”.\u003c/p\u003e\n\u003cp\u003eI’m sure there’s some way deep in the bowels of the Lua build that’s turning off .so loading (or failing to enable it), but I can’t seem to find it. I’ve tried both Lua and LuaJIT to no avail. This message stems from lua/loadlib.c, and is triggered by none of {LUA_DL_DLOPEN, LUA_DL_DLL, LUA_DL_DYLD} being defined. But AFAICT each of the Windows/Mac/Linux should automatically define one of these shared library types, and I see nothing in the Urho3D build that explicitly disables them.\u003c/p\u003e\n\u003cp\u003eAgain, any pointers would be greatly appreciated, and I am of course open to other ways (apart from printf, which I loathe) to debug Lua code.\u003c/p\u003e\n\u003cp\u003eCheers,\u003cbr\u003e\njoel.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T01:04:03.724Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":124,"reads":12,"readers_count":11,"score":622.4,"yours":false,"topic_id":914,"topic_slug":"lua-debugging","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://studio.zerobrane.com/doc-remote-debugging.html","internal":false,"reflection":false,"title":"Remote Debugging - ZeroBrane Studio - Lua IDE/editor/debugger for Windows, Mac OSX, and Linux","clicks":7}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":215,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6447,"name":"","username":"feltech","avatar_template":"/user_avatar/discourse.urho3d.io/feltech/{size}/1362_2.png","created_at":"2015-06-11T23:05:23.000Z","cooked":"\u003cp\u003eHey.  I stumbled on this post when attempting to figure out myself how to debug Urho3D’s embedded Lua.  I’ve managed to get debugging working under the following conditions (note I tried to post some links but am not allowed yet - google is your friend):\u003c/p\u003e\n\u003cp\u003e[ul]\u003cbr\u003e\n[li] I have to use the LuaJIT Urho3D interpreter option, to get around the “dynamic libraries not enabled” issue (you say LuaJIT didn’t work for you, but it definitely does for me, only the standard Lua interpreter fails with this error).[/li]\u003cbr\u003e\n[li] I also had problems getting the \u003ccode\u003esocket\u003c/code\u003e library installed in a “nice” way.  Eventually I installed via the luarocks package manager, which installs to the system path rather than the project folder (annoying), but since it’s just for debugging and won’t be shipped I figured it’s fine.[/li]\u003cbr\u003e\n[li] I use eclipse with the LDT plugin, which comes with a \u003ccode\u003edebugger.lua\u003c/code\u003e that can be injected into your project.[/li][/ul]\u003cbr\u003e\nThis then got me a semi-working debugger.  However, I found that breakpoints wouldn’t be hit.  I enabled the “break on first line” option in LDT debugger, which did pause the script on loading it, but the source was not available.  Interestingly, the source higher up the stack was available, however, just not the source of my script.\u003c/p\u003e\n\u003cp\u003eI traced this to the way Urho3D (necessarily) loads it’s scripts into Lua.  A file is read to a character array and then the character array is read by the Lua interpreter, so the mapping to the original file is lost (see \u003ccode\u003eLuaFile.cpp\u003c/code\u003e).\u003c/p\u003e\n\u003cp\u003eSo, to execute a Lua file directly, rather than going through the resource cache, I added the following method to \u003ccode\u003eLuaScript.cpp\u003c/code\u003e as an alternative the the existing \u003ccode\u003eExecuteFile\u003c/code\u003e method:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003ebool LuaScript::ExecuteRawFile(const String\u0026amp; fileName)\n{\n    PROFILE(ExecuteRawFile);\n\n    ResourceCache* cache = GetSubsystem\u0026lt;ResourceCache\u0026gt;();\n    String filePath = cache-\u0026gt;GetResourceFileName(fileName);\n\n    LOGINFO(\"Executing Lua file from file system: \" + filePath);\n\n    if (filePath.Empty())\n    {\n        LOGERROR(\"Lua file not found: \" + filePath);\n    \treturn false;\n    }\n\n    int top = lua_gettop(luaState_);\n\n    if (luaL_loadfile (luaState_, filePath.CString()))\n    {\n        const char* message = lua_tostring(luaState_, -1);\n        LOGERROR(\"Load Lua file failed: \" + String(message));\n        lua_settop(luaState_, top);\n        return false;\n    }\n\n    if (lua_pcall(luaState_, 0, 0, 0))\n    {\n        const char* message = lua_tostring(luaState_, -1);\n        LOGERROR(\"Execute Lua file failed: \" + String(message));\n        lua_settop(luaState_, top);\n        return false;\n    }\n\n    return true;\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis combined with my findings above allows me to set breakpoints and step through my Lua code just fine (gotta love simultaneous debugging C++ and Lua code breakpoints).\u003c/p\u003e\n\u003cp\u003eNOTE: I am very new to Urho3D and Lua and the code above is spliced together from other methods and may not be the correct way of doing things.  But it does work for now and I’ll switch back to the ‘proper’ resource cache way of loading scripts in production.\u003c/p\u003e\n\u003cp\u003eHope this helps.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T01:05:32.568Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":6,"reads":11,"readers_count":10,"score":32.2,"yours":false,"topic_id":914,"topic_slug":"lua-debugging","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":260,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":6462,"name":"","username":"feltech","avatar_template":"/user_avatar/discourse.urho3d.io/feltech/{size}/1362_2.png","created_at":"2015-06-14T13:25:07.000Z","cooked":"\u003cp\u003eA quick update on this.  My solution above doesn’t work for script files imported within the script itself (i.e. \u003ccode\u003erequire (anotherscript)\u003c/code\u003e - breakpoints in “anotherscript” will not be hit).\u003c/p\u003e\n\u003cp\u003eThis is because the loader function registered with Lua (\u003ccode\u003eLuaScript::Loader\u003c/code\u003e) uses the \u003ccode\u003eluaL_loadbuffer\u003c/code\u003e method rather than \u003ccode\u003eluaL_loadfile\u003c/code\u003e.  Again, this is necessary for proper use of Urho3D’s resource cache (so the script file is loaded into an in-memory buffer and the buffer reused if/when the file is needed again).  However, it means that breakpoints are not hit when debugging Lua scripts.\u003c/p\u003e\n\u003cp\u003eMy solution is to add a CMake option that will force Urho3D to attempt the \u003ccode\u003eluaL_loadfile\u003c/code\u003e method to load a raw script file, before falling back on using the resource cache (which I think is necessary if the script file is packaged rather than a simple filesystem file).  This option can then be disabled for deployment, leaving the implementation exactly as it was before.\u003c/p\u003e\n\u003cp\u003eI’ll have a look at creating a pull request for this (I use git professionally, but never done a github pull request before, so have some reading to do).\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-01-02T01:05:33.680Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":2,"reads":9,"readers_count":8,"score":11.8,"yours":false,"topic_id":914,"topic_slug":"lua-debugging","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":260,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[5262,6447,6462]},"timeline_lookup":[[1,2816],[2,2721],[3,2719]],"suggested_topics":[{"id":7112,"title":"What is the proper way to add more source files(.cpp and .h) to a project?","fancy_title":"What is the proper way to add more source files(.cpp and .h) to a project?","slug":"what-is-the-proper-way-to-add-more-source-files-cpp-and-h-to-a-project","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2021-12-27T18:18:21.946Z","last_posted_at":"2021-12-28T12:19:43.514Z","bumped":true,"bumped_at":"2021-12-28T12:19:43.514Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":195,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1498,"username":"Tryout","name":null,"avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/85f322/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7125,"title":"Android mobile shows jaggies in the instersection plane-terrain","fancy_title":"Android mobile shows jaggies in the instersection plane-terrain","slug":"android-mobile-shows-jaggies-in-the-instersection-plane-terrain","posts_count":5,"reply_count":3,"highest_post_number":5,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/d/d36aedb4e8cf5409efca6c976aae7e4a5c499eb9.png","created_at":"2022-01-11T11:59:18.993Z","last_posted_at":"2022-01-11T21:27:40.692Z","bumped":true,"bumped_at":"2022-01-12T07:36:41.695Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":129,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":856,"username":"feresmu","name":null,"avatar_template":"https://avatars.discourse-cdn.com/v4/letter/f/f08c70/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]},{"id":7132,"title":"How to Draw Anti-Aliased Outlined Line on the UI layer?","fancy_title":"How to Draw Anti-Aliased Outlined Line on the UI layer?","slug":"how-to-draw-anti-aliased-outlined-line-on-the-ui-layer","posts_count":8,"reply_count":5,"highest_post_number":8,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/c/c040fdbc2f1856c238ba6328fd7f5ff80b15858f_2_782x1024.jpeg","created_at":"2022-01-17T22:08:06.874Z","last_posted_at":"2022-01-20T20:13:30.614Z","bumped":true,"bumped_at":"2022-01-20T20:13:30.614Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":173,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}]},{"id":7160,"title":"RayCast trouble","fancy_title":"RayCast trouble","slug":"raycast-trouble","posts_count":17,"reply_count":9,"highest_post_number":19,"image_url":null,"created_at":"2022-01-29T00:06:00.367Z","last_posted_at":"2022-01-30T00:29:39.356Z","bumped":true,"bumped_at":"2022-01-30T00:29:39.356Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":260,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":627,"username":"George1","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/9e8a1a/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}}]},{"id":7080,"title":"Build urho3d source on windows 10 - cmake - \"Error in configuration process, project files may be invalid\"","fancy_title":"Build urho3d source on windows 10 - cmake - \u0026ldquo;Error in configuration process, project files may be invalid\u0026rdquo;","slug":"build-urho3d-source-on-windows-10-cmake-error-in-configuration-process-project-files-may-be-invalid","posts_count":8,"reply_count":4,"highest_post_number":8,"image_url":null,"created_at":"2021-12-03T01:55:53.267Z","last_posted_at":"2021-12-06T22:46:59.584Z","bumped":true,"bumped_at":"2021-12-06T22:46:59.584Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":324,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1488,"username":"ToolmakerSteve","name":"ToolmakerSteve","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ba9def/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]}],"tags_descriptions":{},"id":914,"title":"Lua debugging","fancy_title":"Lua debugging","posts_count":3,"created_at":"2015-03-08T20:40:15.000Z","views":544,"reply_count":0,"like_count":0,"last_posted_at":"2015-06-14T13:25:07.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"lua-debugging","category_id":10,"word_count":905,"deleted_at":null,"user_id":215,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_914","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":3,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":260,"username":"feltech","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/feltech/{size}/1362_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":215,"username":"j15r","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/j/8e7dd6/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1}],"created_by":{"id":215,"username":"j15r","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/j/8e7dd6/{size}.png"},"last_poster":{"id":260,"username":"feltech","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/feltech/{size}/1362_2.png"},"links":[{"url":"https://studio.zerobrane.com/doc-remote-debugging.html","title":"Remote Debugging - ZeroBrane Studio - Lua IDE/editor/debugger for Windows, Mac OSX, and Linux","internal":false,"attachment":false,"reflection":false,"clicks":7,"user_id":215,"domain":"studio.zerobrane.com","root_domain":"zerobrane.com"}]}}