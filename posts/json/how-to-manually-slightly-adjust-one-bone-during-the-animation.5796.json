{"post_stream":{"posts":[{"id":34800,"name":"","username":"UrhoIsTheBest","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png","created_at":"2019-12-30T01:30:36.727Z","cooked":"\u003cp\u003eHi,\u003c/p\u003e\n\u003cp\u003eI am new to Urho3D engine and loved it very much. I spent several weeks going through the documentation and examples. I decided to start to create a game using it after that. Now I have a question and could not solve it after trying different methods for several day. I will be really appreciated if anyone could help me \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eQuestion:\u003c/strong\u003e\u003cbr\u003e\nHow to manually slightly adjust one bone during the animation.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eMore details:\u003c/strong\u003e\u003cbr\u003e\n\u003cstrong\u003eSkeleton:\u003c/strong\u003e I have a skeleton with ~20 bones, the root bone is ‚Äúabdomen‚Äù, then it‚Äôs child bone ‚Äúspine‚Äù which is the root bone of all the upper body bones. The ‚Äúabdomen‚Äù has another two children bones named ‚Äúthigh.L‚Äù and ‚Äúthigh.R‚Äù, which are root bones for all lower body bones.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eabdomen\u003cbr\u003e\n‚Äì spine\u003cbr\u003e\n‚Äì thigh.L\u003cbr\u003e\n‚Äì thigh.R\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003eAnimations:\u003c/strong\u003e I have N different sword attack animations for upper body; I have 8 (eight direction) different movement animations for lower body.\u003cbr\u003e\n\u003cstrong\u003eCamera:\u003c/strong\u003e I have a camera following the character (3rd person angle), the character and camera will rotate with the mouse.\u003c/p\u003e\n\u003cp\u003eWe know it‚Äôs pretty straightforward to blend upper/lower body animations to create 8*N animation combinations. (I just set lower body animation with layer = 0, and upper body animations with layer = 1, start_bone = ‚Äúspine‚Äù.)\u003c/p\u003e\n\u003cp\u003eNow it works like this, for example:\u003cbr\u003e\nIf the character is moving towards left. The character node is facing towards left, with the abdomen slightly up and downs during the running animation. Now If I click mouse, the upper body with attack left.\u003cbr\u003e\n\u003cstrong\u003eThe problem is:\u003c/strong\u003e I would still need the character to attack the forward (as camera direction in this case). The character attack left because ‚Äúspine‚Äù is a child of ‚Äúabdomen‚Äù and ‚Äúabdomen‚Äù direction is controlled by the running left animation.\u003cbr\u003e\n\u003cem\u003eMy gameplay requires the sword attack/swing direction be exactly the same (only depends on the camera direction) no matter what direction the player is running. Similar to CS, you always aim forward during you press WASD keys.\u003c/em\u003e\u003cbr\u003e\n\u003cstrong\u003eThings I tried:\u003c/strong\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eForce the ‚Äúspine‚Äù node to face forward using SetWorldDirection. This does not work good because the character would be very rigid for upper body. The original attack animation, running animation both gives the ‚Äúabdomen‚Äù and ‚Äúspine‚Äù node some up and downs which seems more realistic;\u003c/li\u003e\n\u003cli\u003eGet current ‚Äúspine‚Äù direction for each frame of the animation and then rotate it by 90 degrees, set the new direction. This should be the correct solution but I just could not make it work. The whole character just blink a lot, seems like the character is rotating 90 degrees every frame;\u003c/li\u003e\n\u003cli\u003eUse IK. I am not very familiar with IK and struggled a lot here. I set the end node IKEffector to ‚Äúspine‚Äù and attach the IKSolver to ‚Äúabdomen‚Äù like this:\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e// For IK\n  spine_node_ = node_-\u0026gt;GetChild(\"spine\", true);\n  spine_effector_  = spine_node_-\u0026gt;CreateComponent\u0026lt;IKEffector\u0026gt;();\n  // Control 1 segment to abdomen bone.\n  spine_effector_-\u0026gt;SetChainLength(1);\n\n  // For the effectors to work, an IKSolver needs to be attached to one of\n  // the parent nodes. Typically, you want to place the solver as close as\n  // possible to the effectors for optimal performance. Since in this case\n  // we're solving the legs only, we can place the solver at the spine.\n  abdomen_node_ = node_-\u0026gt;GetChild(\"abdomen\", true);\n  solver_ = abdomen_node_-\u0026gt;CreateComponent\u0026lt;IKSolver\u0026gt;();\n\n  // Two-bone solver is more efficient and more stable than FABRIK (but only\n  // works for two bones, obviously).\n  solver_-\u0026gt;SetAlgorithm(IKSolver::ONE_BONE);\n\n  // Disable auto-solving, which means we need to call Solve() manually\n  solver_-\u0026gt;SetFeature(IKSolver::AUTO_SOLVE, false);\n//  solver_-\u0026gt;SetFeature(IKSolver::TARGET_ROTATIONS, true);\n\n  // Only enable this so the debug draw shows us the pose before solving.\n  // This should NOT be enabled for any other reason (it does nothing and is\n  // a waste of performance).\n  solver_-\u0026gt;SetFeature(IKSolver::UPDATE_ORIGINAL_POSE, true);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis just somehow makes my whole character changed, e.g. upside down. \u003cstrong\u003eShould I expect the ‚Äúabdomen‚Äù bone changes the position using this setting? If the root node of IK chain will change, maybe I should set ‚Äúspine‚Äù as root node? Then there is  only one node, there is no chain anymore, how should I make IK change only \"spine?\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eI believe solution 2 should be the correct way to solve it, but I just don‚Äôt know how to fix all the details.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eBTW:\u003cbr\u003e\nI‚Äôve been looking for a 3D game engine for a long time and finally found Urho3D. It satisfied all my requirement:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cstrong\u003eLight weighted.\u003c/strong\u003e I‚Äôve used Unity and Unreal for a while, but could not stand those big engines. I don‚Äôt need 99% of those stuff but there is no choice. For my 2014 macbook pro, it cannot even run an empty Unreal project fluently, very disappointing.\u003c/li\u003e\n\u003cli\u003e\n\u003cstrong\u003eProgrammer friendly\u003c/strong\u003e. I don‚Äôt like those drag \u0026amp; mouse click operations in editors. It‚Äôs very inefficient. I like to see everything including settings in code.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eThe only drawback for me is the \u003cstrong\u003elack of documentation,\u003c/strong\u003e which I hope will be improved in the near future.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2019-12-31T01:24:12.763Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":90,"reads":46,"readers_count":45,"score":479.2,"yours":false,"topic_id":5796,"topic_slug":"how-to-manually-slightly-adjust-one-bone-during-the-animation","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":1291,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":34802,"name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","username":"Modanung","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png","created_at":"2019-12-30T12:18:29.800Z","cooked":"\u003cp\u003eHello‚Ä¶ \u003ca class=\"mention\" href=\"/u/UrhoIsTheBest\"\u003e@UrhoIsTheBest\u003c/a\u003e and welcome to the forums! \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/confetti_ball.png?v=9\" title=\":confetti_ball:\" class=\"emoji\" alt=\":confetti_ball:\"\u003e \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slightly_smiling_face.png?v=9\" title=\":slightly_smiling_face:\" class=\"emoji\" alt=\":slightly_smiling_face:\"\u003e\u003cbr\u003e\nDid you take a look at sample 45? (located in Urho3D/Source/Samples/)\u003cbr\u003e\nFurthermore \u003ca href=\"https://urho3d.github.io/documentation/HEAD/_i_k.html\"\u003ehere\u003c/a\u003e‚Äôs the docs on IK.\u003c/p\u003e\n\u003cp\u003eFor updating a single animated bone, basically all you need to know is that its transform has to be modified during the \u003ccode\u003eSceneDrawableUpdateFinished\u003c/code\u003e event. To get it right though, you may need to do some \u003ccode\u003eSlerp\u003c/code\u003eing and understand vector math concepts like the cross product and dot product.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2019-12-30T12:27:58.222Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":39,"readers_count":38,"score":27.8,"yours":false,"topic_id":5796,"topic_slug":"how-to-manually-slightly-adjust-one-bone-during-the-animation","display_username":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://urho3d.github.io/documentation/HEAD/_i_k.html","internal":false,"reflection":false,"title":"Urho3D - Documentation - Inverse Kinematics","clicks":2}],"read":true,"user_title":"","bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":192,"hidden":false,"trust_level":0,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_suspended":true,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":34803,"name":"","username":"Dave82","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png","created_at":"2019-12-30T13:54:31.340Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"UrhoIsTheBest\" data-post=\"1\" data-topic=\"5796\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/40.png\" class=\"avatar\"\u003e UrhoIsTheBest:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHow to manually slightly adjust one bone during the animation.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eHi ! I don‚Äôt know if it will help your situation but the best and most generic way to adjust a bone transform is to subscribe to the E_SCENEDRAWABLEUPDATEFINISHED event and handle it there.\u003cbr\u003e\nThis event is called after all your nodes transforms and updated /calcualated and are ready for rendering.\u003cbr\u003e\nSo you can adjust a bone transform in this function and it will not be overridden by the animation.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2019-12-30T13:54:31.340Z","reply_count":2,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":1,"reads":40,"readers_count":39,"score":38.0,"yours":false,"topic_id":5796,"topic_slug":"how-to-manually-slightly-adjust-one-bone-during-the-animation","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":247,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":34806,"name":"","username":"UrhoIsTheBest","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png","created_at":"2019-12-30T22:18:43.365Z","cooked":"\u003caside class=\"quote no-group\" data-post=\"2\" data-topic=\"5796\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt width=\"20\" height=\"20\" src=\"https://sjc6.discourse-cdn.com/standard17/user_avatar/discourse.urho3d.io/modanung/40/2706_2.png\" class=\"avatar\"\u003e Modanung:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eFurthermore \u003ca href=\"https://urho3d.github.io/documentation/HEAD/_i_k.html\" rel=\"nofollow noopener\"\u003ehere \u003c/a\u003e‚Äôs the docs on IK.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eYes, I did check the doc, but I could not figure out which bones are affected and how to choose the correct parameter during the IK process just from the doc.\u003c/p\u003e\n\u003caside class=\"quote no-group\" data-post=\"2\" data-topic=\"5796\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt width=\"20\" height=\"20\" src=\"https://sjc6.discourse-cdn.com/standard17/user_avatar/discourse.urho3d.io/modanung/40/2706_2.png\" class=\"avatar\"\u003e Modanung:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eDid you take a look at sample 45? (located in Urho3D/Source/Samples/)\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eYes, I did check example 45. That was much simpler though.\u003c/p\u003e\n\u003cp\u003eFor that example, the bone hierarchy is (from parent to children):\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eBip01_Spine \u003cem\u003e(IKSolver attached here)\u003c/em\u003e\u003cbr\u003e\n‚Äì\u0026gt; Bip01_R_Thigh\u003cbr\u003e\n‚Äì\u0026gt; Bip01_R_Calf\u003cbr\u003e\n‚Äì\u0026gt; Bip01_R_Foot \u003cem\u003e(IKEffector attached here)\u003c/em\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThen it set:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003esolver_-\u0026gt;SetAlgorithm(IKSolver::TWO_BONE);\nrightEffector_-\u0026gt;SetChainLength(2);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eMy understanding is (correct me if I am wrong):\u003cbr\u003e\nThis means the bones 2 levels up the effector node would modify the transform, e.g. 3 bones \u003ccode\u003eBip01_R_Thigh\u003c/code\u003e, \u003ccode\u003eBip01_R_Calf\u003c/code\u003e, and \u003ccode\u003eBip01_R_Foot\u003c/code\u003e would be modified. This seems correct according to the demo.\u003c/p\u003e\n\u003cp\u003eFor my case, however, I only need to change ‚Äúspine‚Äù bone, which is the direct child of root bone ‚Äúabdomen‚Äù.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eabdomen \u003cem\u003e(IKSolver attached here)\u003c/em\u003e\u003cbr\u003e\n‚Äì\u0026gt; spine \u003cem\u003e(IKEffector attached here)\u003c/em\u003e\u003cbr\u003e\nThen I can only set:\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003esolver_-\u0026gt;SetAlgorithm(IKSolver::ZERO_BONE);\neffector_-\u0026gt;SetChainLength(0);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhich does \u003cstrong\u003eNOT\u003c/strong\u003e make any sense, right?\u003c/p\u003e\n\u003cp\u003eI also tried to use\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003esolver_-\u0026gt;SetAlgorithm(IKSolver::ONE_BONE);\neffector_-\u0026gt;SetChainLength(1);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen the \u003ccode\u003eabdomen\u003c/code\u003e bone is also modified during the test, the animation seems broken and flicker.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2019-12-30T22:18:43.365Z","reply_count":0,"reply_to_post_number":2,"quote_count":1,"incoming_link_count":1,"reads":36,"readers_count":35,"score":12.2,"yours":false,"topic_id":5796,"topic_slug":"how-to-manually-slightly-adjust-one-bone-during-the-animation","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1291,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":34807,"name":"","username":"UrhoIsTheBest","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png","created_at":"2019-12-30T22:28:45.260Z","cooked":"\u003cp\u003eThat‚Äôs what I tried according to Example 45.\u003cbr\u003e\nYou can also check my reply to \u003ca href=\"/u/Modanung\"\u003eModanung\u003c/a\u003e above, any advice?\u003c/p\u003e\n\u003cp\u003eAlso I have another related question about the \u003ccode\u003eE_SCENEDRAWABLEUPDATEFINISHED\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eIf I need to do physics collision check, e.g. blade vs. enemy body. We know those calculation usually happens in the \u003ccode\u003eFIXEDUPDATE\u003c/code\u003e.\u003cbr\u003e\nIf somehow I update the bone position during \u003ccode\u003eE_SCENEDRAWABLEUPDATEFINISHED\u003c/code\u003e, Would it mess up the physics collision?\u003c/p\u003e\n\u003cp\u003eFor example, in the original animation, the body faces left, the blade swing towards left. So the blade will collide objects in the left side. However, when we force the upper body face forward direction in \u003ccode\u003eE_SCENEDRAWABLEUPDATEFINISHED\u003c/code\u003e. There is no physics collision detection for blade swing towards forward anymore.\u003cbr\u003e\nThe game would look like the character swing a sword in forward direction and it hits the objects in the left side?\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2019-12-30T22:28:45.260Z","reply_count":0,"reply_to_post_number":3,"quote_count":0,"incoming_link_count":5,"reads":34,"readers_count":33,"score":31.8,"yours":false,"topic_id":5796,"topic_slug":"how-to-manually-slightly-adjust-one-bone-during-the-animation","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","reply_to_user":{"username":"Dave82","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1291,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":34847,"name":"","username":"UrhoIsTheBest","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png","created_at":"2020-01-06T08:18:25.598Z","cooked":"\u003cp\u003eAfter days of playing around, now I have a better understanding of the engine and I believe it‚Äôs powerful enough to do most of things I wanted. I am going to close this thread with some notes which might be helpful for others.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eI misunderstood the power of IK. It actually only does one thing: calculate the positions of all bones from root-bone to end-bone given the desired location of end-bone. It does not care much about pure rotations.\u003cbr\u003e\nFor example, if you want \u003ccode\u003ethorax\u003c/code\u003e bone to face one direction and \u003ccode\u003eabdomen\u003c/code\u003e to face another direction. IK would not help you to find a \u003cem\u003eVisually Natural\u003c/em\u003e rotation between those bones. You have to manually set that by yourself, e.g. \u003ccode\u003eabdomen\u003c/code\u003e bone can face left, then set \u003ccode\u003espine\u003c/code\u003e bone to rotate 45 degree around axis-Y, also set \u003ccode\u003ethorax\u003c/code\u003e bone to rotate 45 degree around axis-Y. Thus, \u003ccode\u003ethorax\u003c/code\u003e faces forward (45+45=90). You could also set with 30, 60 degree respectively.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eYou can reconstruct the skeleton structure by inserting extra nodes.\u003c/strong\u003e\u003cbr\u003e\nFor example, I tried to add two extra nodes, \u003ccode\u003elower_body_root_node\u003c/code\u003e and \u003ccode\u003eupper_body_root_node\u003c/code\u003e. Then move \u003ccode\u003espine\u003c/code\u003e node as child of \u003ccode\u003eupper_body_root_node\u003c/code\u003e (\u003ccode\u003eabdomen\u003c/code\u003e child to \u003ccode\u003elower_body_root_node\u003c/code\u003e respectively). The original animation system still works perfectly. But I have another degree of freedom to separately control upper \u0026amp; lower body, e.g. rotate some degree between them.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eYou can do almost everything you want about raw animation resource data due to the accessibility of KeyFrame data.\u003c/strong\u003e\u003cbr\u003e\nAn example code path could be\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003eAnimationState-\u0026gt;GetAnimation()-\u0026gt;GetTrack(String(\"abdomen\"))-\u0026gt;keyFrames_\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou can directly manipulate bone \u003ccode\u003eposition\u003c/code\u003e and \u003ccode\u003erotation\u003c/code\u003e in \u003ca href=\"https://urho3d.github.io/documentation/1.5/struct_urho3_d_1_1_animation_key_frame.html\" rel=\"nofollow noopener\"\u003eAnimationKeyFrame\u003c/a\u003e.\u003cbr\u003e\nFor example, if I want to only apply the rotation change during a bone animation while fixing the bone position (ignoring the position change). You could do something like:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003eVector3 tmp = Vector3::ZERO;\nfor (AnimationKeyFrame\u0026amp; key_frame : animation_state-\u0026gt;GetAnimation()-\u0026gt;GetTrack(String(\"abdomen\"))-\u0026gt;keyFrames_) {\n  // Set all position as the 1st frame, e.g. no position movement for additive animation.\n  if (tmp == Vector3::ZERO) {\n    tmp = key_frame.position_;\n  } else {\n    key_frame.position_ = tmp;\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou could do many other interesting stuff with directly manipulating the animation data.\u003c/p\u003e\n\u003col start=\"4\"\u003e\n\u003cli\u003e\n\u003cstrong\u003eMany other small things\u003c/strong\u003e which I wish I could‚Äôve learned in tutorials somewhere by more experienced developers.\u003c/li\u003e\n\u003c/ol\u003e","post_number":6,"post_type":1,"updated_at":"2020-01-06T08:22:10.072Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":2,"reads":35,"readers_count":34,"score":77.0,"yours":false,"topic_id":5796,"topic_slug":"how-to-manually-slightly-adjust-one-bone-during-the-animation","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://urho3d.github.io/documentation/1.5/struct_urho3_d_1_1_animation_key_frame.html","internal":false,"reflection":false,"title":"Urho3D - Documentation","clicks":1}],"read":true,"user_title":"","bookmarked":false,"actions_summary":[{"id":2,"count":2}],"moderator":false,"admin":false,"staff":false,"user_id":1291,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":true},{"id":40852,"name":"","username":"CE184","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/c/a88e4f/{size}.png","created_at":"2020-11-23T05:19:08.927Z","cooked":"\u003cp\u003eI had the same question and thanks, the E_SCENEDRAWABLEUPDATEFINISHED works for me.\u003cbr\u003e\nBut is this event before or after physics update? because I need the physics collision happen to the modified bone  transform too. I check \u003ca href=\"https://urho3d.github.io/documentation/1.6/_main_loop.html\" rel=\"noopener nofollow ugc\"\u003ethis page\u003c/a\u003e for the main loop order but could not find the E_SCENEDRAWABLEUPDATEFINISHED.\u003c/p\u003e","post_number":7,"post_type":1,"updated_at":"2020-11-23T05:19:08.927Z","reply_count":1,"reply_to_post_number":3,"quote_count":0,"incoming_link_count":0,"reads":27,"readers_count":26,"score":10.4,"yours":false,"topic_id":5796,"topic_slug":"how-to-manually-slightly-adjust-one-bone-during-the-animation","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://urho3d.github.io/documentation/1.6/_main_loop.html","internal":false,"reflection":false,"title":"Urho3D - Documentation - Engine initialization and main loop","clicks":1}],"read":true,"user_title":null,"reply_to_user":{"username":"Dave82","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1384,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":40855,"name":"Justin Miller","username":"jmiller","avatar_template":"/user_avatar/discourse.urho3d.io/jmiller/{size}/2367_2.png","created_at":"2020-11-23T12:08:13.331Z","cooked":"\u003cp\u003eHello,\u003c/p\u003e\n\u003cp\u003eI find a few references to that event with regex search:\u003cbr\u003e\nDefined in  \u003ca href=\"https://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Scene/SceneEvents.h\"\u003ehttps://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Scene/SceneEvents.h\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eand docs IK section (you linked to 1.6 by the way, a very old version):\u003cbr\u003e\n\u003ca href=\"https://urho3d.github.io/documentation/HEAD/_i_k.html#iksolverautosolve\"\u003ehttps://urho3d.github.io/documentation/HEAD/_i_k.html#iksolverautosolve\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIt appears Octree is updated by Renderer in Update‚Ä¶\u003cbr\u003e\n\u003ca href=\"https://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Graphics/Renderer.cpp#L1503\"\u003ehttps://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Graphics/Renderer.cpp#L1503\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eCould try a breakpoint or such to find relative order.\u003cbr\u003e\nHTH\u003c/p\u003e","post_number":8,"post_type":1,"updated_at":"2020-11-23T12:10:02.545Z","reply_count":0,"reply_to_post_number":7,"quote_count":0,"incoming_link_count":1,"reads":26,"readers_count":25,"score":10.2,"yours":false,"topic_id":5796,"topic_slug":"how-to-manually-slightly-adjust-one-bone-during-the-animation","display_username":"Justin Miller","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Graphics/Renderer.cpp#L1503","internal":false,"reflection":false,"title":"Urho3D/Renderer.cpp at master ¬∑ urho3d/Urho3D ¬∑ GitHub","clicks":1},{"url":"https://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Scene/SceneEvents.h","internal":false,"reflection":false,"title":"Urho3D/SceneEvents.h at master ¬∑ urho3d/Urho3D ¬∑ GitHub","clicks":0},{"url":"https://urho3d.github.io/documentation/HEAD/_i_k.html#iksolverautosolve","internal":false,"reflection":false,"title":"Urho3D - Documentation - Inverse Kinematics","clicks":0}],"read":true,"user_title":"","reply_to_user":{"username":"CE184","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/c/a88e4f/{size}.png"},"bookmarked":false,"actions_summary":[],"moderator":true,"admin":false,"staff":true,"user_id":21,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[34800,34802,34803,34806,34807,34847,40852,40855]},"timeline_lookup":[[1,1059],[4,1058],[6,1052],[7,730]],"suggested_topics":[{"id":7132,"title":"How to Draw Anti-Aliased Outlined Line on the UI layer?","fancy_title":"How to Draw Anti-Aliased Outlined Line on the UI layer?","slug":"how-to-draw-anti-aliased-outlined-line-on-the-ui-layer","posts_count":8,"reply_count":5,"highest_post_number":8,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/c/c040fdbc2f1856c238ba6328fd7f5ff80b15858f_2_782x1024.jpeg","created_at":"2022-01-17T22:08:06.874Z","last_posted_at":"2022-01-20T20:13:30.614Z","bumped":true,"bumped_at":"2022-01-20T20:13:30.614Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":173,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}]},{"id":7178,"title":"Medium-Quality Technique for Semi-Reflective/Specular Glass in Urho","fancy_title":"Medium-Quality Technique for Semi-Reflective/Specular Glass in Urho","slug":"medium-quality-technique-for-semi-reflective-specular-glass-in-urho","posts_count":3,"reply_count":0,"highest_post_number":3,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/5/51408fe152ba02eb8b92237cc9a9411c8ee922e6.jpeg","created_at":"2022-01-31T22:57:50.134Z","last_posted_at":"2022-02-01T04:32:37.418Z","bumped":true,"bumped_at":"2022-02-01T04:32:37.418Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":154,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}}]},{"id":7200,"title":"Urho3D just building if I check \"use SHARED libraries\"","fancy_title":"Urho3D just building if I check \u0026ldquo;use SHARED libraries\u0026rdquo;","slug":"urho3d-just-building-if-i-check-use-shared-libraries","posts_count":8,"reply_count":3,"highest_post_number":8,"image_url":null,"created_at":"2022-02-22T20:02:48.835Z","last_posted_at":"2022-02-23T15:38:33.698Z","bumped":true,"bumped_at":"2022-02-23T15:54:07.879Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":165,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1508,"username":"killinbassou","name":"killin","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/k/848f3c/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png"}}]},{"id":7204,"title":"How handle with multiple scenes?","fancy_title":"How handle with multiple scenes?","slug":"how-handle-with-multiple-scenes","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-02-23T16:15:02.697Z","last_posted_at":"2022-02-23T16:15:02.762Z","bumped":true,"bumped_at":"2022-02-23T16:15:02.762Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":131,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":1508,"username":"killinbassou","name":"killin","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/k/848f3c/{size}.png"}}]},{"id":7087,"title":"Android how to get error message sometimes little change gives me just crash","fancy_title":"Android how to get error message sometimes little change gives me just crash","slug":"android-how-to-get-error-message-sometimes-little-change-gives-me-just-crash","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-12-05T16:59:59.376Z","last_posted_at":"2021-12-05T18:17:02.335Z","bumped":true,"bumped_at":"2021-12-05T18:17:02.335Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":153,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1436,"username":"Maco","name":"Maco","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/m/90ced4/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}}]}],"tags_descriptions":{},"id":5796,"title":"How to manually slightly adjust one bone during the animation","fancy_title":"How to manually slightly adjust one bone during the animation","posts_count":8,"created_at":"2019-12-30T01:30:36.654Z","views":553,"reply_count":4,"like_count":5,"last_posted_at":"2020-11-23T12:08:13.331Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"how-to-manually-slightly-adjust-one-bone-during-the-animation","category_id":10,"word_count":1901,"deleted_at":null,"user_id":1291,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_5796","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":8,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":5,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"accepted_answer":{"post_number":6,"username":"UrhoIsTheBest","excerpt":"After days of playing around, now I have a better understanding of the engine and I believe it‚Äôs powerful enough to do most of things I wanted. I am going to close this thread with some notes which might be helpful for others. \n\n\nI misunderstood the power of IK. It actually only does one thing: calc\u0026hellip;"},"details":{"can_edit":false,"notification_level":1,"participants":[{"id":1291,"username":"UrhoIsTheBest","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png","post_count":4,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":21,"username":"jmiller","name":"Justin Miller","avatar_template":"/user_avatar/discourse.urho3d.io/jmiller/{size}/2367_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"moderator":true,"trust_level":3},{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":0},{"id":247,"username":"Dave82","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":1384,"username":"CE184","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/c/a88e4f/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1}],"created_by":{"id":1291,"username":"UrhoIsTheBest","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png"},"last_poster":{"id":21,"username":"jmiller","name":"Justin Miller","avatar_template":"/user_avatar/discourse.urho3d.io/jmiller/{size}/2367_2.png"},"links":[{"url":"https://urho3d.github.io/documentation/HEAD/_i_k.html","title":"Urho3D - Documentation - Inverse Kinematics","internal":false,"attachment":false,"reflection":false,"clicks":2,"user_id":192,"domain":"urho3d.github.io","root_domain":"urho3d.github.io"},{"url":"https://github.com/urho3d/Urho3D/blob/master/Source/Urho3D/Graphics/Renderer.cpp#L1503","title":"Urho3D/Renderer.cpp at master ¬∑ urho3d/Urho3D ¬∑ GitHub","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":21,"domain":"github.com","root_domain":"github.com"},{"url":"https://urho3d.github.io/documentation/1.5/struct_urho3_d_1_1_animation_key_frame.html","title":"Urho3D - Documentation","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":1291,"domain":"urho3d.github.io","root_domain":"urho3d.github.io"},{"url":"https://urho3d.github.io/documentation/1.6/_main_loop.html","title":"Urho3D - Documentation - Engine initialization and main loop","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":1384,"domain":"urho3d.github.io","root_domain":"urho3d.github.io"}]}}