{"post_stream": {"posts": [{"id": 3586, "name": "", "username": "reattiva", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/b77776/{size}.png", "created_at": "2014-12-12T20:10:16.000Z", "cooked": "<p>Hello, I\u2019ve adapted the Alchemy/SAO ambient occlusion algorithm by Morgan McGuire:<br>\n<a href=\"http://graphics.cs.williams.edu/papers/AlchemyHPG11/\" rel=\"nofollow noopener\">graphics.cs.williams.edu/papers/AlchemyHPG11/</a><br>\n<a href=\"http://graphics.cs.williams.edu/papers/SAOHPG12/\" rel=\"nofollow noopener\">graphics.cs.williams.edu/papers/SAOHPG12/</a><br>\nIt has some faults, especially the blur shaders, but it could be a starting point.</p>\n<p>You can find it here:<br>\n<a href=\"https://bitbucket.org/reattiva/sao-as/downloads\" rel=\"nofollow noopener\">bitbucket.org/reattiva/sao-as/downloads</a></p>\n<p>There is a simple AS script (Alchemy.as) to test it. It uses deferred render path, the occlusion shader needs the depth and normal buffers, but normals can also be calculated realtime on the shader.<br>\nIt is based on McGuire\u2019s demo code (BSD licensed) for SAO, but many of the SAO improvements are not implemented so it is closer to the Alchemy algorithm than the SAO one. I\u2019ve written some Gaussian blur filters: BlurGaussian and BlurGaussianDepth. They tend to make occlusion too big in the distance so I\u2019ve added a fade-out effect.<br>\nThe parameters are very coupled and difficult to adjust, this is exactly the opposite of the original author results, probably there are some bugs around. These parameters are: radius, intensity, projscale and bias. Projscale is used to adjust the radius scaling with the depth, this was not present in the paper so I think this is the bugged part. Bias is used to prevent self occlusion due to depth precision (e.g. a flat surface should be white).<br>\nThe parameters are changeable with the keyboard (R,F,T,G,Y,H,U,J), you can disable the occlusion effect (V), enable a Gaussian blur (B), enable a depth aware Gaussian blur (N), and display the occlusion buffer (M).<br>\nIn the script set \u201cbool OpenGL\u201d to false if you use DirectX (I couldn\u2019t find a good flag for this).</p>\n<p>Notes:</p>\n<ol>\n<li>\n<p>In this example the intensity is too high, it should be a very subtle effect, but more important the occlusion buffer is blended with the final viewport (SAO_copy shader). This is not correct, AO should only affect the ambient light. A simple way to do this is to move the \u201cquad SAO_copy\u201d command before the \u201clightvolumes\u201d command (and enable shadows to appreciate the difference). The \u201clightvolumes\u201d command is not a good point to do the blend because it uses the add/subtract blend mode.</p>\n</li>\n<li>\n<p>When you use a big radius, the occlusion is not correct around the screen borders because these is no depth buffer to sample outside the screen. To reduce this flaw you can use a G-buffer bigger than the viewport (for example \u201c\u201d), you compute the occlusion and then you can use a shader to offset and center it on the screen. This guard band is used only for reading the depth buffer, to avoid calculating the occlusion on it you can use Graphics::SetScissorTest in View::RenderQuad. This could also be done on the \u201clightvolumes\u201d command in View::SetupLightVolumeBatch. You have to modify the engine but it should not be hard.</p>\n</li>\n<li>\n<p>An improvement of SAO is the use of a depth buffer with mipmaps. To do this you create a texture for the depth buffer with N mipmaps, then you create N framebuffers and attach a different depth mipmap to each of them on COLOR0. Using the first framebuffer you compute the depth buffer, this will be written on the level 0 of the depth texture, then using the other framebuffers and a special shader you can build a mipmap level N by reading the level N-1.<br>\nI\u2019ve still haven\u2019t how to do this in Urho (RenderTargets don\u2019t have mipmaps), and using mipmaps in HLSL is tricky/impossible with DirectX9 (on GLSL it is possible by enabling \u201cextension GL_EXT_gpu_shader4\u201d).</p>\n</li>\n</ol>\n<p>Any comment is really welcomed.</p>\n<p><a href=\"http://postimg.org/image/4tqdy5v77/\" data-bbcode=\"true\" rel=\"nofollow noopener\"><img src=\"http://s29.postimg.org/4tqdy5v77/image.jpg\" alt=\"\" width=\"\" height=\"\"></a></p>", "post_number": 1, "post_type": 1, "updated_at": "2017-01-02T01:01:57.681Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 478, "reads": 92, "readers_count": 91, "score": 2453.4, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "link_counts": [{"url": "https://bitbucket.org/reattiva/sao-as/downloads", "internal": false, "reflection": false, "title": "reattiva / SAO-AS / Downloads \u2014 Bitbucket", "clicks": 133}, {"url": "http://postimg.org/image/4tqdy5v77/", "internal": false, "reflection": false, "title": "ao \u2014 Postimage.org", "clicks": 85}, {"url": "http://graphics.cs.williams.edu/papers/AlchemyHPG11/", "internal": false, "reflection": false, "title": "The Alchemy Screen-Space Ambient Obscurance Algorithm", "clicks": 73}, {"url": "http://graphics.cs.williams.edu/papers/SAOHPG12/", "internal": false, "reflection": false, "title": "Scalable Ambient Obscurance", "clicks": 29}, {"url": "http://discourse.urho3d.io/t/ssdo-or-ssao-examples/3706/3", "internal": true, "reflection": true, "title": "SSDO or SSAO examples?", "clicks": 13}, {"url": "https://discourse.urho3d.io/t/can-you-make-more-cute-graphics-with-urho3d/4062/4", "internal": true, "reflection": true, "title": "Can you make more \"cute\" graphics with Urho3D?", "clicks": 2}, {"url": "https://discourse.urho3d.io/t/sao-implementation-errors/4097", "internal": true, "reflection": true, "title": "SAO implementation errors", "clicks": 2}, {"url": "http://discourse.urho3d.io/t/some-nice-assets-to-make-an-urho3d-demo-from/3704/15", "internal": true, "reflection": true, "title": "Some nice assets to make an Urho3D demo from", "clicks": 1}], "read": true, "user_title": null, "bookmarked": false, "actions_summary": [{"id": 2, "count": 1}], "moderator": false, "admin": false, "staff": false, "user_id": 72, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3591, "name": "", "username": "codingmonkey", "avatar_template": "/user_avatar/discourse.urho3d.io/codingmonkey/{size}/119_2.png", "created_at": "2014-12-12T22:09:56.000Z", "cooked": "<p>Wow, cool!<br>\nI tried to rewrite your script in C ++ and use in my test scene, but the scene did not look like the examples from the video (frog kinght). Maybe I missed something in code.</p>", "post_number": 2, "post_type": 1, "updated_at": "2017-01-02T01:01:58.050Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 80, "readers_count": 79, "score": 16.0, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 148, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3592, "name": "", "username": "alexrass", "avatar_template": "/user_avatar/discourse.urho3d.io/alexrass/{size}/1036_2.png", "created_at": "2014-12-12T22:33:51.000Z", "cooked": "<p>GL_EXT_gpu_shader4 from OpenGL 3.0?</p>", "post_number": 3, "post_type": 1, "updated_at": "2017-01-02T01:01:58.118Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 1, "reads": 80, "readers_count": 79, "score": 21.0, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 36, "hidden": false, "trust_level": 1, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3603, "name": "", "username": "reattiva", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/b77776/{size}.png", "created_at": "2014-12-13T19:19:47.000Z", "cooked": "<aside class=\"quote\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt width=\"20\" height=\"20\" src=\"https://sjc6.discourse-cdn.com/standard17/user_avatar/discourse.urho3d.io/codingmonkey/40/119_1.png\" class=\"avatar\"> codingmonkey:</div>\n<blockquote>\n<p>the scene did not look like the examples from the video (frog kinght)</p>\n</blockquote>\n</aside>\n<p>Any screenshot? If the test scene of the script looks the same then the problem are the shaders or their parameters. Actually, I was never able to make the original demo from McGuire work, so I don\u2019t really know if it is supposed to look like that.</p>\n<aside class=\"quote\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt width=\"20\" height=\"20\" src=\"https://sjc6.discourse-cdn.com/standard17/user_avatar/discourse.urho3d.io/alexrass/40/1036_1.png\" class=\"avatar\"> alexrass:</div>\n<blockquote>\n<p>GL_EXT_gpu_shader4 from OpenGL 3.0?</p>\n</blockquote>\n</aside>\n<p>This one <a href=\"https://www.opengl.org/registry/specs/EXT/gpu_shader4.txt\" data-bbcode=\"true\" rel=\"nofollow noopener\">https://www.opengl.org/registry/specs/EXT/gpu_shader4.txt</a>, so the minimum is OpenGL 2.0, GLSL 1.10 and a card that supports it. Anyway you don\u2019t need this for the example, you need it only to work with mipmaps. I\u2019ve also removed the bitwise operations from the random function (not sure if it was wise), so you really don\u2019t need this extension.</p>", "post_number": 4, "post_type": 1, "updated_at": "2017-01-02T01:01:58.941Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 1, "incoming_link_count": 5, "reads": 80, "readers_count": 79, "score": 41.0, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "link_counts": [{"url": "https://www.opengl.org/registry/specs/EXT/gpu_shader4.txt", "internal": false, "reflection": false, "clicks": 6}], "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 72, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3612, "name": "", "username": "alexrass", "avatar_template": "/user_avatar/discourse.urho3d.io/alexrass/{size}/1036_2.png", "created_at": "2014-12-13T22:16:38.000Z", "cooked": "<p>cool</p>", "post_number": 5, "post_type": 1, "updated_at": "2017-01-02T01:01:59.611Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 1, "reads": 66, "readers_count": 65, "score": 18.2, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 36, "hidden": false, "trust_level": 1, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3712, "name": "", "username": "sabotage3d", "avatar_template": "/user_avatar/discourse.urho3d.io/sabotage3d/{size}/87_2.png", "created_at": "2014-12-21T11:30:17.000Z", "cooked": "<p>Awesome !  I just tried it works like a charm on OSX I did it with C++ instead of AngelScript .<br>\nCan someone help me to get this working on mobile for OpenGL ES 2.0 ?</p>", "post_number": 6, "post_type": 1, "updated_at": "2017-01-02T01:02:07.352Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 65, "readers_count": 64, "score": 13.0, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 151, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3741, "name": "", "username": "reattiva", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/b77776/{size}.png", "created_at": "2014-12-24T11:48:20.000Z", "cooked": "<p>[quote=\u201csabotage3d\u201d]Can someone help me to get this working on mobile for OpenGL ES 2.0 ?<br>\n[/quote]<br>\nI have no experience with OpenGL ES, but if you have a particular problem, post it here, there shouldn\u2019t be big differences. However keep in mind that the occlusion and blur shaders are very, very heavy especially on textures reading.</p>", "post_number": 7, "post_type": 1, "updated_at": "2017-01-02T01:02:09.588Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 1, "incoming_link_count": 0, "reads": 70, "readers_count": 69, "score": 14.0, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 72, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3779, "name": "", "username": "sabotage3d", "avatar_template": "/user_avatar/discourse.urho3d.io/sabotage3d/{size}/87_2.png", "created_at": "2014-12-26T22:44:39.000Z", "cooked": "<p>Thanks reattiva,</p>\n<p>I am trying to port it to Opengl ES 2.0, but I am having some problems.<br>\nI am getting these errors. If I try to fix any of these I am getting even deeper errors which are very weird. Any ideas ?</p>\n<p><code>2014-12-26 22:39:36.222 34_DynamicGeometry[26595:60b] Loading resource Shaders/GLSL/SAO_main.glsl\n2014-12-26 22:39:36.235 34_DynamicGeometry[26595:60b] Compiled vertex shader SAO_main()\n2014-12-26 22:39:36.238 34_DynamicGeometry[26595:60b] Failed to compile pixel shader SAO_main():\nERROR: 0:97: Use of undeclared identifier 'sDepthBuffer'\nERROR: 0:98: Use of undeclared identifier 'edC'\nERROR: 0:99: Use of undeclared identifier 'depthC'\nERROR: 0:116: Use of undeclared identifier 'vsC'\nERROR: 0:121: Use of undeclared identifier 'vsC'\nERROR: 0:145: Use of undeclared identifier 'vsC'\nERROR: 0:157: Use of undeclared identifier 'ssDiskRadius'\nERROR: 0:160: Use of undeclared identifier 'ssOffset'\nERROR: 0:163: Use of undeclared identifier 'sDepthBuffer'\nERROR: 0:163: Use of undeclared identifier 'ssP'\nERROR: 0:164: Use of undeclared identifier 'ssP'\nERROR: 0:164: Use of undeclared identifier 'depthP'\nERROR: 0:167: Use of undeclared identifier 'vsP'\nERROR: 0:167: Use of undeclared identifier 'vsC'\nERROR: 0:169: Use of undeclared identifier 'v'\nERROR: 0:169: Use of undeclared identifier 'v'\nERROR: 0:170: Use of undeclared identifier 'v'\nERROR: 0:177: Use of undeclared identifier 'vv'\nERROR: 0:178: Use of undeclared identifier 'f'\nERROR: 0:178: Use of undeclared identifier 'f'\nERROR: 0:178: Use of undeclared identifier 'f'\nERROR: 0:178: Use of undeclared identifier 'vn'\nERROR: 0:178: Use of undeclared identifier 'vv'\nERROR: 0:189: Use of undeclared identifier 'intensity'\nERROR: 0:204: Use of undeclared identifier 'occlusion'\nERROR: 0:204: Use of undeclared identifier 'edC'\n2014-12-26 22:39:36.239 34_DynamicGeometry[26595:60b] Loading resource Shaders/GLSL/BlurGaussianDepth.glsl\n2014-12-26 22:39:36.251 34_DynamicGeometry[26595:60b] Compiled vertex shader BlurGaussianDepth()\n2014-12-26 22:39:36.255 34_DynamicGeometry[26595:60b] Compiled pixel shader BlurGaussianDepth(SAMPLES=8)\n2014-12-26 22:39:36.258 34_DynamicGeometry[26595:60b] Linked vertex shader BlurGaussianDepth() and pixel shader BlurGaussianDepth(SAMPLES=8)\n2014-12-26 22:39:37.185 34_DynamicGeometry[26595:60b] Compiled pixel shader BlurGaussianDepth(SAMPLES=8 VERTICAL)\n2014-12-26 22:39:37.187 34_DynamicGeometry[26595:60b] Linked vertex shader BlurGaussianDepth() and pixel shader BlurGaussianDepth(SAMPLES=8 VERTICAL)\n2014-12-26 22:39:38.135 34_DynamicGeometry[26595:60b] Compiled vertex shader DeferredLight(DIRLIGHT)\n2014-12-26 22:39:38.136 34_DynamicGeometry[26595:60b] Shader DeferredLight(DIRLIGHT PERPIXEL SPECULAR) does not use the define PERPIXEL\n2014-12-26 22:39:38.139 34_DynamicGeometry[26595:60b] Failed to compile pixel shader DeferredLight(DIRLIGHT PERPIXEL SPECULAR):\nERROR: 0:599: Use of undeclared identifier 'sDepthBuffer'\nERROR: 0:603: Use of undeclared identifier 'depth'\nERROR: 0:605: Use of undeclared identifier 'sAlbedoBuffer'\nERROR: 0:606: Use of undeclared identifier 'sNormalBuffer'\nERROR: 0:618: Use of undeclared identifier 'normalInput'\nERROR: 0:619: Use of undeclared identifier 'worldPos'\nERROR: 0:623: Use of undeclared identifier 'normal'\nERROR: 0:623: Use of undeclared identifier 'worldPos'\nERROR: 0:640: Use of undeclared identifier 'normal'\nERROR: 0:640: Use of undeclared identifier 'worldPos'\nERROR: 0:640: Use of undeclared identifier 'normalInput'\nERROR: 0:641: Use of undeclared identifier 'diff'\nERROR: 0:641: Use of undeclared identifier 'albedoInput'\nERROR: 0:641: Use of undeclared identifier 'spec'\nERROR: 0:641: Use of undeclared identifier 'albedoInput'\n2014-12-26 22:39:38.424 34_DynamicGeometry[26595:60b] Loading resource Shaders/GLSL/SAO_copy.glsl\n2014-12-26 22:39:38.434 34_DynamicGeometry[26595:60b] Compiled vertex shader SAO_copy()\n2014-12-26 22:39:38.436 34_DynamicGeometry[26595:60b] Compiled pixel shader SAO_copy()\n2014-12-26 22:39:38.438 34_DynamicGeometry[26595:60b] Linked vertex shader SAO_copy() and pixel shader SAO_copy()</code></p>", "post_number": 8, "post_type": 1, "updated_at": "2017-01-02T01:02:12.728Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 68, "readers_count": 67, "score": 13.6, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 151, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3793, "name": "", "username": "reattiva", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/b77776/{size}.png", "created_at": "2014-12-27T17:04:06.000Z", "cooked": "<p>Sorry Sabotage, there are big differences. In ES the depth buffer, sDepthBuffer, is not defined, all your other errors are consequences. This is intended, you can clearly see it in the file \\Bin\\CoreData\\Shaders\\GLSL\\Samplers.glsl, the other g-buffers are not defined as well, so the deferred render path is not an option in ES.<br>\nYou can try to build the depth buffer yourself with the Depth.glsl shader and move to the forward render path, but I think a lightmap texture is a better and much cheaper way to have occlusion on mobile.</p>", "post_number": 9, "post_type": 1, "updated_at": "2017-01-02T01:02:13.837Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 3, "reads": 59, "readers_count": 58, "score": 26.8, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 72, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3794, "name": "", "username": "sabotage3d", "avatar_template": "/user_avatar/discourse.urho3d.io/sabotage3d/{size}/87_2.png", "created_at": "2014-12-27T18:41:15.000Z", "cooked": "<p>I think the OES_depth_texture extension would work.<br>\nIs it enough if I move the code from SAO main into single material assign it to all surfaces and swap sDepthBuffer for OES_depth_texture .<br>\nAs a first step is it possible to discard the Gaussian blur or any other deffered shaders ?<br>\nI already have lightmaps but for moving objects I need some interactive shadows and your solution is looking awesome.</p>", "post_number": 10, "post_type": 1, "updated_at": "2017-01-02T01:02:13.903Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 55, "readers_count": 54, "score": 11.0, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 151, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3795, "name": "", "username": "reattiva", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/b77776/{size}.png", "created_at": "2014-12-27T21:26:38.000Z", "cooked": "<p>I don\u2019t think the SAO will work if you move it in a technique. The SAO is like a post-process effect, it needs to work on a quad fullscreen, but if you are trying to limit the AO effect to only some objects then you have a point, but I don\u2019t know a good way to do it, maybe using the stencil?<br>\nYes, you can skip the blur and for sure you\u2019d better skip the deferred render path.</p>\n<p>For starters, use a simple scene (e.g. 04_StaticScene.as) and try switch it to the ForwardDepth.xml render path. See if you can get a good depth buffer written, you can view it by adding these lines at the end of the render path:</p>\n<p><code>    &lt;command type=\"quad\" tag=\"depth_copy\" vs=\"CopyFramebuffer\" ps=\"CopyFramebuffer\" output=\"viewport\"&gt;\n        &lt;texture unit=\"diffuse\" name=\"depth\" /&gt;\n    &lt;/command&gt;</code><br>\nIn OpenGL you \u2018\u2019\u2018should\u2019\u2019\u2019 be able to see it as a wonderful sawtooth of colors.</p>\n<p>In the forward path you don\u2019t have the normal buffer, but in the shader there is a \u201c<span class=\"hashtag\">#if</span> 1\u201d you can use to calculate the normal real-time, it is the part with the \u201cdxdf\u201d, unfortunately I think this instruction could be a problem for ES.</p>", "post_number": 11, "post_type": 1, "updated_at": "2017-01-02T01:02:13.977Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 61, "readers_count": 60, "score": 12.2, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 72, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3796, "name": "", "username": "sabotage3d", "avatar_template": "/user_avatar/discourse.urho3d.io/sabotage3d/{size}/87_2.png", "created_at": "2014-12-28T00:44:29.000Z", "cooked": "<p>Thanks again for helping me out.</p>\n<p>With the ForwardDepth.xml with your additions I am getting this:</p>\n<p>On OSX</p>\n<p><img src=\"http://i.imgur.com/YhtKHIb.png\" alt=\"\" width=\"399\" height=\"293\"></p>\n<p>On IOS</p>\n<p><img src=\"http://i.imgur.com/D5F6eMR.png\" alt=\"\" width=\"458\" height=\"300\"></p>\n<p>Is the result correct ?<br>\nIf am getting the same if I attach the Depth.glsl to my objects.<br>\nSo we can\u2019t bake the normals buffer to texture as well ?</p>\n<p>I am trying to add new uniforms for the depth to textures but it is very convoluted.<br>\nI have used that before for shadowmaps but I am not sure how to fit it with Urho3d or if it is already provided.<br>\nThe original code is taken from a book for OpenGL ES.</p>\n<p>[code]unsigned int depth_texture,<br>\nshadowmap_buffer,<br>\nshadowmap_width  = 128,<br>\nshadowmap_height = 256;</p>\n<p>\u2026</p>\n<p>glGenFramebuffers( 1, &amp;shadowmap_buffer );<br>\nglBindFramebuffer( GL_FRAMEBUFFER, shadowmap_buffer );</p>\n<p>glGenTextures( 1, &amp;depth_texture );<br>\nglBindTexture( GL_TEXTURE_2D, depth_texture );</p>\n<p>glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST );<br>\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST );</p>\n<p>glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE );<br>\nglTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE );</p>\n<p>glTexImage2D( GL_TEXTURE_2D,<br>\n0,<br>\nGL_DEPTH_COMPONENT,<br>\nshadowmap_width,<br>\nshadowmap_height,<br>\n0,<br>\nGL_DEPTH_COMPONENT,<br>\nGL_UNSIGNED_SHORT,<br>\nNULL );</p>\n<p>glBindTexture( GL_TEXTURE_2D, 0 );</p>\n<p>glFramebufferTexture2D( GL_FRAMEBUFFER,<br>\nGL_DEPTH_ATTACHMENT,<br>\nGL_TEXTURE_2D,<br>\ndepth_texture,<br>\n0 );</p>\n<p>\u2026</p>\n<p>glBindFramebuffer( GL_FRAMEBUFFER, shadowmap_buffer );</p>\n<p>glViewport( 0, 0, shadowmap_width, shadowmap_height );</p>\n<p>glClear( GL_DEPTH_BUFFER_BIT );</p>\n<p>glCullFace( GL_FRONT )</p>\n<p>\u2026</p>\n<p>glActiveTexture( GL_TEXTURE0 );<br>\nglBindTexture( GL_TEXTURE_2D, depth_texture );[/code]</p>", "post_number": 12, "post_type": 1, "updated_at": "2017-01-02T01:02:14.058Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 2, "reads": 59, "readers_count": 58, "score": 21.8, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 151, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3804, "name": "", "username": "sabotage3d", "avatar_template": "/user_avatar/discourse.urho3d.io/sabotage3d/{size}/87_2.png", "created_at": "2014-12-28T21:54:18.000Z", "cooked": "<p>I am having some difficulties applying your shader based on the ForwardDepth if I remove the code below from your DeferredSAO.xml it doesn\u2019't render at all.</p>\n<p><code>    &lt;command type=\"lightvolumes\" vs=\"DeferredLight\" ps=\"DeferredLight\"&gt;\n        &lt;texture unit=\"albedo\" name=\"albedo\" /&gt;\n        &lt;texture unit=\"normal\" name=\"normal\" /&gt;\n        &lt;texture unit=\"depth\" name=\"depth\" /&gt;\n    &lt;/command&gt;</code></p>\n<p>It is possible just to isolate this one for now without the need for any other shaders ?</p>\n<p><code>    &lt;command type=\"quad\" tag=\"SAO_main\" vs=\"SAO_main\" ps=\"SAO_main\" output=\"occlusion\"&gt;\n        &lt;texture unit=\"diffuse\" name=\"viewport\" /&gt;\n        &lt;texture unit=\"normal\" name=\"normal\" /&gt;\n        &lt;texture unit=\"depth\" name=\"depth\" /&gt;\n        &lt;parameter name=\"ProjInfo\" /&gt;\n        &lt;parameter name=\"ProjScale\" /&gt;\n        &lt;parameter name=\"View\" /&gt;\n        &lt;parameter name=\"Radius\" value=\"1.0\" /&gt;\n        &lt;parameter name=\"Bias\" value=\"0.01\" /&gt;\n        &lt;parameter name=\"ProjScale2\" value=\"1.0\" /&gt;\n        &lt;parameter name=\"IntensityDivR6\" value=\"1.0\" /&gt;\n    &lt;/command&gt;</code></p>", "post_number": 13, "post_type": 1, "updated_at": "2017-01-02T01:02:14.647Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 1, "reads": 54, "readers_count": 53, "score": 15.8, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 151, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3822, "name": "", "username": "reattiva", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/b77776/{size}.png", "created_at": "2014-12-29T23:04:09.000Z", "cooked": "<p>Download the repository now, I\u2019ve added a forward path example. In the angelscript example you have to change it from DeferredSAO.xml to ForwardDepthSAO.xml.<br>\nYour depth buffer looks good.</p>", "post_number": 14, "post_type": 1, "updated_at": "2017-01-02T01:02:15.982Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 50, "readers_count": 49, "score": 10.0, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 72, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3823, "name": "", "username": "sabotage3d", "avatar_template": "/user_avatar/discourse.urho3d.io/sabotage3d/{size}/87_2.png", "created_at": "2014-12-30T00:35:24.000Z", "cooked": "<p>Thanks a lot <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"><br>\nIt works perfectly, you saved me hours .<br>\nEarlier I tried all the combinations to get it the forward rendering working with your shader, but I couldn\u2019t figure it out.</p>", "post_number": 15, "post_type": 1, "updated_at": "2017-01-02T01:02:16.045Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 54, "readers_count": 53, "score": 10.8, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 151, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3833, "name": "", "username": "sabotage3d", "avatar_template": "/user_avatar/discourse.urho3d.io/sabotage3d/{size}/87_2.png", "created_at": "2014-12-30T13:36:27.000Z", "cooked": "<p>It seems that projecting on a quad doesn\u2019t work great under IOS or there is osmething that is not supported properly.<br>\nI am getting this result on IOS after fixing all the errors and warnings. Even setting float occlusion = 0.5;<br>\nI cannot get the 50% gray layer. Everything works perfectly under OSX.</p>\n<p>It seems that it displays the depth buffer rather than the diffuse + occlusion on top .</p>\n<p><img src=\"http://i.imgur.com/CgoWIBt.png\" alt=\"\" width=\"474\" height=\"301\"></p>", "post_number": 16, "post_type": 1, "updated_at": "2017-01-02T01:02:16.763Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 55, "readers_count": 54, "score": 11.0, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 151, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3840, "name": "", "username": "reattiva", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/b77776/{size}.png", "created_at": "2014-12-30T19:56:14.000Z", "cooked": "<p>No, that doesn\u2019t look good.<br>\nOne thing I forgot and you probably have already fixed it, on IOS you have to add \u201cuniform sampler2D sDepthBuffer;\u201d at the start of SAO_main.glsl, because the one in Samplers.glsl is skipped.<br>\nAbout dFdx and dFdy on ES, I\u2019ve found this <a href=\"https://www.khronos.org/opengles/sdk/docs/man31/html/dFdx.xhtml\" rel=\"nofollow noopener\">khronos.org/opengles/sdk/do \u2026 dFdx.xhtml</a>, so it is supported from ES GLSL v3.00. Maybe try adding (as first line) the directive \u201c<span class=\"hashtag\">#version</span> 300 es\u201d to be sure.</p>", "post_number": 17, "post_type": 1, "updated_at": "2017-01-02T01:02:17.314Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 56, "readers_count": 55, "score": 11.2, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "link_counts": [{"url": "https://www.khronos.org/opengles/sdk/docs/man31/html/dFdx.xhtml", "internal": false, "reflection": false, "clicks": 1}], "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 72, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3842, "name": "", "username": "sabotage3d", "avatar_template": "/user_avatar/discourse.urho3d.io/sabotage3d/{size}/87_2.png", "created_at": "2014-12-30T20:50:17.000Z", "cooked": "<p>I think the main problem at the moment is in the xml rather than the shader. Because I tried doing simple Gray color overlay using your ForwardDepthSAO.xml<br>\nIn SAO_main.glsl I am setting <span class=\"bbcode-b\">float occlusion = 0.5;</span>  When I try this under OSX I can see Gray overlay, but it doesn\u2019t work under IOS. On IOS it shows only the depth buffer so it means there is something weird that Urho3d does on the ES side.<br>\nAlso I tried this for the SAO_main.glsl : For the sDepthBuffer I am declaring it as: uniform sampler2D sDepthBuffer;  And for <span class=\"bbcode-b\">dFdx</span> and <span class=\"bbcode-b\">dFdy</span> I did this<span class=\"bbcode-b\"> <span class=\"hashtag\">#extension</span> GL_OES_standard_derivatives : enable</span> as mentioned from this link: <a href=\"http://stackoverflow.com/questions/9671705/opengl-es-2-0-derivative-texture\" rel=\"nofollow noopener\">stackoverflow.com/questions/9671 \u2026 ve-texture</a><br>\nI also set the precision to : <span class=\"bbcode-b\">precision highp float; </span><br>\nBecause it was complaining about the precision of the <span class=\"bbcode-b\">cFrustumSize</span></p>\n<p>Is there a native way just to render SAO_main on a quad  ?<br>\nIs it going to work in a single shader like surface shader ?</p>\n<p>Any ideas how to debug this are welcomed <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"></p>", "post_number": 18, "post_type": 1, "updated_at": "2017-01-02T01:02:17.459Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 58, "readers_count": 57, "score": 11.6, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "link_counts": [{"url": "http://stackoverflow.com/questions/9671705/opengl-es-2-0-derivative-texture", "internal": false, "reflection": false, "title": "iphone - OpenGL ES 2.0 Derivative Texture - Stack Overflow", "clicks": 1}], "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 151, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3843, "name": "", "username": "reattiva", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/b77776/{size}.png", "created_at": "2014-12-30T21:34:50.000Z", "cooked": "<p>This is where I can\u2019t help you further in ES.<br>\nAnyway, I didn\u2019t catch your question. SAO is rendered on a quad and it only needs the depth buffer. The only way to make it simpler is to save a depth buffer (the colors rainbow) to an image (png, tga \u2026) once, then you load it in the depth texture unit of the SAO.<br>\nDebugging a shader is a pain in the arse, you print everything on the screen step by step, buffer by buffer\u2026 maybe you should try to find a working AO shader for IOS and start from there.</p>", "post_number": 19, "post_type": 1, "updated_at": "2017-01-02T01:02:17.551Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 59, "readers_count": 58, "score": 11.8, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 72, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 3844, "name": "", "username": "sabotage3d", "avatar_template": "/user_avatar/discourse.urho3d.io/sabotage3d/{size}/87_2.png", "created_at": "2014-12-30T22:38:50.000Z", "cooked": "<p>Thanks a lot I will start from the basics again.</p>", "post_number": 20, "post_type": 1, "updated_at": "2017-01-02T01:02:17.633Z", "reply_count": 0, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 0, "reads": 58, "readers_count": 57, "score": 11.6, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 151, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 7174, "name": "", "username": "rasteron", "avatar_template": "/user_avatar/discourse.urho3d.io/rasteron/{size}/55_2.png", "created_at": "2015-08-13T03:23:59.000Z", "cooked": "<p>Hey guys, I\u2019m trying to add this to a sample game like NSW to test it out. I just need to load the default values without the controls and it doesn\u2019t seem to work.</p>\n<p>I loaded this values on top:</p>\n<p>[code]<br>\n// Number of steps in each controller (high = precise+slow)<br>\nconst float var_steps = 200.0f;</p>\n<p>// Enable ambient occlusion effect<br>\nbool ao_enable = true;<br>\n// Enable a simple Gaussian blur<br>\nbool ao_blur = false;<br>\n// Enable a depth aware Gaussian blur<br>\nbool ao_blurdepth = true;<br>\n// Show ambient occlusion raw values<br>\nbool ao_only = false;</p>\n<p>// uniforms format: Vector3[val, min, max]</p>\n<p>// AO radius in scene units<br>\nVector3 ao_radius = Vector3(1.0f, 0.0f, 4.0f);<br>\n// AO intensity (in the paper/demo is divided by radius^6, this is commented out)<br>\nVector3 ao_intensity = Vector3(0.15f, 0.0f, 2.0f);<br>\n// Radius scale adjust (not present in the paper/demo, TODO to be fixed)<br>\nVector3 ao_projscale = Vector3(0.3f, 0.0f, 1.0f);<br>\n// Self occlusion margin<br>\nVector3 ao_bias = Vector3(0.01f, 0.0f, 0.1f);<br>\n// Aux vars<br>\nVector3 ao_var1 = Vector3(0.0f, -1.0f, 1.0f);<br>\nVector3 ao_var2 = Vector3(1.0f, 0.0f, 1.0f);[/code]</p>\n<p>Then in the setup viewport, I added this:</p>\n<pre><code class=\"lang-auto\">effectRenderPath.Append( cache.GetResource(\"XMLFile\", \"RenderPaths/DeferredSAO.xml\") );\neffectRenderPath.SetEnabled(\"SAO_copy\", ao_enable);\neffectRenderPath.SetEnabled(\"BlurGaussian\", ao_blur);\neffectRenderPath.SetEnabled(\"BlurGaussianDepth\", ao_blurdepth);\neffectRenderPath.shaderParameters[\"Radius\"] = Variant(ao_radius.x);\neffectRenderPath.shaderParameters[\"ProjScale2\"] = Variant(ao_projscale.x);\neffectRenderPath.shaderParameters[\"IntensityDivR6\"] = Variant( ao_intensity.x );\neffectRenderPath.shaderParameters[\"Bias\"] = Variant(ao_bias.x);        \neffectRenderPath.shaderParameters[\"Var1\"] = Variant(ao_var1.x);\neffectRenderPath.shaderParameters[\"Var2\"] = Variant(ao_var2.x);</code></pre>\n<p>I\u2019m using other effects such as Bloom, etc. Any ideas on how to get this to work? Thanks! <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"></p>", "post_number": 21, "post_type": 1, "updated_at": "2017-01-02T01:06:26.504Z", "reply_count": 1, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 2, "reads": 59, "readers_count": 58, "score": 26.8, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 54, "hidden": false, "trust_level": 2, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}, {"id": 23690, "name": "Harrison", "username": "hvince95", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/h/a87d85/{size}.png", "created_at": "2018-03-17T06:16:35.070Z", "cooked": "<p>If you\u2019re still around lol, I had issues when using this with bloom, to solve the problem you need to append the deferredSAO BEFORE you append bloom fxaa2 etc.<br>\nProblem is then that multisampling doesnt seem to work anymore. I solved this issue by using the ForwardDepthSAO.xml renderpath. except now I seem to get random crashes every now and then <img src=\"https://emoji.discourse-cdn.com/twitter/frowning.png?v=5\" title=\":frowning:\" class=\"emoji\" alt=\":frowning:\"> Beyone the fact that ForwardDepthSAO is causing  the issue, I have no idea what is wrong!<br>\nIf anyone has any thoughts it would be appreciated!</p>", "post_number": 22, "post_type": 1, "updated_at": "2018-03-17T06:16:35.070Z", "reply_count": 0, "reply_to_post_number": 21, "quote_count": 0, "incoming_link_count": 4, "reads": 48, "readers_count": 47, "score": 29.6, "yours": false, "topic_id": 662, "topic_slug": "alchemy-ambient-occlusion", "display_username": "Harrison", "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_bg_color": null, "flair_color": null, "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_wiki": false, "read": true, "user_title": null, "reply_to_user": {"username": "rasteron", "name": "", "avatar_template": "/user_avatar/discourse.urho3d.io/rasteron/{size}/55_2.png"}, "bookmarked": false, "actions_summary": [], "moderator": false, "admin": false, "staff": false, "user_id": 939, "hidden": false, "trust_level": 1, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false}], "stream": [3586, 3591, 3592, 3603, 3612, 3712, 3741, 3779, 3793, 3794, 3795, 3796, 3804, 3822, 3823, 3833, 3840, 3842, 3843, 3844, 7174, 23690]}, "timeline_lookup": [[1, 2902], [4, 2901], [6, 2894], [7, 2891], [8, 2888], [9, 2887], [13, 2886], [14, 2885], [17, 2884], [21, 2659], [22, 1712]], "tags_descriptions": {}, "id": 662, "title": "Alchemy ambient occlusion", "fancy_title": "Alchemy ambient occlusion", "posts_count": 22, "created_at": "2014-12-12T20:10:16.000Z", "views": 2900, "reply_count": 1, "like_count": 1, "last_posted_at": "2018-03-17T06:16:35.070Z", "visible": true, "closed": false, "archived": false, "has_summary": false, "archetype": "regular", "slug": "alchemy-ambient-occlusion", "category_id": 13, "word_count": 3172, "deleted_at": null, "user_id": 72, "featured_link": null, "pinned_globally": false, "pinned_at": null, "pinned_until": null, "image_url": null, "slow_mode_seconds": 0, "draft": null, "draft_key": "topic_662", "draft_sequence": null, "unpinned": null, "pinned": false, "current_post_number": 1, "highest_post_number": 22, "deleted_by": null, "actions_summary": [{"id": 4, "count": 0, "hidden": false, "can_act": false}, {"id": 8, "count": 0, "hidden": false, "can_act": false}, {"id": 7, "count": 0, "hidden": false, "can_act": false}], "chunk_size": 20, "bookmarked": false, "bookmarks": [], "topic_timer": null, "message_bus_last_id": 0, "participant_count": 6, "show_read_indicator": false, "thumbnails": null, "slow_mode_enabled_until": null, "tags_disable_ads": false, "details": {"can_edit": false, "notification_level": 1, "participants": [{"id": 151, "username": "sabotage3d", "name": "", "avatar_template": "/user_avatar/discourse.urho3d.io/sabotage3d/{size}/87_2.png", "post_count": 9, "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_color": null, "flair_bg_color": null, "trust_level": 2}, {"id": 72, "username": "reattiva", "name": "", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/b77776/{size}.png", "post_count": 8, "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_color": null, "flair_bg_color": null, "trust_level": 2}, {"id": 36, "username": "alexrass", "name": "", "avatar_template": "/user_avatar/discourse.urho3d.io/alexrass/{size}/1036_2.png", "post_count": 2, "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_color": null, "flair_bg_color": null, "trust_level": 1}, {"id": 54, "username": "rasteron", "name": "", "avatar_template": "/user_avatar/discourse.urho3d.io/rasteron/{size}/55_2.png", "post_count": 1, "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_color": null, "flair_bg_color": null, "trust_level": 2}, {"id": 148, "username": "codingmonkey", "name": "", "avatar_template": "/user_avatar/discourse.urho3d.io/codingmonkey/{size}/119_2.png", "post_count": 1, "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_color": null, "flair_bg_color": null, "trust_level": 2}, {"id": 939, "username": "hvince95", "name": "Harrison", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/h/a87d85/{size}.png", "post_count": 1, "primary_group_name": null, "flair_name": null, "flair_url": null, "flair_color": null, "flair_bg_color": null, "trust_level": 1}], "created_by": {"id": 72, "username": "reattiva", "name": "", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/b77776/{size}.png"}, "last_poster": {"id": 939, "username": "hvince95", "name": "Harrison", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/h/a87d85/{size}.png"}, "links": [{"url": "https://bitbucket.org/reattiva/sao-as/downloads", "title": "reattiva / SAO-AS / Downloads \u2014 Bitbucket", "internal": false, "attachment": false, "reflection": false, "clicks": 133, "user_id": 72, "domain": "bitbucket.org", "root_domain": "bitbucket.org"}, {"url": "http://postimg.org/image/4tqdy5v77/", "title": "ao \u2014 Postimage.org", "internal": false, "attachment": false, "reflection": false, "clicks": 85, "user_id": 72, "domain": "postimg.org", "root_domain": "postimg.org"}, {"url": "http://graphics.cs.williams.edu/papers/AlchemyHPG11/", "title": "The Alchemy Screen-Space Ambient Obscurance Algorithm", "internal": false, "attachment": false, "reflection": false, "clicks": 73, "user_id": 72, "domain": "graphics.cs.williams.edu", "root_domain": "williams.edu"}, {"url": "http://graphics.cs.williams.edu/papers/SAOHPG12/", "title": "Scalable Ambient Obscurance", "internal": false, "attachment": false, "reflection": false, "clicks": 29, "user_id": 72, "domain": "graphics.cs.williams.edu", "root_domain": "williams.edu"}, {"url": "http://discourse.urho3d.io/t/ssdo-or-ssao-examples/3706/3", "title": "SSDO or SSAO examples?", "internal": true, "attachment": false, "reflection": true, "clicks": 13, "user_id": 148, "domain": "discourse.urho3d.io", "root_domain": "urho3d.io"}, {"url": "https://www.opengl.org/registry/specs/EXT/gpu_shader4.txt", "title": null, "internal": false, "attachment": false, "reflection": false, "clicks": 6, "user_id": 72, "domain": "www.opengl.org", "root_domain": "opengl.org"}, {"url": "https://discourse.urho3d.io/t/can-you-make-more-cute-graphics-with-urho3d/4062/4", "title": "Can you make more \"cute\" graphics with Urho3D?", "internal": true, "attachment": false, "reflection": true, "clicks": 2, "user_id": 21, "domain": "discourse.urho3d.io", "root_domain": "urho3d.io"}, {"url": "https://discourse.urho3d.io/t/sao-implementation-errors/4097", "title": "SAO implementation errors", "internal": true, "attachment": false, "reflection": true, "clicks": 2, "user_id": 939, "domain": "discourse.urho3d.io", "root_domain": "urho3d.io"}, {"url": "http://stackoverflow.com/questions/9671705/opengl-es-2-0-derivative-texture", "title": "iphone - OpenGL ES 2.0 Derivative Texture - Stack Overflow", "internal": false, "attachment": false, "reflection": false, "clicks": 1, "user_id": 151, "domain": "stackoverflow.com", "root_domain": "stackoverflow.com"}, {"url": "https://www.khronos.org/opengles/sdk/docs/man31/html/dFdx.xhtml", "title": null, "internal": false, "attachment": false, "reflection": false, "clicks": 1, "user_id": 72, "domain": "www.khronos.org", "root_domain": "khronos.org"}, {"url": "http://discourse.urho3d.io/t/some-nice-assets-to-make-an-urho3d-demo-from/3704/15", "title": "Some nice assets to make an Urho3D demo from", "internal": true, "attachment": false, "reflection": true, "clicks": 1, "user_id": 21, "domain": "discourse.urho3d.io", "root_domain": "urho3d.io"}]}, "suggested_topics": [{"id": 7103, "title": ":test_tube: DebugRenderer as GUI", "fancy_title": ":test_tube: DebugRenderer as GUI", "slug": "debugrenderer-as-gui", "posts_count": 4, "reply_count": 1, "highest_post_number": 4, "image_url": null, "created_at": "2021-12-17T02:25:06.606Z", "last_posted_at": "2021-12-18T01:09:27.738Z", "bumped": true, "bumped_at": "2021-12-18T01:09:27.738Z", "archetype": "regular", "unseen": false, "pinned": false, "unpinned": null, "visible": true, "closed": false, "archived": false, "bookmarked": null, "liked": null, "unicode_title": "\ud83e\uddea DebugRenderer as GUI", "tags_descriptions": {}, "like_count": 4, "views": 267, "category_id": 13, "featured_link": null, "has_accepted_answer": false, "posters": [{"extras": "latest", "description": "Original Poster, Most Recent Poster", "user": {"id": 192, "username": "Modanung", "name": "\u9b54\u5927\u519c \ud835\udf8d\ud835\udf8e\ud835\udf73 \u73fe\u62db\u870d", "avatar_template": "/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}, {"extras": null, "description": "Frequent Poster", "user": {"id": 861, "username": "GodMan", "name": "", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]}, {"id": 7110, "title": "Resource fetch define", "fancy_title": "Resource fetch define", "slug": "resource-fetch-define", "posts_count": 2, "reply_count": 0, "highest_post_number": 2, "image_url": null, "created_at": "2021-12-27T12:28:55.126Z", "last_posted_at": "2021-12-27T17:00:37.699Z", "bumped": true, "bumped_at": "2021-12-27T17:00:37.699Z", "archetype": "regular", "unseen": false, "pinned": false, "unpinned": null, "visible": true, "closed": false, "archived": false, "bookmarked": null, "liked": null, "tags_descriptions": {}, "like_count": 7, "views": 184, "category_id": 13, "featured_link": null, "has_accepted_answer": false, "posters": [{"extras": null, "description": "Original Poster", "user": {"id": 192, "username": "Modanung", "name": "\u9b54\u5927\u519c \ud835\udf8d\ud835\udf8e\ud835\udf73 \u73fe\u62db\u870d", "avatar_template": "/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}, {"extras": "latest", "description": "Most Recent Poster", "user": {"id": 1304, "username": "lebrewer", "name": "lebrewer", "avatar_template": "/user_avatar/discourse.urho3d.io/lebrewer/{size}/2811_2.png"}}]}, {"id": 7120, "title": "Log Error Once Macro", "fancy_title": "Log Error Once Macro", "slug": "log-error-once-macro", "posts_count": 1, "reply_count": 0, "highest_post_number": 1, "image_url": null, "created_at": "2022-01-04T02:24:37.857Z", "last_posted_at": "2022-01-04T02:24:37.925Z", "bumped": true, "bumped_at": "2022-01-04T02:24:37.925Z", "archetype": "regular", "unseen": false, "pinned": false, "unpinned": null, "visible": true, "closed": false, "archived": false, "bookmarked": null, "liked": null, "tags_descriptions": {}, "like_count": 3, "views": 143, "category_id": 13, "featured_link": null, "has_accepted_answer": false, "posters": [{"extras": "latest single", "description": "Original Poster, Most Recent Poster", "user": {"id": 628, "username": "SirNate0", "name": "SirNate0", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]}, {"id": 7099, "title": ":fallen_leaf: Polynomials & Harmonics", "fancy_title": ":fallen_leaf: Polynomials &amp; Harmonics", "slug": "polynomials-harmonics", "posts_count": 6, "reply_count": 0, "highest_post_number": 7, "image_url": null, "created_at": "2021-12-13T05:06:04.641Z", "last_posted_at": "2021-12-27T23:27:39.489Z", "bumped": true, "bumped_at": "2021-12-27T23:27:39.489Z", "archetype": "regular", "unseen": false, "pinned": false, "unpinned": null, "visible": true, "closed": false, "archived": false, "bookmarked": null, "liked": null, "unicode_title": "\ud83c\udf42 Polynomials & Harmonics", "tags_descriptions": {}, "like_count": 6, "views": 392, "category_id": 13, "featured_link": null, "has_accepted_answer": false, "posters": [{"extras": "latest single", "description": "Original Poster, Most Recent Poster", "user": {"id": 192, "username": "Modanung", "name": "\u9b54\u5927\u519c \ud835\udf8d\ud835\udf8e\ud835\udf73 \u73fe\u62db\u870d", "avatar_template": "/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}]}, {"id": 7347, "title": "How does Urho handle script objects each frame?", "fancy_title": "How does Urho handle script objects each frame?", "slug": "how-does-urho-handle-script-objects-each-frame", "posts_count": 3, "reply_count": 1, "highest_post_number": 3, "image_url": null, "created_at": "2022-11-08T02:33:56.461Z", "last_posted_at": "2022-11-08T14:46:09.857Z", "bumped": true, "bumped_at": "2022-11-08T14:46:09.857Z", "archetype": "regular", "unseen": false, "pinned": false, "unpinned": null, "visible": true, "closed": false, "archived": false, "bookmarked": null, "liked": null, "tags_descriptions": {}, "like_count": 0, "views": 64, "category_id": 9, "featured_link": null, "has_accepted_answer": false, "posters": [{"extras": "latest", "description": "Original Poster, Most Recent Poster", "user": {"id": 1292, "username": "evolgames", "name": "evol", "avatar_template": "/user_avatar/discourse.urho3d.io/evolgames/{size}/3169_2.png"}}, {"extras": null, "description": "Frequent Poster", "user": {"id": 628, "username": "SirNate0", "name": "SirNate0", "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]}]}