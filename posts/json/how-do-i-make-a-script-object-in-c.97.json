{"post_stream":{"posts":[{"id":417,"name":"","username":"GIMB4L","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/ba8739/{size}.png","created_at":"2014-02-13T18:21:59.000Z","cooked":"\u003cp\u003eSay I have a manager, and on a certain function call, I want to create an object on the C++ side, and return a pointer to script. It’s fairly straightforward, but I ran into one hitch – all script objects must inherit from Object which has Context as a parameter.\u003c/p\u003e\n\u003cp\u003eSo when I tried to create a script object C++ side, I just called this-\u0026gt;GetContext() and passed that context into the constructor of the new script object. I found out later that the object I created was promptly destroyed, which is probably due to context.\u003c/p\u003e\n\u003cp\u003eWhat’s the proper way to make a script object C++ side?\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2017-01-02T00:57:58.089Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":377,"reads":49,"readers_count":48,"score":1894.8,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":26,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":418,"name":"","username":"Azalrion","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/f04885/{size}.png","created_at":"2014-02-13T18:25:04.000Z","cooked":"\u003cp\u003eThey don’t inherit from Object they inherit from ScriptObject. When instantiated from the C++ side you should be using ScriptFile or ScriptInstance to instantiate the ScriptObjects. ScriptFiles are used for non-component Script Objects and Global Script Functions, and ScriptInstances are components that need to be added to a node.\u003c/p\u003e\n\u003cp\u003eSo your script class would look like:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eclass Foo : ScriptObject\n{\n}\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eAnd you’d use the following methods to instantiate and execute it:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e    asIScriptObject* ScriptFile::CreateObject(const String\u0026amp; className);\n    bool ScriptFile::Execute(asIScriptObject* object, const String\u0026amp; declaration, const VariantVector\u0026amp; parameters = Variant::emptyVariantVector, bool unprepare = true);\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e    bool ScriptInstance::CreateObject(ScriptFile* scriptFile, const String\u0026amp; className);\n    bool ScriptInstance::Execute(const String\u0026amp; declaration, const VariantVector\u0026amp; parameters = Variant::emptyVariantVector); //Optional ScriptInstance runs certain methods on start-up.\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eMore details can be found here: \u003ca href=\"http://urho3d.github.io/documentation/a00016.html\" rel=\"nofollow noopener\"\u003eurho3d.github.io/documentation/a00016.html\u003c/a\u003e\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-01-02T00:57:58.149Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":6,"reads":49,"readers_count":48,"score":39.8,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"http://urho3d.github.io/documentation/a00016.html","internal":false,"reflection":false,"clicks":45}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":8,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":420,"name":"","username":"GIMB4L","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/ba8739/{size}.png","created_at":"2014-02-13T22:52:33.000Z","cooked":"\u003cp\u003eGot it, thanks.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2017-01-02T00:57:58.328Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":3,"reads":44,"readers_count":43,"score":23.8,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":26,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":421,"name":"","username":"GIMB4L","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/ba8739/{size}.png","created_at":"2014-02-13T22:58:36.000Z","cooked":"\u003cp\u003eWAIT\u003c/p\u003e\n\u003cp\u003eI think we’re mistaken.\u003c/p\u003e\n\u003cp\u003eI have a class I have defined in C++. It inherits from Urho3D::Object. I want to be able to make instances of this C++ side, and pass them back to script. That’s where I was having the context issue above.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2017-01-02T00:57:58.394Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":4,"reads":41,"readers_count":40,"score":28.2,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":26,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":422,"name":"Yao Wei Tjong","username":"weitjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png","created_at":"2014-02-14T04:51:04.000Z","cooked":"\u003cp\u003eI believe Alex has pointed you to the right direction. If you must declare your script object from C++ side instead of from script, I think what you need to do is to derive your component not from Urho3D::Object class but from Urho3D::ScriptInstance class. After creating the component object and attaching it to a node, your C++ function should be able to safely return a pointer to it to your script. I think in your script, you can also get script object back by using Node::GetScriptObject() API call. However, if what you are trying to achieve is an arbitrary object (i.e. not derived from Component class), so it cannot be attached to a node then I think you need to call AddRef() somewhere in your C++ function before returning that script object back to your script. And then you have to think of when is the appropriate time to decrease the reference count so your object would be destroyed in a timely manner.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2017-01-02T00:57:58.452Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":3,"reads":34,"readers_count":33,"score":21.8,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"Yao Wei Tjong","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Admin","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":4,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":423,"name":"","username":"Azalrion","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/f04885/{size}.png","created_at":"2014-02-14T05:45:28.000Z","cooked":"\u003cp\u003eIf you want classes defined in C++ usable in a script you need to also bind them to angelscript like Urho does in all the …API.cpp files even if it does inherit from object as otherwise none of your custom methods will be available.\u003c/p\u003e\n\u003cp\u003eAs for the deletion issue its probably being deleted as Weitjong says there is only a single reference and when your function falls out of scope its being deleted as I dont believe passing it to a script as part of the parameters adds a new reference as it treats it as a raw pointer and since it was created on the c++ side you need to do your lifecycle management there.\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2017-01-02T00:57:58.516Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":32,"readers_count":31,"score":6.4,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":8,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":424,"name":"","username":"GIMB4L","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/ba8739/{size}.png","created_at":"2014-02-14T06:08:38.000Z","cooked":"\u003cp\u003eAh, that makes sense. Thanks guys!\u003c/p\u003e","post_number":7,"post_type":1,"updated_at":"2017-01-02T00:57:58.575Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":30,"readers_count":29,"score":6.0,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":26,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":932,"name":"","username":"gasp","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/0ea827/{size}.png","created_at":"2014-03-27T19:40:01.000Z","cooked":"\u003cp\u003ei am trying to do exactly this :\u003cbr\u003e\n\u003cspan class=\"bbcode-b\"\u003e“If you want classes defined in C++ usable in a script you need to also bind them to angelscript like Urho does in all the …API.cpp files even if it does inherit from object as otherwise none of your custom methods will be available.”\u003c/span\u003e\u003c/p\u003e\n\u003cp\u003ei’ve created a “SimpleMath” class (h \u0026amp; cpp)\u003cbr\u003e\nonly 1 member “int  DoubleTheValue(int value);” who do a wonderfull :\u003c/p\u003e\n\u003caside class=\"quote\"\u003e\n\u003cblockquote\u003e\n\u003cp\u003eint  SimpleMath::DoubleTheValue(int value)\u003cbr\u003e\n{\u003cbr\u003e\nreturn value * 2 ;\u003cbr\u003e\n}\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eall compile fine, and the class work in the main cpp file\u003c/p\u003e\n\u003cp\u003eIn the main program (base on Urho3DPlayer.cpp) i’ve try the folowwing things :\u003c/p\u003e\n\u003cp\u003eMy goal is to be able to call the “RegisterObjectMethod” Angel Script part who register the function for the script, somethings like :\u003c/p\u003e\n\u003caside class=\"quote\"\u003e\n\u003cblockquote\u003e\n\u003cp\u003eengine-\u0026gt;RegisterObjectMethod(“SimpleMath”, “int  SimpleMath::DoubleTheValue(int value)”, asMETHOD(SimpleMath, DoubleTheValue), asCALL_THISCALL);\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003ethe tricky part for me now is to be able to acces the engins script, like all the *API.cpp.\u003c/p\u003e\n\u003cp\u003ei’ve try something like that :\u003c/p\u003e\n\u003caside class=\"quote\"\u003e\n\u003cblockquote\u003e\n\u003cp\u003eScript *asEngine;\u003cbr\u003e\ncontext_-\u0026gt;RegisterSubsystem(asEngine=new Script(context_));\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003ebut … i must miss something \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/confused.png?v=5\" title=\":confused:\" class=\"emoji\" alt=\":confused:\"\u003e\u003c/p\u003e\n\u003caside class=\"quote\"\u003e\n\u003cblockquote\u003e\n\u003cp\u003easIScriptEngine* ScriptEngine=context_-\u0026gt;GetSubsystem();\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003edoesn\"t work too …\u003cbr\u003e\ni’ve looking in the engine part where you register angel script part, nothing inherit, it ssem to be in the register script the trick to grab the Angel SCript instance to register it\u003c/p\u003e\n\u003cp\u003ei learn stuff but always somethings block me\u003c/p\u003e","post_number":8,"post_type":1,"updated_at":"2017-01-02T00:58:35.813Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":30,"readers_count":29,"score":6.0,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":62,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":933,"name":"Lasse Öörni","username":"cadaver","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","created_at":"2014-03-27T20:39:47.000Z","cooked":"\u003cp\u003eYou get the asIScriptEngine pointer from the Script subsystem.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e    asIScriptEngine* engine = GetSubsystem\u0026lt;Script\u0026gt;()-\u0026gt;GetScriptEngine();\u003c/code\u003e\u003c/pre\u003e","post_number":9,"post_type":1,"updated_at":"2017-01-02T00:58:35.895Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":25,"readers_count":24,"score":5.0,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"Lasse Öörni","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Urho3D Author","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":true,"staff":true,"user_id":3,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":935,"name":"","username":"gasp","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/0ea827/{size}.png","created_at":"2014-03-27T21:08:38.000Z","cooked":"\u003cp\u003ethank you for the information, i get the following error :\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003eD:\\Developpement\\testProject\\Source\\Urho3DPlayer.cpp:116:15: error: invalid use of incomplete type 'class asIScriptEngine'\n         engine-\u0026gt;RegisterObjectMethod(\"SimpleMath\", \"int  SimpleMath::DoubleTheValue(int value)\", asMETHOD(SimpleMath, DoubleTheValue), asCALL_THISCALL);\n               ^\nIn file included from D:\\Developpement\\testProject\\Source\\Urho3DPlayer.cpp:32:0:\nD:/Developpement/Urho3D/Source/Engine/Script/ScriptFile.h:31:7: error: forward declaration of 'class asIScriptEngine'\n class asIScriptEngine;\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003emy code :\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003evoid Urho3DPlayer::Start()\n{\n\n#ifdef ENABLE_ANGELSCRIPT\n        // Instantiate and register the AngelScript subsystem\n        context_-\u0026gt;RegisterSubsystem(new Script(context_));\n        asIScriptEngine* engine = GetSubsystem\u0026lt;Script\u0026gt;()-\u0026gt;GetScriptEngine();\n        engine-\u0026gt;RegisterObjectMethod(\"SimpleMath\", \"int  SimpleMath::DoubleTheValue(int value)\", asMETHOD(SimpleMath, DoubleTheValue), asCALL_THISCALL);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ei regulary from all my test get \"error: invalid use of incomplete type ‘class asIScriptEngine’ \"\u003c/p\u003e","post_number":10,"post_type":1,"updated_at":"2017-01-02T00:58:36.034Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":26,"readers_count":25,"score":5.2,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":62,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":936,"name":"","username":"GIMB4L","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/ba8739/{size}.png","created_at":"2014-03-27T21:54:11.000Z","cooked":"\u003cp\u003eYou need to include the angelscript header file, or some other header which includes it.\u003c/p\u003e","post_number":11,"post_type":1,"updated_at":"2017-01-02T00:58:36.096Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":23,"readers_count":22,"score":9.6,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":26,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":939,"name":"","username":"gasp","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/0ea827/{size}.png","created_at":"2014-03-28T06:14:42.000Z","cooked":"\u003cp\u003ethanks you, it work, what i’ve done :\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\n#include \u0026lt;angelscript.h\u0026gt;\n\nString doubleTheNumber (int t){\n        char buff[32];\n        sprintf(buff, \"%d\", t*2);   // int =\u0026gt; Char\n        String ss(buff);\nreturn ss;\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn the “void Urho3DPlayer::Start()” function :\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e#ifdef ENABLE_ANGELSCRIPT\n        // Instantiate and register the AngelScript subsystem\n        context_-\u0026gt;RegisterSubsystem(new Script(context_));\n        asIScriptEngine* engine = GetSubsystem\u0026lt;Script\u0026gt;()-\u0026gt;GetScriptEngine();\n        engine-\u0026gt;RegisterGlobalFunction(\"String doubleTheNumber (int t)\", asFUNCTION(doubleTheNumber), asCALL_CDECL);\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eand in the .as script :\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003ePrint(testFunt(10));\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e(next part is doing in the same with a class :p)\u003cbr\u003e\nand you get 20 in the console \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/stuck_out_tongue.png?v=5\" title=\":stuck_out_tongue:\" class=\"emoji\" alt=\":stuck_out_tongue:\"\u003e\u003c/p\u003e","post_number":12,"post_type":1,"updated_at":"2017-01-02T00:58:36.282Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":24,"readers_count":23,"score":4.8,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":62,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":940,"name":"","username":"Azalrion","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/f04885/{size}.png","created_at":"2014-03-28T07:02:51.000Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"GIMB4L\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://avatars.discourse-cdn.com/v4/letter/g/ba8739/40.png\" class=\"avatar\"\u003e GIMB4L:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eYou need to include the angelscript header file, or some other header which includes it.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eJust for the record so no one goes searching the angelscript.h file isn’t included by the engine in any header files, its forward decl’d and included in the cpp files.\u003c/p\u003e","post_number":13,"post_type":1,"updated_at":"2017-01-02T00:58:36.350Z","reply_count":0,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":0,"reads":21,"readers_count":20,"score":4.2,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":8,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":959,"name":"","username":"gasp","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/0ea827/{size}.png","created_at":"2014-03-29T09:22:33.000Z","cooked":"\u003cp\u003eUsing a methode of a c++ class  in an Uhro3D angel script :\u003cbr\u003e\n1st we create a sample class (.cpp \u0026amp; .h)\u003cbr\u003e\n\u003cspan class=\"bbcode-u\"\u003eSimpleMath.cpp:\u003c/span\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\n#include \"SimpleMath.h\"\n\nvoid SimpleMath::testSanRien(){\nint i;\ni=i+1;\n}\n\n//Double the Value !!!\nUrho3D::String  SimpleMath::DoubleTheValue(int value)\n{\n  char buff[32];\n  sprintf(buff, \"%d\", value*2);   // int =\u0026gt; Char\n  Urho3D::String ss(buff);\nreturn ss;\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cspan class=\"bbcode-u\"\u003eSimpleMath.h file :\u003c/span\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\n\n\nclass SimpleMath\n{\npublic:\n    Urho3D::String DoubleTheValue(int value);\n    void testSanRien();\nprivate:\n    int myPrivateValueNotUsedForNow(0);\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003enow in you’r \u003cspan class=\"bbcode-u\"\u003emain.cpp\u003c/span\u003e file :\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e...\n\n#include \u0026lt;angelscript.h\u0026gt;\n#include \"SimpleMath.h\"\n...\nvoid Urho3DPlayer::Start()\n{\n    int r(0);\n        // Instantiate and register the AngelScript subsystem\n        context_-\u0026gt;RegisterSubsystem(new Script(context_));\n        asIScriptEngine* engine = GetSubsystem\u0026lt;Script\u0026gt;()-\u0026gt;GetScriptEngine();\n            //Register a global function\n        engine-\u0026gt;RegisterGlobalFunction(\"String doubleTheNumber (int t)\", asFUNCTION(doubleTheNumber), asCALL_CDECL);\n        assert( r \u0026gt;= 0 );\n            // Registering the type \"simplemath\"\n        engine-\u0026gt;RegisterObjectType(\"simplemath\", sizeof(SimpleMath), asOBJ_VALUE | asOBJ_POD | asOBJ_APP_CLASS_CAK);\n        assert( r \u0026gt;= 0 );\n            // Registering without argument\n        engine-\u0026gt;RegisterObjectMethod(\"simplemath\", \"void testSanRien()\", asMETHOD(SimpleMath,testSanRien), asCALL_THISCALL);\n        assert( r \u0026gt;= 0 );\n            //With arguments\n        engine-\u0026gt;RegisterObjectMethod(\"simplemath\", \"String DoubleTheValue(int value)\",asMETHODPR(SimpleMath, DoubleTheValue,(int),String), asCALL_THISCALL);\n        assert( r \u0026gt;= 0 );\n\n...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eand lastly in you’r .as scripts :\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\t\t//Global Function\n\tPrint(doubleTheNumber (10));\n\t\t//With a class\n\tsimplemath veryComplexMath;\n\t\t//Testing the value\n\tPrint(veryComplexMath.DoubleTheValue(33));\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow you can see the result in the console “20” and “66”.\u003c/p\u003e\n\u003cp\u003ehope this had help someone, and i’ve not make alot of mistake\u003c/p\u003e","post_number":14,"post_type":1,"updated_at":"2017-01-02T00:58:38.428Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":4,"reads":23,"readers_count":22,"score":24.6,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":62,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":963,"name":"","username":"Azalrion","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/f04885/{size}.png","created_at":"2014-03-29T13:31:43.000Z","cooked":"\u003cp\u003eJust be careful there you aren’t actually assigning r to the return values of the angelscript binding calls and its not initialized so that assert would run all kinds of crazy on some compilers.\u003c/p\u003e\n\u003cp\u003eWhen binding simplemath you’ve used sizeof(StringHash) that should be sizeof(SimpleMath), it might not make a difference since we don’t use AS garbage collector, I haven’t looked to see the implications of the size specifications in the bindings.\u003c/p\u003e\n\u003cp\u003easOBJ_POD you need to be careful with as well when declaring object types , it should only be used If the type doesn’t require any special treatment, i.e. doesn’t contain any pointers or other resource references that must be maintained.\u003c/p\u003e\n\u003cp\u003eOtherwise that it looks good, (oh you did copy the .cpp code instead of the header code into the simplemath.h example).\u003c/p\u003e","post_number":15,"post_type":1,"updated_at":"2017-01-02T00:58:38.759Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":22,"readers_count":21,"score":4.4,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":8,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":970,"name":"","username":"gasp","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/0ea827/{size}.png","created_at":"2014-03-30T08:50:09.000Z","cooked":"\u003cp\u003ethanks for all the remark, very instructive, once all i clear i will correct my post for reference\u003c/p\u003e\n\u003cp\u003eWhen declaring type “asOBJ_POD” seem to be medatory, if i don’t set it i get :\u003c/p\u003e\n\u003caside class=\"quote\"\u003e\n\u003cblockquote\u003e\n\u003cp\u003e“SimpleMath is missing behaviours”\u003cbr\u003e\n“Invalid configuration. Verify the registered application interface\u003cbr\u003e\n\"Failed to compile script module”\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003ecorreted the .h file\u003c/p\u003e","post_number":16,"post_type":1,"updated_at":"2017-01-02T00:58:39.301Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":2,"reads":24,"readers_count":23,"score":14.8,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":62,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":972,"name":"","username":"Azalrion","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/f04885/{size}.png","created_at":"2014-03-30T10:03:28.000Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"gasp\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg alt=\"\" width=\"20\" height=\"20\" src=\"https://avatars.discourse-cdn.com/v4/letter/g/0ea827/40.png\" class=\"avatar\"\u003e gasp:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWhen declaring type “asOBJ_POD” seem to be medatory, if i don’t set it i get : \u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eYep in your case its needed because you’re not declaring any constructors or destructors as part of the binding, so when it sees asOBJ_POD Angelscript will just use a default constructor, if you don’t declare it you need to register the asBEHAVE (I think it is) for Ctors and Dtors.\u003c/p\u003e\n\u003cp\u003eJust one last thing I noticed, to use the assert properly it should be;\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003er = engine-\u0026gt;RegisterObjectMethod(\"simplemath\", \"void testSanRien()\", asMETHOD(SimpleMath,testSanRien), asCALL_THISCALL);\nassert(r \u0026gt;= 0);\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eCalling any angelscript RegisterXXX method returns an int value that is either 0 or less than 0 which then points to a specific error. So to catch the assert properly each time you call a register method you should be assigning r like above.\u003c/p\u003e","post_number":17,"post_type":1,"updated_at":"2017-01-02T00:58:39.449Z","reply_count":0,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":0,"reads":24,"readers_count":23,"score":4.8,"yours":false,"topic_id":97,"topic_slug":"how-do-i-make-a-script-object-in-c","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":8,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[417,418,420,421,422,423,424,932,933,935,936,939,940,959,963,970,972]},"timeline_lookup":[[1,3204],[8,3162],[14,3161],[16,3160]],"suggested_topics":[{"id":7243,"title":"Android compile fails","fancy_title":"Android compile fails","slug":"android-compile-fails","posts_count":5,"reply_count":2,"highest_post_number":5,"image_url":null,"created_at":"2022-04-25T08:46:07.947Z","last_posted_at":"2022-05-06T08:22:51.592Z","bumped":true,"bumped_at":"2022-05-06T08:22:51.592Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":181,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":856,"username":"feresmu","name":null,"avatar_template":"https://avatars.discourse-cdn.com/v4/letter/f/f08c70/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7127,"title":"Switching ribbon trails emission glitches transparent materials","fancy_title":"Switching ribbon trails emission glitches transparent materials","slug":"switching-ribbon-trails-emission-glitches-transparent-materials","posts_count":8,"reply_count":3,"highest_post_number":8,"image_url":null,"created_at":"2022-01-13T17:17:46.847Z","last_posted_at":"2022-02-10T08:10:49.330Z","bumped":true,"bumped_at":"2022-02-10T08:10:49.330Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":323,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1188,"username":"Taqer","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/d2c977/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}}]},{"id":7146,"title":"How create affordable comfortable and modern terrain?","fancy_title":"How create affordable comfortable and modern terrain?","slug":"how-create-affordable-comfortable-and-modern-terrain","posts_count":5,"reply_count":1,"highest_post_number":5,"image_url":null,"created_at":"2022-01-21T15:20:08.910Z","last_posted_at":"2022-01-21T21:51:58.799Z","bumped":true,"bumped_at":"2022-01-21T22:03:14.896Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":193,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1497,"username":"timob256","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/b782af/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1304,"username":"lebrewer","name":"lebrewer","avatar_template":"/user_avatar/discourse.urho3d.io/lebrewer/{size}/2811_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":230,"username":"Nerrik","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/958977/{size}.png"}}]},{"id":7104,"title":"Bug in my partial-model copying code","fancy_title":"Bug in my partial-model copying code","slug":"bug-in-my-partial-model-copying-code","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/5/5367e370779d64989e5c3ff2c1ebfb0689908c87.png","created_at":"2021-12-17T03:50:19.405Z","last_posted_at":"2021-12-17T13:50:49.662Z","bumped":true,"bumped_at":"2021-12-17T13:50:49.662Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":144,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7313,"title":"RenderPaths and depth texture","fancy_title":"RenderPaths and depth texture","slug":"renderpaths-and-depth-texture","posts_count":4,"reply_count":0,"highest_post_number":4,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/4/4115352ee634066092d24dcacacc24d2ec90206d.png","created_at":"2022-08-15T03:31:55.300Z","last_posted_at":"2022-08-19T11:32:37.386Z","bumped":true,"bumped_at":"2022-08-19T11:32:37.386Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":136,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":1404,"username":"shifttab","name":"shifttab","avatar_template":"/user_avatar/discourse.urho3d.io/shifttab/{size}/3250_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]}],"tags_descriptions":{},"id":97,"title":"How do I make a script object in C++?","fancy_title":"How do I make a script object in C++?","posts_count":17,"created_at":"2014-02-13T18:21:59.000Z","views":2507,"reply_count":0,"like_count":0,"last_posted_at":"2014-03-30T10:03:28.000Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"how-do-i-make-a-script-object-in-c","category_id":10,"word_count":1713,"deleted_at":null,"user_id":26,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_97","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":17,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":5,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":8,"username":"Azalrion","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/f04885/{size}.png","post_count":5,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":26,"username":"GIMB4L","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/ba8739/{size}.png","post_count":5,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":62,"username":"gasp","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/0ea827/{size}.png","post_count":5,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":3,"username":"cadaver","name":"Lasse Öörni","avatar_template":"/user_avatar/discourse.urho3d.io/cadaver/{size}/3_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":2},{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"admin":true,"trust_level":4}],"created_by":{"id":26,"username":"GIMB4L","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/ba8739/{size}.png"},"last_poster":{"id":8,"username":"Azalrion","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/f04885/{size}.png"},"links":[{"url":"http://urho3d.github.io/documentation/a00016.html","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":45,"user_id":8,"domain":"urho3d.github.io","root_domain":"urho3d.github.io"}]}}