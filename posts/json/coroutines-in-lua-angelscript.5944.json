{"post_stream":{"posts":[{"id":36402,"name":"SirNate0","username":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png","created_at":"2020-02-24T20:53:17.324Z","cooked":"\u003cp\u003eI‚Äôve been pondering creating a nice script-timeline format for use in scripting attacks for my game, and have thrown together a plausible Python prototype. Anyone know if there is a good way to implement something like this in AngelScript or Lua?\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003efrom time import time,sleep\nfrom dataclasses import dataclass\nfrom typing import Sequence, Callable\n\n@dataclass\nclass Finished:\n  pass\n\n@dataclass\nclass Until:\n  time: float\n\n@dataclass\nclass NewTimeline:\n  timelineCall: Callable\n  arguments: Sequence = tuple([])\n\ndef FinishedGenerator():\n  while True:\n    yield Finished()\n\nclass Timeline(object):\n  def __init__(self,primaryTimeline):\n    self.start = time()\n    self.waitTill = 0\n    self.status = Until(0)\n    self.timeline = primaryTimeline\n    self.generator = None\n\n  def run(self):\n    if self.generator is None:\n      self.generator = self.timeline.timelineCall(*self.timeline.arguments)\n      if self.generator is None:\n        self.generator = FinishedGenerator()\n    try:\n      while self.waitTill \u0026lt;= time() - self.start:\n        result = next(self.generator)\n        if isinstance(result,Until):\n          self.waitTill = result.time\n        elif isinstance(result,NewTimeline):\n          makeTimeline(Timeline(result))\n          self.waitTill = 0\n        elif isinstance(result,Finished) or result is None:\n          raise StopIteration()\n        else:\n          print(result)\n          self.waitTill = float(result)\n      #print(self.status,self.waitTill,time()-self.start)\n      return False\n    except StopIteration:\n      removeTimeline(self)\n      return True\n    \n\ndefaultCount = 3\ndef exampleTimeline(name,count = defaultCount):\n  if count \u0026lt;= 0:\n    return\n  print(name+'Initial behavior {}'.format(time()-fullStart))\n  yield 1\n  print(name+'Waited 1 second {}'.format(time()-fullStart))\n  yield Until(1.25)\n  print(name+'Waited until 1.25 seconds {}'.format(time()-fullStart))\n  yield NewTimeline(exampleTimeline,['Child{}: '.format(defaultCount-count),count-1])\n  print(name+'Made new timeline {}'.format(time()-fullStart))\n  yield Until(2)\n  print(name+'Waited until 2 {}'.format(time()-fullStart))\n  yield Finished()\n\n\ntimelines = []\n\ndef makeTimeline(timelineCall):\n  print('Added new timeline ' + str(timelineCall))\n  timelines.append(timelineCall)\n\ndef removeTimeline(timelineCall):\n  print('Removed timeline ' + str(timelineCall))\n  timelines.remove(timelineCall)\n\nmakeTimeline(Timeline(NewTimeline(exampleTimeline,['Hello: '])))\n\nfullStart = time()\ni = 0\nwhile len(timelines):\n#while not all(t.run() for t in timelines):\n  i+=1\n  #print(i,':',time() - fullStart,len(timelines))\n  for t in timelines:\n    t.run()\n  sleep(1/60)\n\nprint('\\nFinished')\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOutput:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003eAdded new timeline \u0026lt;__main__.Timeline object at 0x7f2ed5cba1c0\u0026gt;\nHello: Initial behavior 1.621246337890625e-05\n1\nHello: Waited 1 second 0.9997529983520508\nHello: Waited until 1.25 seconds 1.253164291381836\nAdded new timeline \u0026lt;__main__.Timeline object at 0x7f2ed584eac0\u0026gt;\nHello: Made new timeline 1.2533085346221924\nChild0: Initial behavior 1.2533459663391113\n1\nHello: Waited until 2 2.014037847518921\nRemoved timeline \u0026lt;__main__.Timeline object at 0x7f2ed5cba1c0\u0026gt;\nChild0: Waited 1 second 2.259462594985962\nChild0: Waited until 1.25 seconds 2.504365921020508\nAdded new timeline \u0026lt;__main__.Timeline object at 0x7f2ed5c32ee0\u0026gt;\nChild0: Made new timeline 2.506049633026123\nChild1: Initial behavior 2.50616192817688\n1\nChild0: Waited until 2 3.2673180103302\nRemoved timeline \u0026lt;__main__.Timeline object at 0x7f2ed584eac0\u0026gt;\nChild1: Waited 1 second 3.5204973220825195\nChild1: Waited until 1.25 seconds 3.758823871612549\nAdded new timeline \u0026lt;__main__.Timeline object at 0x7f2ed584eac0\u0026gt;\nChild1: Made new timeline 3.7622861862182617\nRemoved timeline \u0026lt;__main__.Timeline object at 0x7f2ed584eac0\u0026gt;\nChild1: Waited until 2 4.511084794998169\nRemoved timeline \u0026lt;__main__.Timeline object at 0x7f2ed5c32ee0\u0026gt;\nFinished\n\u003c/code\u003e\u003c/pre\u003e","post_number":1,"post_type":1,"updated_at":"2020-02-24T20:53:17.324Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":24,"reads":32,"readers_count":31,"score":126.4,"yours":false,"topic_id":5944,"topic_slug":"coroutines-in-lua-angelscript","display_username":"SirNate0","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":628,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[36402]},"timeline_lookup":[[1,1002]],"suggested_topics":[{"id":7092,"title":"Finding the World Space Coordinates of the Screen Edges","fancy_title":"Finding the World Space Coordinates of the Screen Edges","slug":"finding-the-world-space-coordinates-of-the-screen-edges","posts_count":6,"reply_count":2,"highest_post_number":6,"image_url":null,"created_at":"2021-12-07T20:53:49.453Z","last_posted_at":"2021-12-08T12:33:52.510Z","bumped":true,"bumped_at":"2021-12-08T12:33:52.510Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":210,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":1456,"username":"Jens","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/j/d2c977/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}}]},{"id":7129,"title":"Best Model Import Pipeline as of Jan 2022?","fancy_title":"Best Model Import Pipeline as of Jan 2022?","slug":"best-model-import-pipeline-as-of-jan-2022","posts_count":7,"reply_count":0,"highest_post_number":7,"image_url":null,"created_at":"2022-01-17T09:27:23.432Z","last_posted_at":"2022-01-17T20:37:59.458Z","bumped":true,"bumped_at":"2022-01-17T20:37:59.458Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":170,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1165,"username":"throwawayerino","name":"Actually Permanent","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/da6949/{size}.png"}}]},{"id":7156,"title":"Manual Mesh Part Animation (e.g. Rotate a propeller)","fancy_title":"Manual Mesh Part Animation (e.g. Rotate a propeller)","slug":"manual-mesh-part-animation-e-g-rotate-a-propeller","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2022-01-26T23:50:29.343Z","last_posted_at":"2022-01-27T05:31:02.766Z","bumped":true,"bumped_at":"2022-01-27T05:31:02.766Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":155,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":631,"username":"JTippetts1","name":"J Tippetts","avatar_template":"/user_avatar/discourse.urho3d.io/jtippetts1/{size}/96_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}}]},{"id":7179,"title":"Need help with cusomized PBR renderpath","fancy_title":"Need help with cusomized PBR renderpath","slug":"need-help-with-cusomized-pbr-renderpath","posts_count":4,"reply_count":0,"highest_post_number":4,"image_url":null,"created_at":"2022-02-01T09:04:58.692Z","last_posted_at":"2022-02-03T17:35:34.174Z","bumped":true,"bumped_at":"2022-02-03T17:35:34.174Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":13,"views":205,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster, Accepted Answer","user":{"id":247,"username":"Dave82","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/dave82/{size}/2369_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]},{"id":7067,"title":"Can the latest Urho3D version be built with VS2013?","fancy_title":"Can the latest Urho3D version be built with VS2013?","slug":"can-the-latest-urho3d-version-be-built-with-vs2013","posts_count":3,"reply_count":0,"highest_post_number":3,"image_url":null,"created_at":"2021-11-25T18:00:24.336Z","last_posted_at":"2021-11-26T17:22:21.878Z","bumped":true,"bumped_at":"2021-11-26T17:22:21.878Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":157,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png"}}]}],"tags_descriptions":{},"id":5944,"title":"Coroutines in Lua/AngelScript","fancy_title":"Coroutines in Lua/AngelScript","posts_count":1,"created_at":"2020-02-24T20:53:17.132Z","views":241,"reply_count":0,"like_count":0,"last_posted_at":"2020-02-24T20:53:17.324Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"coroutines-in-lua-angelscript","category_id":10,"word_count":485,"deleted_at":null,"user_id":628,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_5944","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":1,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":1,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"},"last_poster":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}}