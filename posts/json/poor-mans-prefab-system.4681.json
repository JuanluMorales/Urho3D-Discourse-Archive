{"post_stream":{"posts":[{"id":26649,"name":"","username":"Bananaft","avatar_template":"/user_avatar/discourse.urho3d.io/bananaft/{size}/222_2.png","created_at":"2018-11-19T11:21:37.331Z","cooked":"\u003cp\u003eI made myself a prefab system. It came out pretty minimalistic. And I’m very happy with it. Even nested prefabs are working (literally better than Unity). Sharing it, so maybe someone will find it useful or give me feedback (because I’m not very confident with C++). And maybe we will make it into PR. Licensed under CC0.\u003c/p\u003e\n\u003cp\u003eHere is the video demonstration:\u003cbr\u003e\n\u003c/p\u003e\u003cdiv class=\"lazyYT\" data-youtube-id=\"PPPIIGSliBI\" data-youtube-title=\"Urho3d prefabs\" data-width=\"480\" data-height=\"270\" data-parameters=\"feature=oembed\u0026amp;wmode=opaque\"\u003e\u003c/div\u003e\n\u003cp\u003eSo, basically, each node has a reference to a XMLfile, if it is empty, then nothing happens, it’s a normal node, if it is pointing to a file, then:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eon save will skip saving it’s children and components\u003c/li\u003e\n\u003cli\u003eon load this node will load object from this xml file, and applying it’s transform to it.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eI also added live reload handling. And save prefab button. (Using \u003ca href=\"https://github.com/urho3d/Urho3D/issues/1507\" rel=\"nofollow noopener\"\u003ethis marvelous hack\u003c/a\u003e)\u003c/p\u003e\n\u003cp\u003eHere is a full code: \u003ca href=\"https://gist.github.com/Bananaft/63b32123e2e3b6909d782fb7f6914406\" rel=\"nofollow noopener\"\u003eNode.h and Node.cpp\u003c/a\u003e\u003cbr\u003e\nI use Urho1.7, so the code is a bit old.\u003c/p\u003e\n\u003cp\u003eBasically, I added two new attributes:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eURHO3D_MIXED_ACCESSOR_ATTRIBUTE(\"Prefab\", GetPrefab, SetPrefab, ResourceRef, ResourceRef(XMLFile::GetTypeStatic()), AM_FILE);\nURHO3D_ACCESSOR_ATTRIBUTE(\"Save Prefab\", GetFalse, SavePrefab, bool, false, AM_EDIT);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn Node::SaveXML, after saving id and attributes:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eif (prefab_ != NULL)\n    return true;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd then this four new functions:\u003cbr\u003e\n\u003caside class=\"onebox githubgist\"\u003e\n  \u003cheader class=\"source\"\u003e\n      \u003ca href=\"https://gist.github.com/Bananaft/797f0291ede5451d9f50f4126b56ea3d\" target=\"_blank\" rel=\"nofollow noopener\"\u003egist.github.com\u003c/a\u003e\n  \u003c/header\u003e\n  \u003carticle class=\"onebox-body\"\u003e\n    \u003ch4\u003e\u003ca href=\"https://gist.github.com/Bananaft/797f0291ede5451d9f50f4126b56ea3d\" target=\"_blank\" rel=\"nofollow noopener\"\u003ehttps://gist.github.com/Bananaft/797f0291ede5451d9f50f4126b56ea3d\u003c/a\u003e\u003c/h4\u003e\n\u003ch5\u003eprefabs.cpp\u003c/h5\u003e\n\u003cpre\u003e\u003ccode class=\"C++\"\u003e    void Node::SetPrefab(const ResourceRef\u0026amp; value)\n    {\n    \tUnsubscribeFromEvent(prefab_, E_RELOADFINISHED);\n    \tif (value.name_.Empty())\n    \t{\n    \t\tprefab_ = NULL;\n    \t}\n    \telse {\n    \n    \t\tResourceCache* cache = GetSubsystem\u0026lt;ResourceCache\u0026gt;();\u003c/code\u003e\u003c/pre\u003e\nThis file has been truncated. \u003ca href=\"https://gist.github.com/Bananaft/797f0291ede5451d9f50f4126b56ea3d\" target=\"_blank\" rel=\"nofollow noopener\"\u003eshow original\u003c/a\u003e\n\n\u003cp\u003e\n\u003c/p\u003e\n\n  \u003c/article\u003e\n  \u003cdiv class=\"onebox-metadata\"\u003e\n    \n    \n  \u003c/div\u003e\n  \u003cdiv style=\"clear: both\"\u003e\u003c/div\u003e\n\u003c/aside\u003e\n\u003c/p\u003e\n\u003cp\u003eAnd lastly I had to make room in the editor interface, AttributeEditor.as\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003econst uint MIN_NODE_ATTRIBUTES = 7;\nconst uint MAX_NODE_ATTRIBUTES = 11;\u003c/code\u003e\u003c/pre\u003e","post_number":1,"post_type":1,"updated_at":"2018-11-19T11:54:19.410Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":239,"reads":75,"readers_count":74,"score":1360.0,"yours":false,"topic_id":4681,"topic_slug":"poor-mans-prefab-system","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/urho3d/Urho3D/issues/1507","internal":false,"reflection":false,"title":"Triggers (buttons) in Component Editor · Issue #1507 · urho3d/Urho3D · GitHub","clicks":26},{"url":"https://gist.github.com/Bananaft/797f0291ede5451d9f50f4126b56ea3d","internal":false,"reflection":false,"title":"prefabs.cpp · GitHub","clicks":22},{"url":"https://gist.github.com/Bananaft/63b32123e2e3b6909d782fb7f6914406","internal":false,"reflection":false,"title":"Urho3d prefabs · GitHub","clicks":14},{"url":"https://www.youtube.com/watch?v=PPPIIGSliBI","internal":false,"reflection":false,"title":"YouTube","clicks":4},{"url":"https://discourse.urho3d.io/t/moving-nodes-between-scenes/4883/11","internal":true,"reflection":true,"title":"Moving nodes between scenes","clicks":0}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":6}],"moderator":false,"admin":false,"staff":false,"user_id":165,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":26650,"name":"","username":"rku","avatar_template":"/user_avatar/discourse.urho3d.io/rku/{size}/3200_2.png","created_at":"2018-11-19T11:36:14.368Z","cooked":"\u003cp\u003eGreat work!\u003c/p\u003e\n\u003cp\u003eI see you have to select some other node (“base”?) and check “save prefab” checkbox for changes to apply\u003cbr\u003e\nwhats going on there? Bit not very user-friendly. i wonder if we could make it better.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2018-11-19T11:36:14.368Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":11,"reads":71,"readers_count":70,"score":74.2,"yours":false,"topic_id":4681,"topic_slug":"poor-mans-prefab-system","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":246,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":26652,"name":"","username":"Bananaft","avatar_template":"/user_avatar/discourse.urho3d.io/bananaft/{size}/222_2.png","created_at":"2018-11-19T11:50:22.988Z","cooked":"\u003cp\u003eIn this scene there are three buildings (bases) prefabs, each of them nesting a bunch of lamp prefabs.\u003cbr\u003e\nHere is basically whole scene.xml:\u003cbr\u003e\n\u003cimg src=\"//cdck-file-uploads-global.s3.dualstack.us-west-2.amazonaws.com/standard17/uploads/urho3d/original/2X/c/cdc0999372f8959cf14784feac2bbfd904623a60.png\" alt=\"image\" width=\"567\" height=\"500\"\u003e\u003c/p\u003e\n\u003cp\u003eIn the video, I first copy an object in one of the buildings. If I save the scene, this change will be lost. I have to save it into object file. So I select a parent node, the one named “base”, click “Save Prefab” and two other bases update themselves with this change.\u003c/p\u003e\n\u003cp\u003eOne improvement I thought about is if you press the “Save prefab” button, but prefab attribute is empty, it goes up the hierarchy until it finds a parent with prefab and saves it.\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2018-11-19T11:50:22.988Z","reply_count":1,"reply_to_post_number":2,"quote_count":0,"incoming_link_count":4,"reads":68,"readers_count":67,"score":83.6,"yours":false,"topic_id":4681,"topic_slug":"poor-mans-prefab-system","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"rku","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/rku/{size}/3200_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":165,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":26653,"name":"","username":"Bananaft","avatar_template":"/user_avatar/discourse.urho3d.io/bananaft/{size}/222_2.png","created_at":"2018-11-19T12:01:36.827Z","cooked":"\u003cp\u003eIt would also be great to paint prefab nodes with different colors in the editor.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2018-11-19T12:01:36.827Z","reply_count":0,"reply_to_post_number":3,"quote_count":0,"incoming_link_count":1,"reads":67,"readers_count":66,"score":33.4,"yours":false,"topic_id":4681,"topic_slug":"poor-mans-prefab-system","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"Bananaft","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/bananaft/{size}/222_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":165,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[26649,26650,26652,26653]},"timeline_lookup":[[1,1465]],"suggested_topics":[{"id":7099,"title":":fallen_leaf: Polynomials \u0026 Harmonics","fancy_title":":fallen_leaf: Polynomials \u0026amp; Harmonics","slug":"polynomials-harmonics","posts_count":6,"reply_count":0,"highest_post_number":7,"image_url":null,"created_at":"2021-12-13T05:06:04.641Z","last_posted_at":"2021-12-27T23:27:39.489Z","bumped":true,"bumped_at":"2021-12-27T23:27:39.489Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"unicode_title":"🍂 Polynomials \u0026 Harmonics","tags_descriptions":{},"like_count":6,"views":392,"category_id":13,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}}]},{"id":7103,"title":":test_tube: DebugRenderer as GUI","fancy_title":":test_tube: DebugRenderer as GUI","slug":"debugrenderer-as-gui","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-17T02:25:06.606Z","last_posted_at":"2021-12-18T01:09:27.738Z","bumped":true,"bumped_at":"2021-12-18T01:09:27.738Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"unicode_title":"🧪 DebugRenderer as GUI","tags_descriptions":{},"like_count":4,"views":267,"category_id":13,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]},{"id":7110,"title":"Resource fetch define","fancy_title":"Resource fetch define","slug":"resource-fetch-define","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-12-27T12:28:55.126Z","last_posted_at":"2021-12-27T17:00:37.699Z","bumped":true,"bumped_at":"2021-12-27T17:00:37.699Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":7,"views":184,"category_id":13,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":192,"username":"Modanung","name":"魔大农 𝞍𝞎𝝳 現招蜍","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1304,"username":"lebrewer","name":"lebrewer","avatar_template":"/user_avatar/discourse.urho3d.io/lebrewer/{size}/2811_2.png"}}]},{"id":7120,"title":"Log Error Once Macro","fancy_title":"Log Error Once Macro","slug":"log-error-once-macro","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-01-04T02:24:37.857Z","last_posted_at":"2022-01-04T02:24:37.925Z","bumped":true,"bumped_at":"2022-01-04T02:24:37.925Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":143,"category_id":13,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7332,"title":"Action RPG Game with Urho3D and Entt","fancy_title":"Action RPG Game with Urho3D and Entt","slug":"action-rpg-game-with-urho3d-and-entt","posts_count":1,"reply_count":0,"highest_post_number":1,"image_url":null,"created_at":"2022-09-25T04:07:40.447Z","last_posted_at":"2022-09-25T04:07:40.526Z","bumped":true,"bumped_at":"2022-09-25T04:07:40.526Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":220,"category_id":12,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":789,"username":"codewalkerdan","name":"Codewalkerdan","avatar_template":"/user_avatar/discourse.urho3d.io/codewalkerdan/{size}/675_2.png"}}]}],"tags_descriptions":{},"id":4681,"title":"Poor man's prefab system","fancy_title":"Poor man\u0026rsquo;s prefab system","posts_count":4,"created_at":"2018-11-19T11:21:37.246Z","views":1020,"reply_count":2,"like_count":8,"last_posted_at":"2018-11-19T12:01:36.827Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"poor-mans-prefab-system","category_id":13,"word_count":416,"deleted_at":null,"user_id":165,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_4681","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":4,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":165,"username":"Bananaft","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/bananaft/{size}/222_2.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":246,"username":"rku","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/rku/{size}/3200_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":165,"username":"Bananaft","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/bananaft/{size}/222_2.png"},"last_poster":{"id":165,"username":"Bananaft","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/bananaft/{size}/222_2.png"},"links":[{"url":"https://github.com/urho3d/Urho3D/issues/1507","title":"Triggers (buttons) in Component Editor · Issue #1507 · urho3d/Urho3D · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":26,"user_id":165,"domain":"github.com","root_domain":"github.com"},{"url":"https://gist.github.com/Bananaft/797f0291ede5451d9f50f4126b56ea3d","title":"prefabs.cpp · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":22,"user_id":165,"domain":"gist.github.com","root_domain":"github.com"},{"url":"https://gist.github.com/Bananaft/63b32123e2e3b6909d782fb7f6914406","title":"Urho3d prefabs · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":14,"user_id":165,"domain":"gist.github.com","root_domain":"github.com"},{"url":"https://www.youtube.com/watch?v=PPPIIGSliBI","title":"YouTube","internal":false,"attachment":false,"reflection":false,"clicks":4,"user_id":165,"domain":"www.youtube.com","root_domain":"youtube.com"}]}}