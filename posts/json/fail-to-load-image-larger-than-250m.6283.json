{"post_stream":{"posts":[{"id":38428,"name":"","username":"UrhoIsTheBest","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png","created_at":"2020-07-25T07:07:30.370Z","cooked":"\u003cp\u003eI was loading a big terrain heightmap data through png image ~270M.\u003c/p\u003e\n\u003cp\u003eI got the error\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eCould not load image XXXXX: too large\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eI traced down the issue found it‚Äôs related to \u003ccode\u003estb\u003c/code\u003e image lib that Urho3D is using, see \u003ca href=\"https://github.com/nothings/stb/issues/672#issuecomment-580041441\" rel=\"nofollow noopener\"\u003egithub issue\u003c/a\u003e.\u003cbr\u003e\nGenerally,\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003estb_image uses ints pervasively, including for offset calculations.\u003cbr\u003e\nso MAX_IMAGE_SIZE ~256MB max.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eI tried a smaller image ~200M but there is still other issue I haven‚Äôt figured out yet.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eThis is unfortunate and I was wondering if there is a quick workaround, e.g. use a different image type?\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eOtherwise, I might need to write my own image loader purely for large files.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eI could separate source image into smaller ones and load them one by one, but this would make things nasty given I am going to upload this heightmap to GPU. I don‚Äôt want to implement ‚Äúselecting images according to coordinates‚Äù nasty logic in the shader.\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eUpdate:\u003c/strong\u003e I also have error when using texture image ~200M for opengl\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eFailed to create texture.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThere should be a max size (width, ram) for GPU to resolve too \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/frowning.png?v=9\" title=\":frowning:\" class=\"emoji\" alt=\":frowning:\"\u003e\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2020-07-26T18:50:09.976Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":10,"reads":41,"readers_count":40,"score":58.2,"yours":false,"topic_id":6283,"topic_slug":"fail-to-load-image-larger-than-250m","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":3,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://github.com/nothings/stb/issues/672#issuecomment-580041441","internal":false,"reflection":false,"title":"maximum image size for sub_image ¬∑ Issue #672 ¬∑ nothings/stb ¬∑ GitHub","clicks":2}],"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1291,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":38432,"name":"Eugene Kozlov","username":"Eugene","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","created_at":"2020-07-25T09:08:11.767Z","cooked":"\u003cp\u003eMax size of the image is limited, check your GPU specs to find out exact limits. It‚Äôs usually varies from 2k to 16k.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2020-07-25T09:08:11.767Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":39,"readers_count":38,"score":7.8,"yours":false,"topic_id":6283,"topic_slug":"fail-to-load-image-larger-than-250m","display_username":"Eugene Kozlov","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"Core developer","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":484,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":38438,"name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","username":"Modanung","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png","created_at":"2020-07-26T01:41:47.998Z","cooked":"\u003cp\u003e‚Ä¶or \u003ca href=\"https://imagemagick.org/script/command-line-options.php#crop\"\u003eImageMagick\u003c/a\u003e.\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2020-07-26T01:41:47.998Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":31,"readers_count":30,"score":6.2,"yours":false,"topic_id":6283,"topic_slug":"fail-to-load-image-larger-than-250m","display_username":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://imagemagick.org/script/command-line-options.php#crop","internal":false,"reflection":false,"title":"ImageMagick - Command-line Options","clicks":1}],"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":192,"hidden":false,"trust_level":0,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_suspended":true,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":38439,"name":"","username":"UrhoIsTheBest","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png","created_at":"2020-07-26T02:32:51.611Z","cooked":"\u003cp\u003eThanks.\u003c/p\u003e\n\u003cp\u003eI did not notice CDLOD cuts large texture into smaller ones. At least it‚Äôs not obvious from the paper. But I am a little bit disappointed about those papers (CDLDO, geoclipmapping). CDLOD paper mentioned about streamable blocks of terrain data but that‚Äôs for StreamingCDLOD. I would not expect the author is cutting textures for the BasicCDLOD one.\u003cbr\u003e\nI tried to read the source code for that paper, but it‚Äôs very un-readable as all the academia codes.\u003c/p\u003e\n\u003cp\u003eIf I have to use smaller texture images, things would get tricky.\u003cbr\u003e\nFor my case, I need to show the full terrain in low resolution when the camera zooms out enough. So I might need different LOD texture anyway, and decide which one to use in real time. The idea is simple but would be a pain to implement.\u003cbr\u003e\nI am not sure how the BasicCDLOD dealing with those exchanging texture images realtime since there is no single word about it in the paper. I probably going to spend sometime reading through that source code no matter how un-readable it is.\u003cbr\u003e\nIf you happened to be familiar with that source code, could you point me where is the code for the shaders to choose the correct smaller texture images?\u003c/p\u003e\n\u003cp\u003eAs for cutting images, I am not worried about it. Since I have my own tool based on GDAL for Geographic terrain data manipulation. I made my terrain with it.\u003c/p\u003e\n\u003cp\u003eI thought I was close for this implementation but looks like lots of things need to be done if the program is for real application other than a demo.\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2020-07-26T02:32:51.611Z","reply_count":0,"reply_to_post_number":3,"quote_count":0,"incoming_link_count":0,"reads":32,"readers_count":31,"score":6.4,"yours":false,"topic_id":6283,"topic_slug":"fail-to-load-image-larger-than-250m","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"","reply_to_user":{"username":"diskette","name":"diskette","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/d/45deac/{size}.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1291,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":38445,"name":"","username":"UrhoIsTheBest","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png","created_at":"2020-07-26T18:44:55.258Z","cooked":"\u003cp\u003eI could make different images for different LODs, but for my case, I have LODs from 0 ~ 8. For example, I could make a low resolution image for the whole map (lod = 8), then maybe 4 with lod = 7. That‚Äôs the minimum number of images I need but \u003cstrong\u003ethat would occupy 5 texture units already!\u003c/strong\u003e IIUC, we have only 16 texture units for certain. But I still needs other textures (e.g. normal, spec, several terrain details). If we have different images for different lod, we need the same number of image for normal, spec etc too.\u003cbr\u003e\nI am not sure what‚Äôs the good solution for this.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eAnyway, I tried to cut my source image into 4 pieces.\u003c/strong\u003e\u003cbr\u003e\nLooks like my computer is okay to load texture image with size \u0026lt;= 8192.\u003cbr\u003e\nMy texture image size is about two times larger. So I divided my image into 4 pieces. A very rough demo code:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e  const int kMaxSupportedSingleHeightMapSize = 8192;\n  for (int i = 0; i \u0026lt; 4; ++i) {\n    auto texture = SharedPtr\u0026lt;Texture2D\u0026gt;(new Texture2D(context_));\n    int index_x = i % 2;\n    int index_y = i / 2;\n    int x0 = std::max(0, index_x * kMaxSupportedSingleHeightMapSize);\n    int x1 = std::min(heightmap_image_-\u0026gt;GetWidth() - 1, (index_x + 1) * kMaxSupportedSingleHeightMapSize);\n    int y0 = std::max(0, index_y * kMaxSupportedSingleHeightMapSize);\n    int y1 = std::min(heightmap_image_-\u0026gt;GetHeight() - 1, (index_y + 1) * kMaxSupportedSingleHeightMapSize);\n    SharedPtr\u0026lt;Image\u0026gt; heightmap_test = SharedPtr\u0026lt;Image\u0026gt;(heightmap_image_-\u0026gt;GetSubimage(IntRect(x0, y0, x1, y1)));\n    texture-\u0026gt;SetFilterMode(FILTER_NEAREST);\n    texture-\u0026gt;SetData(heightmap_test, false);\n\n    // I also changed those values, but does not make difference for my case.\n    std::vector\u0026lt;TextureUnit\u0026gt; units{TU_DIFFUSE, TU_NORMAL, TU_SPECULAR, TU_EMISSIVE,};\n    batches_[0].material_-\u0026gt;SetTexture(/*texture unit*/units[i], texture);\n  }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd then I get different texture image for vertex displacement in the shader:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003efloat GetHeight(vec2 pos) {\n    vec2 texCoord;\n    vec2 heights;\n    if (pos.x \u0026lt;= cMapSize.x \u0026amp;\u0026amp; pos.y \u0026lt;= cMapSize.y) {\n        texCoord = vec2(pos.x / cMapSize.x, pos.y / cMapSize.y);\n        heights = texture(sHeightMap0, texCoord).rg;\n    } else if (pos.x \u0026gt; cMapSize.x \u0026amp;\u0026amp; pos.y \u0026lt;= cMapSize.y) {\n        texCoord = vec2(pos.x / cMapSize.x - 1.0, pos.y / cMapSize.y);\n        heights = texture(sHeightMap1, texCoord).rg;\n    } else if (pos.x \u0026lt;= cMapSize.x \u0026amp;\u0026amp; pos.y \u0026gt; cMapSize.y) {\n        texCoord = vec2(pos.x / cMapSize.x, pos.y / cMapSize.y - 1.0);\n        heights = texture(sHeightMap2, texCoord).rg;\n    } else if (pos.x \u0026gt; cMapSize.x \u0026amp;\u0026amp; pos.y \u0026gt; cMapSize.y) {\n        texCoord = vec2(pos.x / cMapSize.x - 1.0, pos.y / cMapSize.y - 1.0);\n        heights = texture(sHeightMap3, texCoord).rg;\n    }\n    ...\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ewith the material definition\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003e\u0026lt;material\u0026gt;\n    \u0026lt;technique name=\"Techniques/CdlodTerrain.xml\" /\u0026gt;\n    // units 0 ~ 3 reserved for heightmap images.\n    \u0026lt;texture unit=\"0\" name=\"\" /\u0026gt;\n    \u0026lt;texture unit=\"1\" name=\"\" /\u0026gt;\n    \u0026lt;texture unit=\"2\" name=\"\" /\u0026gt;\n    \u0026lt;texture unit=\"3\" name=\"\" /\u0026gt;\n    \u0026lt;texture unit=\"4\" name=\"HeightMapsTest/DEM_print.png\" /\u0026gt;\n    \u0026lt;texture unit=\"5\" name=\"Textures/TerrainDetail1.dds\" /\u0026gt;\n    ...\n\u0026lt;/material\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis cutting-image method works fine for a smaller heightmap.\u003cbr\u003e\n\u003cstrong\u003eBut for my case, some textures do not show. It looks like they are unloaded automatically somehow.\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"lightbox-wrapper\"\u003e\u003ca class=\"lightbox\" href=\"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/8/8fa39571ba3760900cd2f69afc527ed175760582.jpeg\" data-download-href=\"/uploads/short-url/kuGKNKvovQr0NvVExoDZzhFQjOa.jpeg?dl=1\" title=\"image\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/8/8fa39571ba3760900cd2f69afc527ed175760582_2_676x500.jpeg\" alt=\"image\" data-base62-sha1=\"kuGKNKvovQr0NvVExoDZzhFQjOa\" width=\"676\" height=\"500\" srcset=\"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/8/8fa39571ba3760900cd2f69afc527ed175760582_2_676x500.jpeg, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/8/8fa39571ba3760900cd2f69afc527ed175760582_2_1014x750.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/8/8fa39571ba3760900cd2f69afc527ed175760582_2_1352x1000.jpeg 2x\" data-small-upload=\"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/8/8fa39571ba3760900cd2f69afc527ed175760582_2_10x10.png\"\u003e\u003cdiv class=\"meta\"\u003e\u003csvg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"\u003e\u003cuse xlink:href=\"#far-image\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003cspan class=\"filename\"\u003eimage\u003c/span\u003e\u003cspan class=\"informations\"\u003e2044√ó1510 609 KB\u003c/span\u003e\u003csvg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"\u003e\u003cuse xlink:href=\"#discourse-expand\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/div\u003e\u003c/a\u003e\u003c/div\u003e\u003c/p\u003e\n\u003cp\u003eIf I randomly exchange the order of heightmap in shader, for example:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"lang-auto\"\u003efloat GetHeight(vec2 pos) {\n   ...\n        heights = texture(sHeightMap3, texCoord).rg;\n   ...\n        heights = texture(sHeightMap2, texCoord).rg;\n    ...\n        heights = texture(sHeightMap1, texCoord).rg;\n   ...\n        heights = texture(sHeightMap0, texCoord).rg;\n    ...\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eDifferent texture images will be remained.\u003c/strong\u003e The bottom-left is a different one.\u003c/p\u003e\n\u003cp\u003e\u003cdiv class=\"lightbox-wrapper\"\u003e\u003ca class=\"lightbox\" href=\"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/e/e768b7467d32a691ed4e66fd7a11d85eccf3ed9d.jpeg\" data-download-href=\"/uploads/short-url/x18EcONxSp3rAnIO8VBEn8Je4CV.jpeg?dl=1\" title=\"image\" rel=\"nofollow noopener\"\u003e\u003cimg src=\"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/e/e768b7467d32a691ed4e66fd7a11d85eccf3ed9d_2_675x500.jpeg\" alt=\"image\" data-base62-sha1=\"x18EcONxSp3rAnIO8VBEn8Je4CV\" width=\"675\" height=\"500\" srcset=\"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/e/e768b7467d32a691ed4e66fd7a11d85eccf3ed9d_2_675x500.jpeg, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/e/e768b7467d32a691ed4e66fd7a11d85eccf3ed9d_2_1012x750.jpeg 1.5x, https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/e/e768b7467d32a691ed4e66fd7a11d85eccf3ed9d_2_1350x1000.jpeg 2x\" data-small-upload=\"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/e/e768b7467d32a691ed4e66fd7a11d85eccf3ed9d_2_10x10.png\"\u003e\u003cdiv class=\"meta\"\u003e\u003csvg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"\u003e\u003cuse xlink:href=\"#far-image\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003cspan class=\"filename\"\u003eimage\u003c/span\u003e\u003cspan class=\"informations\"\u003e2042√ó1512 572 KB\u003c/span\u003e\u003csvg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"\u003e\u003cuse xlink:href=\"#discourse-expand\"\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/div\u003e\u003c/a\u003e\u003c/div\u003e\u003cbr\u003e\n\u003cem\u003e(don‚Äôt mind the edges, it‚Äôs not there yet)\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eSo I think it‚Äôs the OpenGL automatically unloading texture if they are taking too much memory?\u003c/strong\u003e BTW: my source heightmap texture image is ~170MB in png (size ~ 16k pixels).\u003cbr\u003e\nBut how can I verify that and is there any way from Urho3D API to query which texture is loaded/unloaded in real time?\u003cbr\u003e\nOr what other way should I address this problem overall?\u003c/p\u003e","post_number":7,"post_type":1,"updated_at":"2020-07-26T18:53:56.339Z","reply_count":0,"reply_to_post_number":6,"quote_count":0,"incoming_link_count":0,"reads":25,"readers_count":24,"score":5.0,"yours":false,"topic_id":6283,"topic_slug":"fail-to-load-image-larger-than-250m","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":3,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/e/e768b7467d32a691ed4e66fd7a11d85eccf3ed9d.jpeg","internal":false,"reflection":false,"title":"e768b7467d32a691ed4e66fd7a11d85eccf3ed9d.jpeg","clicks":0},{"url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/8/8fa39571ba3760900cd2f69afc527ed175760582.jpeg","internal":false,"reflection":false,"title":"8fa39571ba3760900cd2f69afc527ed175760582.jpeg","clicks":0}],"read":true,"user_title":"","reply_to_user":{"username":"diskette","name":"diskette","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/d/45deac/{size}.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1291,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":38451,"name":"","username":"UrhoIsTheBest","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png","created_at":"2020-07-27T02:06:01.059Z","cooked":"\u003cp\u003eNotice there are two stages for ‚Äúloading texture images‚Äù:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eLoad image from disk to memory via Urho3D engine;\u003c/li\u003e\n\u003cli\u003eLoad image in GPU video card memory for shader calculations.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eI believe all those DEBUG LOGGING is about the 1st stage, while my problem is related to the 2nd stage.\u003cbr\u003e\nAnd I can verify the \u003ccode\u003e[...] DEBUG: Loading resource XXXX.png\u003c/code\u003e is done successfully. Also, I cannot build QuadTree if the 1st stage is not successful \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e\n\u003cp\u003eAs you can see from my first piece of code, I then cut the image into 4 pieces. When I set the material texture, that‚Äôs the 2nd stage.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eAs for compression\u003c/strong\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003ePNG can be compressed (like jpeg) I see 9 compression levels.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eIf I would like to compromise to lossy compression, I probably would not need those high resolution texture images anyway \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eGood question about\u003c/strong\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHow big is your landscape?\u003cbr\u003e\nMaybe it makes sense not to render it entirely?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eI wish I could. Unfortunately, the answer is no.\u003cbr\u003e\nYou are the first replier for my original post about \u003ca href=\"https://discourse.urho3d.io/t/anyone-tried-to-implement-geo-clipmapping-for-super-large-terrain/6238/2\"\u003egeo clipmapping\u003c/a\u003e. But I did not describe why I need this at that time. I can elaborate a little bit here. Think about it as a strategy game so play can zoom-out to see the whole map while zoom-in to see state/county level.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eMy game needs a terrain, the requirements are:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eFreely Zoom in \u0026amp; zoom out, like GoogleEarth. Max resolution when zooming in ~100 meter, Max range when zooming out ~2000km (a whole country scale).\u003c/li\u003e\n\u003cli\u003eFreely fly over to any direction with any height; Freely rotate camera;\u003c/li\u003e\n\u003cli\u003eSupport large heightmap data, e.g. real world elevation data from NASA , around 20k * 20k for a whole country.\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003eNow back to the problem\u003c/strong\u003e\u003cbr\u003e\nAs I mentioned in that \u003ca href=\"https://discourse.urho3d.io/t/anyone-tried-to-implement-geo-clipmapping-for-super-large-terrain/6238/2\"\u003egeo clipmapping post\u003c/a\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIt uses 200k * 100k heightmap (40G compressed to 300M), stores it in video card memory. Very good frame rate even in 2004! 16 years ago! They used the whole US heightmap (1arc resolution, ~30meter).\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003eThe paper did not mention any cutting-image techniques.\u003c/strong\u003e It claims ‚Äúpre-load all 300M heightmap data in the GPU‚Äù. \u003cstrong\u003eSo if a video card in 2004 can do that, why not now (in 2020)?\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eAs for \u003ca href=\"https://github.com/fstrugar/CDLOD/blob/master/cdlod_paper_latest.pdf\" rel=\"nofollow noopener\"\u003eFstrugar‚Äôs paper,\u003c/a\u003e \u003cstrong\u003eI could not find any cutting-image techniques either in paper or BasicCDLOD source code.\u003c/strong\u003e\u003cbr\u003e\nIf I check the \u003ca href=\"https://github.com/fstrugar/CDLOD/blob/master/source/BasicCDLOD/Shaders/CDLODTerrain.vsh\" rel=\"nofollow noopener\"\u003eshader source code\u003c/a\u003e, I could only find one texture sampler for the heightmap (variable name \u003ccode\u003eg_terrainHMVertexTexture\u003c/code\u003e). It is used in the \u003ccode\u003esampleHeightmap()\u003c/code\u003e function.\u003cbr\u003e\nIt‚Äôs a pity I don‚Äôt have a windows pc so I cannot run Fstrugar‚Äôs source code myself to verify everything.\u003c/p\u003e\n\u003cp\u003eI am not questioning your comment above, but I might miss something important in those papers/projects.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003eOf course we can have different work-around or hack solutions to make things just work.\u003c/em\u003e\u003cbr\u003e\n\u003cstrong\u003eBut the key question here is:\u003c/strong\u003e\u003cbr\u003e\nIf in 2004 we can preload 200k * 100k heightmap (compressed to 300M) into video card memory,\u003cbr\u003e\n\u003cstrong\u003eor\u003c/strong\u003e preload\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003ecarlifmtns_large: 48897 x 30465 heightmap with a normal map and a simple texture splatting technique;\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003ein 2010.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWhy is it not even a piece of cake to do the same thing in 2020 ten years later?\u003c/strong\u003e \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/thinking.png?v=9\" title=\":thinking:\" class=\"emoji\" alt=\":thinking:\"\u003e \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/thinking.png?v=9\" title=\":thinking:\" class=\"emoji\" alt=\":thinking:\"\u003e \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/thinking.png?v=9\" title=\":thinking:\" class=\"emoji\" alt=\":thinking:\"\u003e\u003c/p\u003e","post_number":9,"post_type":1,"updated_at":"2020-07-27T03:05:50.589Z","reply_count":1,"reply_to_post_number":8,"quote_count":0,"incoming_link_count":1,"reads":24,"readers_count":23,"score":14.8,"yours":false,"topic_id":6283,"topic_slug":"fail-to-load-image-larger-than-250m","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://discourse.urho3d.io/t/anyone-tried-to-implement-geo-clipmapping-for-super-large-terrain/6238/2","internal":true,"reflection":false,"title":"Anyone tried to implement geo clipmapping for super large terrain?","clicks":0},{"url":"https://github.com/fstrugar/CDLOD/blob/master/source/BasicCDLOD/Shaders/CDLODTerrain.vsh","internal":false,"reflection":false,"title":"CDLOD/CDLODTerrain.vsh at master ¬∑ fstrugar/CDLOD ¬∑ GitHub","clicks":0},{"url":"https://github.com/fstrugar/CDLOD/blob/master/cdlod_paper_latest.pdf","internal":false,"reflection":false,"title":"CDLOD/cdlod_paper_latest.pdf at master ¬∑ fstrugar/CDLOD ¬∑ GitHub","clicks":0}],"read":true,"user_title":"","reply_to_user":{"username":"diskette","name":"diskette","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/d/45deac/{size}.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1291,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":38453,"name":"Justin Miller","username":"jmiller","avatar_template":"/user_avatar/discourse.urho3d.io/jmiller/{size}/2367_2.png","created_at":"2020-07-27T02:16:37.158Z","cooked":"\u003cp\u003ePNG was intended to be lossless and this is true for most encoders+options but I see not all. Compression speed and ratios vary a lot with the encoding and heuristics, where a huge image can be ‚Äúcompressed small, quickly‚Äù or ‚Äúcrushed to a crystal, with CPU in flames for a week‚Äù.\u003c/p\u003e\n\u003cp\u003eA guide to PNG optimization also covering a variety of programs including the newer \u003ccode\u003eoptipng\u003c/code\u003e: \u003ca href=\"http://optipng.sourceforge.net/pngtech/optipng.html\"\u003ehttp://optipng.sourceforge.net/pngtech/optipng.html\u003c/a\u003e\u003c/p\u003e","post_number":11,"post_type":1,"updated_at":"2020-07-27T07:19:17.880Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":24,"readers_count":23,"score":9.8,"yours":false,"topic_id":6283,"topic_slug":"fail-to-load-image-larger-than-250m","display_username":"Justin Miller","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"http://optipng.sourceforge.net/pngtech/optipng.html","internal":false,"reflection":false,"title":"A guide to PNG optimization","clicks":1}],"read":true,"user_title":"","bookmarked":false,"actions_summary":[],"moderator":true,"admin":false,"staff":true,"user_id":21,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":38561,"name":"","username":"UrhoIsTheBest","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png","created_at":"2020-08-09T08:05:19.639Z","cooked":"\u003cp\u003eFYI, I haven‚Äôt fully solved my problem but had a temporary workaround.\u003c/p\u003e\n\u003cp\u003eFor reading large png into memory, I use a very lightweighted \u003ca href=\"https://lodev.org/lodepng/\" rel=\"nofollow noopener\"\u003elodepng\u003c/a\u003e lib. It uses \u003ccode\u003estd::vector\u0026lt;unsigned char\u0026gt;\u003c/code\u003e to represent image so the length is \u0026gt; \u003ccode\u003eint_max\u003c/code\u003e. Luckily, Urho3D Image API is flexible enough I can directly use the vector data to construct a new image.\u003c/p\u003e\n\u003cp\u003eFor processing the whole heightmap in GPU, I did split it into 4 pieces. But this time I use \u003ccode\u003eTEXTURE_DYNAMIC\u003c/code\u003e instead of \u003ccode\u003eTEXTURE_STATIC\u003c/code\u003e. Now it seems work, although I don‚Äôt know why static does not work.\u003c/p\u003e\n\u003cp\u003eThe code \u0026amp; shader is a mess with this hack, it‚Äôs definitely not a scalable solution. But I would take a deeper look later. I am going to move forward to deal with shadow etc.\u003c/p\u003e","post_number":12,"post_type":1,"updated_at":"2020-08-09T08:05:19.639Z","reply_count":0,"reply_to_post_number":9,"quote_count":0,"incoming_link_count":0,"reads":24,"readers_count":23,"score":4.8,"yours":false,"topic_id":6283,"topic_slug":"fail-to-load-image-larger-than-250m","display_username":"","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://lodev.org/lodepng/","internal":false,"reflection":false,"title":"LodePNG","clicks":2}],"read":true,"user_title":"","reply_to_user":{"username":"UrhoIsTheBest","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1291,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[38428,38432,38438,38439,38445,38451,38453,38561]},"timeline_lookup":[[1,851],[3,850],[5,849],[8,836]],"suggested_topics":[{"id":7266,"title":"Compile Urho3D 1.8 failed with the default MinGW of Clion2022.1","fancy_title":"Compile Urho3D 1.8 failed with the default MinGW of Clion2022.1","slug":"compile-urho3d-1-8-failed-with-the-default-mingw-of-clion2022-1","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/f/fcbe1a1f0cd74c5cc158c8c790c6c472f3b96011_2_1024x359.png","created_at":"2022-05-14T06:22:45.469Z","last_posted_at":"2022-05-16T06:45:54.546Z","bumped":true,"bumped_at":"2022-05-16T06:45:54.546Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":124,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":745,"username":"ChunFengTsin","name":"Chun Feng Tsin","avatar_template":"/user_avatar/discourse.urho3d.io/chunfengtsin/{size}/450_2.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7212,"title":"Shadow Gap between Feet and Plane","fancy_title":"Shadow Gap between Feet and Plane","slug":"shadow-gap-between-feet-and-plane","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/8/897538cff25de49fafa7aa77574f822e99576b67_2_1024x686.jpeg","created_at":"2022-03-07T00:04:17.351Z","last_posted_at":"2022-03-07T00:17:57.413Z","bumped":true,"bumped_at":"2022-03-07T00:17:57.413Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":137,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}}]},{"id":7200,"title":"Urho3D just building if I check \"use SHARED libraries\"","fancy_title":"Urho3D just building if I check \u0026ldquo;use SHARED libraries\u0026rdquo;","slug":"urho3d-just-building-if-i-check-use-shared-libraries","posts_count":8,"reply_count":3,"highest_post_number":8,"image_url":null,"created_at":"2022-02-22T20:02:48.835Z","last_posted_at":"2022-02-23T15:38:33.698Z","bumped":true,"bumped_at":"2022-02-23T15:54:07.879Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":165,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1508,"username":"killinbassou","name":"killin","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/k/848f3c/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png"}}]},{"id":7254,"title":"Android :android:urho3d-lib:generateJsonModelDebug failed task","fancy_title":"Android :android:urho3d-lib:generateJsonModelDebug failed task","slug":"android-urho3d-lib-generatejsonmodeldebug-failed-task","posts_count":14,"reply_count":8,"highest_post_number":14,"image_url":null,"created_at":"2022-05-07T08:16:09.637Z","last_posted_at":"2022-08-31T13:37:02.824Z","bumped":true,"bumped_at":"2022-08-31T13:37:02.824Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"unicode_title":"Android :android:urho3d-lib:generateJsonModelDebug failed task","tags_descriptions":{},"like_count":2,"views":344,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1518,"username":"Joshua-PotatoMan","name":"Joshua","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/j/e9c0ed/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1522,"username":"tungts1101","name":"tungts1101","avatar_template":"/user_avatar/discourse.urho3d.io/tungts1101/{size}/3803_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":809,"username":"elix22","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/elix22/{size}/1437_2.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":263,"username":"1vanK","name":"","avatar_template":"/user_avatar/discourse.urho3d.io/1vank/{size}/768_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7278,"title":"Compile Urho3D With LLVM-MINGW","fancy_title":"Compile Urho3D With LLVM-MINGW","slug":"compile-urho3d-with-llvm-mingw","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":null,"created_at":"2022-06-06T14:35:21.445Z","last_posted_at":"2022-06-17T13:40:34.662Z","bumped":true,"bumped_at":"2022-06-17T13:40:34.662Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":133,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":745,"username":"ChunFengTsin","name":"Chun Feng Tsin","avatar_template":"/user_avatar/discourse.urho3d.io/chunfengtsin/{size}/450_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":461,"username":"Victor","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/v/3e96dc/{size}.png"}}]}],"tags_descriptions":{},"id":6283,"title":"Fail to load image larger than 250M","fancy_title":"Fail to load image larger than 250M","posts_count":8,"created_at":"2020-07-25T07:07:30.267Z","views":435,"reply_count":7,"like_count":0,"last_posted_at":"2020-08-09T08:05:19.639Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"fail-to-load-image-larger-than-250m","category_id":10,"word_count":1941,"deleted_at":null,"user_id":1291,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_6283","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":12,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":4,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":1291,"username":"UrhoIsTheBest","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png","post_count":5,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":21,"username":"jmiller","name":"Justin Miller","avatar_template":"/user_avatar/discourse.urho3d.io/jmiller/{size}/2367_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"moderator":true,"trust_level":3},{"id":192,"username":"Modanung","name":"È≠îÂ§ßÂÜú ùûçùûéùù≥ ÁèæÊãõËúç","avatar_template":"/user_avatar/discourse.urho3d.io/modanung/{size}/3290_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":0},{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":1291,"username":"UrhoIsTheBest","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png"},"last_poster":{"id":1291,"username":"UrhoIsTheBest","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/u/7feea3/{size}.png"},"links":[{"url":"https://github.com/nothings/stb/issues/672#issuecomment-580041441","title":"maximum image size for sub_image ¬∑ Issue #672 ¬∑ nothings/stb ¬∑ GitHub","internal":false,"attachment":false,"reflection":false,"clicks":2,"user_id":1291,"domain":"github.com","root_domain":"github.com"},{"url":"https://lodev.org/lodepng/","title":"LodePNG","internal":false,"attachment":false,"reflection":false,"clicks":2,"user_id":1291,"domain":"lodev.org","root_domain":"lodev.org"},{"url":"http://optipng.sourceforge.net/pngtech/optipng.html","title":"A guide to PNG optimization","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":21,"domain":"optipng.sourceforge.net","root_domain":"sourceforge.net"},{"url":"https://imagemagick.org/script/command-line-options.php#crop","title":"ImageMagick - Command-line Options","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":192,"domain":"imagemagick.org","root_domain":"imagemagick.org"}]}}