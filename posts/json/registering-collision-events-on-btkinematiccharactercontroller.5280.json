{"post_stream":{"posts":[{"id":30604,"name":"Alex James","username":"HaeferlKaffee","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/h/71e660/{size}.png","created_at":"2019-07-03T23:03:54.144Z","cooked":"\u003cp\u003eI’m essentially using the implementation here:\u003cbr\u003e\n\u003ca href=\"https://discourse.urho3d.io/t/kinematic-character-controllers/3555\"\u003ehttps://discourse.urho3d.io/t/kinematic-character-controllers/3555\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIt works fantastically other than that if you want a velocity-based movement system, you can’t use Bullet’s internal “velocity” (.setLinearVelocity(), etc.), and must use \u003cem\u003esetWalkDirection()\u003c/em\u003e instead, otherwise the character won’t ‘step’ over objects.\u003c/p\u003e\n\u003cp\u003eMy solution has been to define a velocity variable in my implementation the controller, accelerating in the input direction with some maths to create friction when grounded and limit acceleration based on Quake’s dot-product method.\u003c/p\u003e\n\u003cp\u003eThe problem is that if this character hits an angled wall (say a small wall at 45° to the direction of the controller’s velocity), no absorption/restitution/friction occurs, and they simply slide along the wall then continue in their original direction. Collisions are obviously not able to affect the velocity because it’s in my implementation, but even if I use setLinearVelocity(), which again is not ideal due to not stepping, it still ignores these collisions.\u003c/p\u003e\n\u003cp\u003eIdeally without changing Bullet’s library code, how can I add a function/listener that handles the collisions made by the controller’s ghost object? Adding a collision callback like with rigid bodies in Urho3D doesn’t work (It simply doesn’t recognise the collisions). \u003cstrong\u003eIs there a way to add a callback for Bullet’s collisions?\u003c/strong\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eEDIT:\u003cbr\u003e\n\u003cem\u003e(Currently I’m using a large sphere, a child of the controller, that detects collisions and applies a repulsive force to cancel out the velocity in that direction, which works sometimes but fails are high speeds because it’s not in the same place as the ghost object - bit of a headache. Also, using a sphere larger than the capsule collider of course causes issues at low speeds where the player is prevented from moving in a certain direction even though the capsule isn’t actually touching the wall, but the sphere is.)\u003c/em\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e// node_ has a btKinematicCharacterController implementation attached.\nSubscribeToEvent(node_, E_PHYSICSCOLLISIONSTART, URHO3D_HANDLER(CrabCharacterController, DebugGhostCollision));\n\n...\n\nvoid CrabCharacterController::DebugGhostCollision(StringHash eventType, VariantMap\u0026amp; eventData) {\n    using namespace PhysicsCollisionStart;\n\n    RigidBody *rb1 = (RigidBody*)eventData[P_BODYA].GetPtr();\n    btTransform t;\n    rb1-\u0026gt;getWorldTransform(t);\n    if (t == ghostObject_-\u0026gt;getWorldTransform()) {\n\t    int done = 1;               // Breakpoint here, just to test if the event rigidbody is the same as the ghost object, not efficient but just to test\n    }\n}\u003c/code\u003e\u003c/pre\u003e","post_number":1,"post_type":1,"updated_at":"2019-07-04T14:38:05.062Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":64,"reads":28,"readers_count":27,"score":327.6,"yours":false,"topic_id":5280,"topic_slug":"registering-collision-events-on-btkinematiccharactercontroller","display_username":"Alex James","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":3,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"link_counts":[{"url":"https://discourse.urho3d.io/t/kinematic-character-controllers/3555","internal":true,"reflection":false,"title":"Kinematic Character Controllers","clicks":13}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1021,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":30621,"name":"Leith Ketchell","username":"Leith","avatar_template":"/user_avatar/discourse.urho3d.io/leith/{size}/2384_2.png","created_at":"2019-07-05T05:35:07.366Z","cooked":"\u003cp\u003eHi! Yes I ran into this one too… I addressed exactly this issue recently, you are welcome to use it and change it any way you like \u003cimg src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"\u003e\u003c/p\u003e\n\u003caside class=\"quote no-group\"\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ca href=\"https://discourse.urho3d.io/t/support-for-ghostobject-collision-events/5215\" class=\"inline-onebox\"\u003eSupport for GhostObject collision events\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eIf you need more help, that’s cool too, just yell out if you get stuck.\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2019-07-05T05:38:18.555Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":16,"readers_count":15,"score":18.2,"yours":false,"topic_id":5280,"topic_slug":"registering-collision-events-on-btkinematiccharactercontroller","display_username":"Leith Ketchell","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"suspended user","title_is_group":false,"bookmarked":false,"actions_summary":[{"id":2,"count":1}],"moderator":false,"admin":false,"staff":false,"user_id":1098,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_suspended":true,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":30624,"name":"Leith Ketchell","username":"Leith","avatar_template":"/user_avatar/discourse.urho3d.io/leith/{size}/2384_2.png","created_at":"2019-07-05T06:38:54.894Z","cooked":"\u003cp\u003ewith respect to high speed tunneling bugs, turn on ccd - instead of instant position testing for collisions, we will use quadratic equations, swept tests, extrusions of the moving shape over time - in my opinion, any modern physics engine should DEFAULT to using CCD in collision tests, and never call the instantaneous “query” tests, which we reserve for specific queries outside of the physics step\u003c/p\u003e","post_number":3,"post_type":1,"updated_at":"2019-07-06T04:24:03.778Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":15,"readers_count":14,"score":3.0,"yours":false,"topic_id":5280,"topic_slug":"registering-collision-events-on-btkinematiccharactercontroller","display_username":"Leith Ketchell","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":"suspended user","title_is_group":false,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":1098,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_suspended":true,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[30604,30621,30624]},"timeline_lookup":[[1,1238],[2,1237]],"suggested_topics":[{"id":7186,"title":"Best way to do Blob Shadows in Urho","fancy_title":"Best way to do Blob Shadows in Urho","slug":"best-way-to-do-blob-shadows-in-urho","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/2/22e3dc1892512375cae09bf84fd92071a1ae27d8.png","created_at":"2022-02-05T04:59:31.388Z","last_posted_at":"2022-02-05T13:29:22.054Z","bumped":true,"bumped_at":"2022-02-05T13:31:44.299Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":179,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7104,"title":"Bug in my partial-model copying code","fancy_title":"Bug in my partial-model copying code","slug":"bug-in-my-partial-model-copying-code","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/2X/5/5367e370779d64989e5c3ff2c1ebfb0689908c87.png","created_at":"2021-12-17T03:50:19.405Z","last_posted_at":"2021-12-17T13:50:49.662Z","bumped":true,"bumped_at":"2021-12-17T13:50:49.662Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":144,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7087,"title":"Android how to get error message sometimes little change gives me just crash","fancy_title":"Android how to get error message sometimes little change gives me just crash","slug":"android-how-to-get-error-message-sometimes-little-change-gives-me-just-crash","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-12-05T16:59:59.376Z","last_posted_at":"2021-12-05T18:17:02.335Z","bumped":true,"bumped_at":"2021-12-05T18:17:02.335Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":153,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1436,"username":"Maco","name":"Maco","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/m/90ced4/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}}]},{"id":7182,"title":"How install landscape in the format (.tor or .obj)?","fancy_title":"How install landscape in the format (.tor or .obj)?","slug":"how-install-landscape-in-the-format-tor-or-obj","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2022-02-03T16:58:20.976Z","last_posted_at":"2022-02-04T16:34:09.663Z","bumped":true,"bumped_at":"2022-02-04T16:34:09.663Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":2,"views":151,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1497,"username":"timob256","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/b782af/{size}.png"}},{"extras":"latest","description":"Most Recent Poster, Accepted Answer","user":{"id":1317,"username":"Lys0gen","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/l/57b2e6/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7200,"title":"Urho3D just building if I check \"use SHARED libraries\"","fancy_title":"Urho3D just building if I check \u0026ldquo;use SHARED libraries\u0026rdquo;","slug":"urho3d-just-building-if-i-check-use-shared-libraries","posts_count":8,"reply_count":3,"highest_post_number":8,"image_url":null,"created_at":"2022-02-22T20:02:48.835Z","last_posted_at":"2022-02-23T15:38:33.698Z","bumped":true,"bumped_at":"2022-02-23T15:54:07.879Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":4,"views":165,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1508,"username":"killinbassou","name":"killin","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/k/848f3c/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":4,"username":"weitjong","name":"Yao Wei Tjong","avatar_template":"/user_avatar/discourse.urho3d.io/weitjong/{size}/4_2.png"}}]}],"tags_descriptions":{},"id":5280,"title":"Registering collision events on btKinematicCharacterController","fancy_title":"Registering collision events on btKinematicCharacterController","posts_count":3,"created_at":"2019-07-03T23:03:54.040Z","views":546,"reply_count":0,"like_count":1,"last_posted_at":"2019-07-05T06:38:54.894Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"registering-collision-events-on-btkinematiccharactercontroller","category_id":10,"word_count":511,"deleted_at":null,"user_id":1021,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_5280","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":3,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":2,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"tags_disable_ads":false,"details":{"can_edit":false,"notification_level":1,"participants":[{"id":1098,"username":"Leith","name":"Leith Ketchell","avatar_template":"/user_avatar/discourse.urho3d.io/leith/{size}/2384_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":1021,"username":"HaeferlKaffee","name":"Alex James","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/h/71e660/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1}],"created_by":{"id":1021,"username":"HaeferlKaffee","name":"Alex James","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/h/71e660/{size}.png"},"last_poster":{"id":1098,"username":"Leith","name":"Leith Ketchell","avatar_template":"/user_avatar/discourse.urho3d.io/leith/{size}/2384_2.png"},"links":[{"url":"https://discourse.urho3d.io/t/kinematic-character-controllers/3555","title":"Kinematic Character Controllers","internal":true,"attachment":false,"reflection":false,"clicks":13,"user_id":1021,"domain":"discourse.urho3d.io","root_domain":"urho3d.io"}]}}