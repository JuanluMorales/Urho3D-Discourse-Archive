{"post_stream":{"posts":[{"id":17278,"name":"Ganibc","username":"ganibc","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/54ee81/{size}.png","created_at":"2017-04-21T01:30:53.868Z","cooked":"\u003cp\u003eHi all,\u003c/p\u003e\n\u003cp\u003eI’m trying to generate images for thumbnails and minimaps.\u003cbr\u003e\nI have 2 different questions:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eCan we render a scene to texture and save to image file using headless mode? From what I found, it seems it’s not possible.\u003c/li\u003e\n\u003cli\u003eI rendered my scene using the sample code (in sample.inl)\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cpre\u003e\u003ccode\u003e    // Take screenshot\n    else if (key == '9')\n    {\n        Graphics* graphics = GetSubsystem\u0026lt;Graphics\u0026gt;();\n        Image screenshot(context_);\n        graphics-\u0026gt;TakeScreenShot(screenshot);\n        // Here we save in the Data folder with date and time appended\n        screenshot.SavePNG(GetSubsystem\u0026lt;FileSystem\u0026gt;()-\u0026gt;GetProgramDir() + \"Data/Screenshot_\" +\n            Time::GetTimeStamp().Replaced(':', '_').Replaced('.', '_').Replaced(' ', '_') + \".png\");\n    }\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThis code is working just fine. But I have to wait until the scene is rendered and I don’t know when the scene will be rendered. I have to wait for few update loops before it actually drawing the scene.\u003cbr\u003e\nSo I tried calling Renderer’s Update and Render function and then take the screenshot.\u003cbr\u003e\nThis is working but it gives me weird result.\u003cbr\u003e\n\u003cimg src=\"//cdck-file-uploads-global.s3.dualstack.us-west-2.amazonaws.com/standard17/uploads/urho3d/original/1X/5e3a537f2c5d120c036d8b98195efc34778c1227.png\" width=\"666\" height=\"500\"\u003e\u003c/p\u003e\n\u003cp\u003e(I’ll post the expected image later because I cannot post 2 images)\u003c/p\u003e\n\u003cp\u003eIt seems to me the there’s a problem with the depth test.\u003cbr\u003e\nAny idea what’s wrong?\u003cbr\u003e\nThis is my code:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cpre\u003e\u003ccode\u003eSharedPtr\u0026lt;Viewport\u0026gt; viewport(new Viewport(context_, scene_, cameraNode_-\u0026gt;GetComponent\u0026lt;Camera\u0026gt;()));\nm_textureOut = new Texture2D(context_);\nm_textureOut-\u0026gt;SetSize(width, height, Graphics::GetRGBFormat(), TEXTURE_RENDERTARGET);\nm_textureOut-\u0026gt;SetFilterMode(FILTER_BILINEAR);\nRenderSurface* renderSurface = m_textureOut-\u0026gt;GetRenderSurface();\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cpre\u003e\u003ccode\u003erenderSurface-\u0026gt;SetViewport(0, viewport);\nrenderSurface-\u0026gt;SetUpdateMode(SURFACE_UPDATEALWAYS);\nGetSubsystem\u0026lt;Renderer\u0026gt;()-\u0026gt;Update(1.0f);\nGetSubsystem\u0026lt;Renderer\u0026gt;()-\u0026gt;Render();\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cpre\u003e\u003ccode\u003eunsigned char* _ImageData = new unsigned char[m_textureOut-\u0026gt;GetDataSize(width, height)];\nm_textureOut-\u0026gt;GetData(0, _ImageData);\nImage* pImage = new Image(context_);\npImage-\u0026gt;SetSize(width, height, 3);\npImage-\u0026gt;SetData(_ImageData);\npImage-\u0026gt;SavePNG(\"./test.png\");\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cpre\u003e\u003ccode\u003eengine_-\u0026gt;Exit();\u003c/code\u003e\u003c/pre\u003e\n\u003c/blockquote\u003e","post_number":1,"post_type":1,"updated_at":"2017-04-21T01:43:37.255Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":7,"reads":35,"readers_count":34,"score":42.0,"yours":false,"topic_id":3031,"topic_slug":"render-to-texture-with-explicit-call-to-update-and-render-problem","display_username":"Ganibc","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":714,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":17281,"name":"Ganibc","username":"ganibc","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/54ee81/{size}.png","created_at":"2017-04-21T01:31:26.354Z","cooked":"\u003cp\u003eThis is the expected result:\u003cbr\u003e\n\u003cimg src=\"//cdck-file-uploads-global.s3.dualstack.us-west-2.amazonaws.com/standard17/uploads/urho3d/original/1X/2d2b23697848247023b146ff68a7e15368f47a89.png\" width=\"666\" height=\"500\"\u003e\u003c/p\u003e","post_number":2,"post_type":1,"updated_at":"2017-04-21T01:31:26.354Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":33,"readers_count":32,"score":6.6,"yours":false,"topic_id":3031,"topic_slug":"render-to-texture-with-explicit-call-to-update-and-render-problem","display_username":"Ganibc","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":714,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":17314,"name":"SirNate0","username":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png","created_at":"2017-04-22T05:33:40.265Z","cooked":"\u003cp\u003eCould it be that you are culling the wrong faces? You could try adding \u003ccode\u003e\u0026lt;cull value=\"none\" /\u0026gt;\u003c/code\u003e to the material and see if that changes it (unless you are certain that it is not the cause – I’ve never experimented with Headless mode so I have nothing to offer if it is something specific to that).\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2017-04-22T05:33:40.265Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":3,"reads":26,"readers_count":25,"score":25.2,"yours":false,"topic_id":3031,"topic_slug":"render-to-texture-with-explicit-call-to-update-and-render-problem","display_username":"SirNate0","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":628,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false},{"id":17331,"name":"Ganibc","username":"ganibc","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/54ee81/{size}.png","created_at":"2017-04-24T01:32:14.799Z","cooked":"\u003cp\u003eThanks for the reply.\u003cbr\u003e\nI tried changing the cullmode, it’s still give the same result.\u003cbr\u003e\nBut I found the problem.\u003c/p\u003e\n\u003cp\u003eI just need to replace these:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eGetSubsystem\u0026lt; Renderer\u0026gt;()-\u0026gt;Update(1.0f);\u003cbr\u003e\nGetSubsystem\u0026lt; Renderer\u0026gt;()-\u0026gt;Render();\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eto\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eengine_-\u0026gt;Update();\u003cbr\u003e\nengine_-\u0026gt;Render();\u003c/p\u003e\n\u003c/blockquote\u003e","post_number":5,"post_type":1,"updated_at":"2017-04-24T09:35:43.243Z","reply_count":0,"reply_to_post_number":4,"quote_count":0,"incoming_link_count":0,"reads":22,"readers_count":21,"score":4.4,"yours":false,"topic_id":3031,"topic_slug":"render-to-texture-with-explicit-call-to-update-and-render-problem","display_username":"Ganibc","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"},"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":714,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":true},{"id":17333,"name":"Jonathan","username":"Sinoid","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/f19dbf/{size}.png","created_at":"2017-04-24T03:11:28.624Z","cooked":"\u003cp\u003eAs far as I’m aware that’s still sane.\u003c/p\u003e\n\u003cp\u003eThis is the code I use for rendering from a lumel for lightmapping:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003erenderNode_-\u0026gt;SetWorldPosition(worldPosition);\nQuaternion rotation;\nrotation.FromLookRotation(normal);\nrenderNode_-\u0026gt;SetWorldRotation(rotation);\n\nGraphics* graphics = scene-\u0026gt;GetSubsystem\u0026lt;Graphics\u0026gt;();\nRenderer* renderer = scene-\u0026gt;GetSubsystem\u0026lt;Renderer\u0026gt;();\n\nsurface_-\u0026gt;GetRenderSurface()-\u0026gt;QueueUpdate();\ngraphics-\u0026gt;Clear(-1, Color(0, 0, 0));\nsurface_-\u0026gt;GetRenderSurface()-\u0026gt;SetViewport(0, viewport_.Get());\nrenderer-\u0026gt;Update();\ngraphics-\u0026gt;SetRenderTarget(0, surface_);\nrenderer-\u0026gt;Render();\u003c/code\u003e\u003c/pre\u003e","post_number":6,"post_type":1,"updated_at":"2017-04-24T03:11:28.624Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":22,"readers_count":21,"score":4.4,"yours":false,"topic_id":3031,"topic_slug":"render-to-texture-with-explicit-call-to-update-and-render-problem","display_username":"Jonathan","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[],"moderator":false,"admin":false,"staff":false,"user_id":669,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false}],"stream":[17278,17281,17314,17331,17333]},"timeline_lookup":[[1,2042],[3,2041],[4,2039]],"suggested_topics":[{"id":7081,"title":"Install Urho3D Library - Windows 10 - rake build - \"project does not exist\"","fancy_title":"Install Urho3D Library - Windows 10 - rake build - \u0026ldquo;project does not exist\u0026rdquo;","slug":"install-urho3d-library-windows-10-rake-build-project-does-not-exist","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-03T03:06:40.974Z","last_posted_at":"2021-12-03T17:53:10.844Z","bumped":true,"bumped_at":"2021-12-03T17:53:10.844Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":190,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1488,"username":"ToolmakerSteve","name":"ToolmakerSteve","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/t/ba9def/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1491,"username":"xlat","name":"Alex Kuch","avatar_template":"/user_avatar/discourse.urho3d.io/xlat/{size}/3620_2.png"}}]},{"id":7086,"title":"Handling CrowdAgents that get stuck","fancy_title":"Handling CrowdAgents that get stuck","slug":"handling-crowdagents-that-get-stuck","posts_count":2,"reply_count":0,"highest_post_number":2,"image_url":null,"created_at":"2021-12-04T01:26:23.062Z","last_posted_at":"2021-12-05T04:37:54.143Z","bumped":true,"bumped_at":"2021-12-05T04:37:54.143Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":137,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":"latest single","description":"Original Poster, Most Recent Poster","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}}]},{"id":7105,"title":"Multiple Application.UI Roots?","fancy_title":"Multiple Application.UI Roots?","slug":"multiple-application-ui-roots","posts_count":3,"reply_count":1,"highest_post_number":3,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/optimized/2X/7/74b10ce575f1b69fe43be4abcb07605d74a1d27c_2_1024x544.jpeg","created_at":"2021-12-20T08:55:14.707Z","last_posted_at":"2021-12-22T02:33:05.795Z","bumped":true,"bumped_at":"2021-12-22T02:33:05.795Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":0,"views":243,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster","user":{"id":1334,"username":"najak3d","name":"Brian Knox","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/n/6a8cbe/{size}.png"}},{"extras":null,"description":"Frequent Poster, Accepted Answer","user":{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png"}}]},{"id":7138,"title":"Build fails (linking phase) on Linux","fancy_title":"Build fails (linking phase) on Linux","slug":"build-fails-linking-phase-on-linux","posts_count":4,"reply_count":0,"highest_post_number":4,"image_url":null,"created_at":"2022-01-20T03:08:29.663Z","last_posted_at":"2022-01-21T15:27:41.192Z","bumped":true,"bumped_at":"2022-01-21T15:27:41.192Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":3,"views":178,"category_id":10,"featured_link":null,"has_accepted_answer":false,"posters":[{"extras":null,"description":"Original Poster","user":{"id":1502,"username":"jasperry","name":"Jason Perry","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/j/5fc32e/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":1038,"username":"dertom","name":"Thomas Trocha","avatar_template":"/user_avatar/discourse.urho3d.io/dertom/{size}/1815_2.png"}},{"extras":"latest","description":"Most Recent Poster","user":{"id":1304,"username":"lebrewer","name":"lebrewer","avatar_template":"/user_avatar/discourse.urho3d.io/lebrewer/{size}/2811_2.png"}}]},{"id":7074,"title":"First Person and 3rd person camera and water reflections","fancy_title":"First Person and 3rd person camera and water reflections","slug":"first-person-and-3rd-person-camera-and-water-reflections","posts_count":4,"reply_count":1,"highest_post_number":4,"image_url":null,"created_at":"2021-12-01T18:37:28.669Z","last_posted_at":"2021-12-01T21:19:51.519Z","bumped":true,"bumped_at":"2021-12-01T21:19:51.519Z","archetype":"regular","unseen":false,"pinned":false,"unpinned":null,"visible":true,"closed":false,"archived":false,"bookmarked":null,"liked":null,"tags_descriptions":{},"like_count":1,"views":158,"category_id":10,"featured_link":null,"has_accepted_answer":true,"posters":[{"extras":"latest","description":"Original Poster, Most Recent Poster, Accepted Answer","user":{"id":861,"username":"GodMan","name":"","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/e79b87/{size}.png"}},{"extras":null,"description":"Frequent Poster","user":{"id":484,"username":"Eugene","name":"Eugene Kozlov","avatar_template":"/user_avatar/discourse.urho3d.io/eugene/{size}/902_2.png"}}]}],"tags_descriptions":{},"id":3031,"title":"Render to texture with explicit call to Update and Render problem","fancy_title":"Render to texture with explicit call to Update and Render problem","posts_count":5,"created_at":"2017-04-21T01:30:53.800Z","views":701,"reply_count":2,"like_count":0,"last_posted_at":"2017-04-24T03:11:28.624Z","visible":true,"closed":false,"archived":false,"has_summary":false,"archetype":"regular","slug":"render-to-texture-with-explicit-call-to-update-and-render-problem","category_id":10,"word_count":481,"deleted_at":null,"user_id":714,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/1X/5e3a537f2c5d120c036d8b98195efc34778c1227.png","slow_mode_seconds":0,"draft":null,"draft_key":"topic_3031","draft_sequence":null,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":6,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":false},{"id":8,"count":0,"hidden":false,"can_act":false},{"id":7,"count":0,"hidden":false,"can_act":false}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":0,"participant_count":3,"show_read_indicator":false,"thumbnails":[{"max_width":null,"max_height":null,"width":1024,"height":768,"url":"https://global.discourse-cdn.com/standard17/uploads/urho3d/original/1X/5e3a537f2c5d120c036d8b98195efc34778c1227.png"}],"slow_mode_enabled_until":null,"tags_disable_ads":false,"accepted_answer":{"post_number":5,"username":"ganibc","excerpt":"Thanks for the reply. \nI tried changing the cullmode, it’s still give the same result. \nBut I found the problem. \nI just need to replace these: \n\nGetSubsystem\u0026lt; Renderer\u0026gt;()-\u0026gt;Update(1.0f); \nGetSubsystem\u0026lt; Renderer\u0026gt;()-\u0026gt;Render(); \n\nto \n\nengine_-\u0026gt;Update(); \nengine_-\u0026gt;Render();"},"details":{"can_edit":false,"notification_level":1,"participants":[{"id":714,"username":"ganibc","name":"Ganibc","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/54ee81/{size}.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":1},{"id":628,"username":"SirNate0","name":"SirNate0","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/9f8e36/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2},{"id":669,"username":"Sinoid","name":"Jonathan","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/f19dbf/{size}.png","post_count":1,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"trust_level":2}],"created_by":{"id":714,"username":"ganibc","name":"Ganibc","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/g/54ee81/{size}.png"},"last_poster":{"id":669,"username":"Sinoid","name":"Jonathan","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/s/f19dbf/{size}.png"}}}